<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='Being able to easily test code of a Pull Request is the key to have a better code management. Most of the time checking only the code increment is not enough to validate a PR'><meta name=theme-color content='#ffcd00'><meta property='og:title' content='Azure DevOps: Create Docker images for a Pull Request • Codewrecks'><meta property='og:description' content='Being able to easily test code of a Pull Request is the key to have a better code management. Most of the time checking only the code increment is not enough to validate a PR'><meta property='og:url' content='https://www.codewrecks.com/post/azdo/pipeline/build-and-create-docker-for-your-pr/'><meta property='og:site_name' content='Codewrecks'><meta property='og:type' content='article'><meta property='article:section' content='post'><meta property='article:tag' content='AzDo'><meta property='article:published_time' content='2024-07-07T07:00:42Z'><meta property='article:modified_time' content='2024-07-07T07:00:42Z'><meta name=twitter:card content='summary'><meta name=generator content="Hugo 0.128.0"><title>Azure DevOps: Create Docker images for a Pull Request • Codewrecks</title>
<link rel=canonical href=https://www.codewrecks.com/post/azdo/pipeline/build-and-create-docker-for-your-pr/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-JNG3CSWEQT"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JNG3CSWEQT")</script></head><body class='page type-post has-sidebar'><div class=site><div id=sidebar class=sidebar><a class=screen-reader-text href=#main-menu>Skip to Main Menu</a><div class=container><section class='widget widget-about sep-after'><header><div class=logo><a href=/><img src=/images/logo.png></a></div><h2 class='title site-title'><a href=/>Codewrecks</a></h2><div class=desc>Wrecks of code floating in the sea of internet</div></header></section><section class='widget widget-sidebar_menu sep-after'><nav id=sidebar-menu class='menu sidebar-menu' aria-label='Sidebar Menu'><div class=container><ul><li class=item><a href=/>Home</a></li></ul></div></nav></section><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6590055118491660" crossorigin=anonymous></script><section class='widget widget-taxonomy_cloud sep-after'><header><h4 class='title widget-title'>Tags</h4></header><div class='container list-container'><ul class='list taxonomy-cloud'><li><a href=/tags/actions/ style=font-size:1.0078740157480315em>Actions</a></li><li><a href=/tags/addin/ style=font-size:1.0078740157480315em>Addin</a></li><li><a href=/tags/agile/ style=font-size:1.0236220472440944em>Agile</a></li><li><a href=/tags/ai/ style=font-size:1.015748031496063em>AI</a></li><li><a href=/tags/alm/ style=font-size:1.0629921259842519em>ALM</a></li><li><a href=/tags/aop/ style=font-size:1.0236220472440944em>Aop</a></li><li><a href=/tags/api/ style=font-size:1.1181102362204725em>API</a></li><li><a href=/tags/applicationinsights/ style=font-size:1.0236220472440944em>ApplicationInsights</a></li><li><a href=/tags/architecture/ style=font-size:1.1023622047244095em>Architecture</a></li><li><a href=/tags/architecture-castle/ style=font-size:1.0078740157480315em>Architecture Castle</a></li><li><a href=/tags/aspnet/ style=font-size:1.3700787401574803em>Aspnet</a></li><li><a href=/tags/aspnet-mvc/ style=font-size:1.031496062992126em>AspNet MVC</a></li><li><a href=/tags/automation/ style=font-size:1.0078740157480315em>Automation</a></li><li><a href=/tags/azdo/ style=font-size:1.2283464566929134em>AzDo</a></li><li><a href=/tags/azure/ style=font-size:1.0866141732283465em>Azure</a></li><li><a href=/tags/azure-devops/ style=font-size:1.110236220472441em>Azure Devops</a></li><li><a href=/tags/azure-pipelines/ style=font-size:1.031496062992126em>Azure Pipelines</a></li><li><a href=/tags/azuredevops/ style=font-size:1.1023622047244095em>AzureDevOps</a></li><li><a href=/tags/backup/ style=font-size:1.0078740157480315em>Backup</a></li><li><a href=/tags/blend/ style=font-size:1.0078740157480315em>Blend</a></li><li><a href=/tags/blog/ style=font-size:1.0078740157480315em>Blog</a></li><li><a href=/tags/blogging/ style=font-size:1.0551181102362204em>Blogging</a></li><li><a href=/tags/books/ style=font-size:1.015748031496063em>Books</a></li><li><a href=/tags/branch/ style=font-size:1em>Branch</a></li><li><a href=/tags/build/ style=font-size:1.5984251968503937em>Build</a></li><li><a href=/tags/c/ style=font-size:1.0078740157480315em>C</a></li><li><a href=/tags/castle/ style=font-size:1.236220472440945em>Castle</a></li><li><a href=/tags/chatgpt/ style=font-size:1.0078740157480315em>ChatGPT</a></li><li><a href=/tags/clickonce/ style=font-size:1.0236220472440944em>ClickOnce</a></li><li><a href=/tags/codeanalysis/ style=font-size:1.0078740157480315em>CodeAnalysis</a></li><li><a href=/tags/codespaces/ style=font-size:1.031496062992126em>Codespaces</a></li><li><a href=/tags/continuos-integration/ style=font-size:1.031496062992126em>Continuos Integration</a></li><li><a href=/tags/continuous-deployment/ style=font-size:1.0393700787401574em>Continuous Deployment</a></li><li><a href=/tags/continuous-integration/ style=font-size:1.0866141732283465em>Continuous Integration</a></li><li><a href=/tags/continuousdeployment/ style=font-size:1.0551181102362204em>ContinuousDeployment</a></li><li><a href=/tags/copilot/ style=font-size:1.015748031496063em>Copilot</a></li><li><a href=/tags/cqrs/ style=font-size:1.0078740157480315em>CQRS</a></li><li><a href=/tags/datadude/ style=font-size:1.0393700787401574em>DataDude</a></li><li><a href=/tags/datagrid/ style=font-size:1.0078740157480315em>DataGrid</a></li><li><a href=/tags/ddd/ style=font-size:1.1181102362204725em>DDD</a></li><li><a href=/tags/debugging/ style=font-size:1.0078740157480315em>Debugging</a></li><li><a href=/tags/developing/ style=font-size:1em>Developing</a></li><li><a href=/tags/devops/ style=font-size:1.1181102362204725em>Devops</a></li><li><a href=/tags/docker/ style=font-size:1.0078740157480315em>Docker</a></li><li><a href=/tags/dotnet/ style=font-size:1em>Dotnet</a></li><li><a href=/tags/ef/ style=font-size:1.0078740157480315em>EF</a></li><li><a href=/tags/ef-code-first/ style=font-size:1.031496062992126em>EF Code First</a></li><li><a href=/tags/ef41/ style=font-size:1.0236220472440944em>EF41</a></li><li><a href=/tags/ef5/ style=font-size:1.015748031496063em>EF5</a></li><li><a href=/tags/enterprise-library/ style=font-size:1.0236220472440944em>Enterprise Library</a></li><li><a href=/tags/entity-framework/ style=font-size:1.094488188976378em>Entity Framework</a></li><li><a href=/tags/everydaylife/ style=font-size:1.047244094488189em>EverydayLife</a></li><li><a href=/tags/excel/ style=font-size:1.0078740157480315em>Excel</a></li><li><a href=/tags/experiences/ style=font-size:1.2440944881889764em>Experiences</a></li><li><a href=/tags/frameworks/ style=font-size:1.0629921259842519em>Frameworks</a></li><li><a href=/tags/general/ style=font-size:2em>General</a></li><li><a href=/tags/git/ style=font-size:1.236220472440945em>Git</a></li><li><a href=/tags/git-tf/ style=font-size:1.0078740157480315em>Git-Tf</a></li><li><a href=/tags/github/ style=font-size:1.2440944881889764em>Github</a></li><li><a href=/tags/github-actions/ style=font-size:1.031496062992126em>GitHub Actions</a></li><li><a href=/tags/gpt4/ style=font-size:1em>GPT4</a></li><li><a href=/tags/hacking/ style=font-size:1em>Hacking</a></li><li><a href=/tags/hardware/ style=font-size:1.031496062992126em>Hardware</a></li><li><a href=/tags/homelab/ style=font-size:1em>HomeLab</a></li><li><a href=/tags/hql/ style=font-size:1.0078740157480315em>HQL</a></li><li><a href=/tags/html/ style=font-size:1.0078740157480315em>Html</a></li><li><a href=/tags/hugo/ style=font-size:1em>Hugo</a></li><li><a href=/tags/icriteria/ style=font-size:1.0078740157480315em>ICriteria</a></li><li><a href=/tags/iis/ style=font-size:1.015748031496063em>IIS</a></li><li><a href=/tags/ioc/ style=font-size:1.015748031496063em>IoC</a></li><li><a href=/tags/javascript/ style=font-size:1.0078740157480315em>Javascript</a></li><li><a href=/tags/jquery/ style=font-size:1.047244094488189em>JQuery</a></li><li><a href=/tags/lab-management/ style=font-size:1.1023622047244095em>Lab Management</a></li><li><a href=/tags/languages/ style=font-size:1.0551181102362204em>Languages</a></li><li><a href=/tags/linq/ style=font-size:1.204724409448819em>LINQ</a></li><li><a href=/tags/linux/ style=font-size:1.0551181102362204em>Linux</a></li><li><a href=/tags/log4net/ style=font-size:1.047244094488189em>Log4net</a></li><li><a href=/tags/lucene/ style=font-size:1.0629921259842519em>Lucene</a></li><li><a href=/tags/macro/ style=font-size:1.0236220472440944em>Macro</a></li><li><a href=/tags/masstransit/ style=font-size:1.015748031496063em>Masstransit</a></li><li><a href=/tags/mef/ style=font-size:1.0236220472440944em>MEF</a></li><li><a href=/tags/metroui/ style=font-size:1.0078740157480315em>MetroUi</a></li><li><a href=/tags/microsoft-test-manager/ style=font-size:1.015748031496063em>Microsoft Test Manager</a></li><li><a href=/tags/mms/ style=font-size:1.015748031496063em>Mms</a></li><li><a href=/tags/mongo/ style=font-size:1.0236220472440944em>Mongo</a></li><li><a href=/tags/mongodb/ style=font-size:1.1574803149606299em>MongoDb</a></li><li><a href=/tags/msbuild/ style=font-size:1.031496062992126em>Msbuild</a></li><li><a href=/tags/mstest/ style=font-size:1.0078740157480315em>MsTest</a></li><li><a href=/tags/mvvm/ style=font-size:1.0708661417322836em>MVVM</a></li><li><a href=/tags/nablasoft/ style=font-size:1.0236220472440944em>Nablasoft</a></li><li><a href=/tags/ndepend/ style=font-size:1.0236220472440944em>NDepend</a></li><li><a href=/tags/net/ style=font-size:1.0236220472440944em>Net</a></li><li><a href=/tags/net-core/ style=font-size:1.0078740157480315em>NET Core</a></li><li><a href=/tags/net-framework/ style=font-size:1.5118110236220472em>NET Framework</a></li><li><a href=/tags/netcore/ style=font-size:1.0236220472440944em>NETCORE</a></li><li><a href=/tags/nhibernate/ style=font-size:1.5039370078740157em>Nhibernate</a></li><li><a href=/tags/nosql/ style=font-size:1.0629921259842519em>NoSql</a></li><li><a href=/tags/nsm/ style=font-size:1em>Nsm</a></li><li><a href=/tags/nuget/ style=font-size:1.0393700787401574em>Nuget</a></li><li><a href=/tags/nunit/ style=font-size:1.0393700787401574em>Nunit</a></li><li><a href=/tags/office/ style=font-size:1.0236220472440944em>Office</a></li><li><a href=/tags/oidc/ style=font-size:1em>OIDC</a></li><li><a href=/tags/oop/ style=font-size:1.0236220472440944em>OOP</a></li><li><a href=/tags/openxml/ style=font-size:1.0078740157480315em>OpenXml</a></li><li><a href=/tags/optimization/ style=font-size:1em>Optimization</a></li><li><a href=/tags/orm/ style=font-size:1.0236220472440944em>ORM</a></li><li><a href=/tags/performance/ style=font-size:1.0393700787401574em>Performance</a></li><li><a href=/tags/pgp/ style=font-size:1em>PGP</a></li><li><a href=/tags/pills/ style=font-size:1.2440944881889764em>Pills</a></li><li><a href=/tags/pipeline/ style=font-size:1.0866141732283465em>Pipeline</a></li><li><a href=/tags/pipelines/ style=font-size:1.0236220472440944em>Pipelines</a></li><li><a href=/tags/plugin/ style=font-size:1.031496062992126em>Plugin</a></li><li><a href=/tags/power-tools/ style=font-size:1.0236220472440944em>Power Tools</a></li><li><a href=/tags/powershell/ style=font-size:1.110236220472441em>PowerShell</a></li><li><a href=/tags/process-template/ style=font-size:1.047244094488189em>Process Template</a></li><li><a href=/tags/programming/ style=font-size:1.1496062992125984em>Programming</a></li><li><a href=/tags/pull-requests/ style=font-size:1.015748031496063em>Pull Requests</a></li><li><a href=/tags/pullrequests/ style=font-size:1em>PullRequests</a></li><li><a href=/tags/python/ style=font-size:1.015748031496063em>Python</a></li><li><a href=/tags/ravendb/ style=font-size:1.031496062992126em>RavenDB</a></li><li><a href=/tags/release/ style=font-size:1.047244094488189em>Release</a></li><li><a href=/tags/resharper/ style=font-size:1.0236220472440944em>Resharper</a></li><li><a href=/tags/rest-api/ style=font-size:1em>REST Api</a></li><li><a href=/tags/rest-apis/ style=font-size:1.0236220472440944em>Rest APIs</a></li><li><a href=/tags/rhinomock/ style=font-size:1.0078740157480315em>RhinoMock</a></li><li><a href=/tags/scrum/ style=font-size:1.0078740157480315em>Scrum</a></li><li><a href=/tags/searching/ style=font-size:1.0393700787401574em>Searching</a></li><li><a href=/tags/security/ style=font-size:1.3779527559055118em>Security</a></li><li><a href=/tags/semantickernel/ style=font-size:1em>SemanticKernel</a></li><li><a href=/tags/shim/ style=font-size:1.0078740157480315em>Shim</a></li><li><a href=/tags/silverlight/ style=font-size:1.015748031496063em>Silverlight</a></li><li><a href=/tags/software-architecture/ style=font-size:1.125984251968504em>Software Architecture</a></li><li><a href=/tags/solr/ style=font-size:1.0551181102362204em>Solr</a></li><li><a href=/tags/sonarcloud/ style=font-size:1.0078740157480315em>Sonarcloud</a></li><li><a href=/tags/sonarqube/ style=font-size:1.0551181102362204em>Sonarqube</a></li><li><a href=/tags/source-control/ style=font-size:1em>Source Control</a></li><li><a href=/tags/springnet/ style=font-size:1em>SpringNET</a></li><li><a href=/tags/sql-server/ style=font-size:1.236220472440945em>Sql Server</a></li><li><a href=/tags/ssd/ style=font-size:1.047244094488189em>SSD</a></li><li><a href=/tags/symbols/ style=font-size:1em>Symbols</a></li><li><a href=/tags/team-foundation-server/ style=font-size:1.425196850393701em>Team Foundation Server</a></li><li><a href=/tags/teamfoundationserver/ style=font-size:1.0236220472440944em>TeamFoundationServer</a></li><li><a href=/tags/terraform/ style=font-size:1em>Terraform</a></li><li><a href=/tags/test/ style=font-size:1.0078740157480315em>Test</a></li><li><a href=/tags/testing/ style=font-size:1.5511811023622046em>Testing</a></li><li><a href=/tags/tfs/ style=font-size:1.84251968503937em>Tfs</a></li><li><a href=/tags/tfs-build/ style=font-size:1.236220472440945em>TFS Build</a></li><li><a href=/tags/tfs-power-tools/ style=font-size:1.0078740157480315em>Tfs Power Tools</a></li><li><a href=/tags/tfs-service/ style=font-size:1.0078740157480315em>Tfs Service</a></li><li><a href=/tags/tfs11/ style=font-size:1em>TFS11</a></li><li><a href=/tags/tfsapi/ style=font-size:1.031496062992126em>TfsAPI</a></li><li><a href=/tags/tfsbuild/ style=font-size:1.0629921259842519em>TfsBuild</a></li><li><a href=/tags/tfvc/ style=font-size:1.0078740157480315em>TFVC</a></li><li><a href=/tags/tika/ style=font-size:1.0236220472440944em>Tika</a></li><li><a href=/tags/tls/ style=font-size:1.0078740157480315em>TLS</a></li><li><a href=/tags/tools/ style=font-size:1.0078740157480315em>Tools</a></li><li><a href=/tags/tools-and-library/ style=font-size:1.1338582677165354em>Tools and Library</a></li><li><a href=/tags/tryhackme/ style=font-size:1em>TryHackMe</a></li><li><a href=/tags/uat/ style=font-size:1.015748031496063em>UAT</a></li><li><a href=/tags/ubuntu/ style=font-size:1em>Ubuntu</a></li><li><a href=/tags/unit-testing/ style=font-size:1.047244094488189em>Unit Testing</a></li><li><a href=/tags/unittesting/ style=font-size:1em>UnitTesting</a></li><li><a href=/tags/upgrade/ style=font-size:1em>Upgrade</a></li><li><a href=/tags/vcs/ style=font-size:1.015748031496063em>VCS</a></li><li><a href=/tags/virtual-machine/ style=font-size:1.031496062992126em>Virtual Machine</a></li><li><a href=/tags/visual-studio/ style=font-size:1.3307086614173227em>Visual Studio</a></li><li><a href=/tags/visual-studio-2013/ style=font-size:1.0078740157480315em>Visual Studio 2013</a></li><li><a href=/tags/visual-studio-alm/ style=font-size:1.1732283464566928em>Visual Studio ALM</a></li><li><a href=/tags/visual-studio-database-edition/ style=font-size:1.031496062992126em>Visual Studio Database Edition</a></li><li><a href=/tags/visualstudio/ style=font-size:1.0078740157480315em>VisualStudio</a></li><li><a href=/tags/vnext/ style=font-size:1.0551181102362204em>VNext</a></li><li><a href=/tags/vs11/ style=font-size:1.0236220472440944em>VS11</a></li><li><a href=/tags/vs2010/ style=font-size:1.0078740157480315em>VS2010</a></li><li><a href=/tags/vs2012/ style=font-size:1.031496062992126em>VS2012</a></li><li><a href=/tags/vsalm/ style=font-size:1.015748031496063em>VSAlm</a></li><li><a href=/tags/vso/ style=font-size:1.0708661417322836em>VSO</a></li><li><a href=/tags/vsts/ style=font-size:1.2913385826771653em>VSTS</a></li><li><a href=/tags/vstsdbedition/ style=font-size:1.0078740157480315em>VSTSDBEdition</a></li><li><a href=/tags/wcf/ style=font-size:1.125984251968504em>Wcf</a></li><li><a href=/tags/wcf-iis7/ style=font-size:1.0078740157480315em>WCF IIS7</a></li><li><a href=/tags/web-test/ style=font-size:1.015748031496063em>Web Test</a></li><li><a href=/tags/webbrowser/ style=font-size:1.015748031496063em>WebBrowser</a></li><li><a href=/tags/windows/ style=font-size:1.031496062992126em>Windows</a></li><li><a href=/tags/winforms/ style=font-size:1.0236220472440944em>Winforms</a></li><li><a href=/tags/work-item-tracking/ style=font-size:1em>Work Item Tracking</a></li><li><a href=/tags/workflow/ style=font-size:1.0236220472440944em>Workflow</a></li><li><a href=/tags/wpf/ style=font-size:1.3937007874015748em>WPF</a></li><li><a href=/tags/wsl/ style=font-size:1em>WSL</a></li><li><a href=/tags/wsl2/ style=font-size:1em>Wsl2</a></li><li><a href=/tags/xaml/ style=font-size:1.015748031496063em>XAML</a></li><li><a href=/tags/yaml/ style=font-size:1em>YAML</a></li><li><a href=/tags/zero-trust-security/ style=font-size:1.0078740157480315em>Zero Trust Security</a></li></ul></div></section></div><div class=sidebar-overlay></div></div><div class=main><nav id=main-menu class='menu main-menu' aria-label='Main Menu'><div class=container><a class=screen-reader-text href=#content>Skip to Content</a>
<button id=sidebar-toggler class=sidebar-toggler aria-controls=sidebar>
<span class=screen-reader-text>Toggle Sidebar</span>
<span class=open><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</span><span class=close><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></span></button><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/git-videos/>Git Videos</a></li><li class=item><a href=/privacy/>Privacy</a></li><li class=item><a href=/youtube/>YouTube</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class='widget widget-breadcrumbs sep-after'><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Azure DevOps: Create Docker images for a Pull Request</span></li></ol></nav></section></div></div><header id=header class='header site-header'><div class='container sep-after'><div class=header-info><p class='site-title title'>Codewrecks</p><p class='desc site-desc'>Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class='header entry-header'><div class='container sep-after'><div class=header-info><h1 class=title>Azure DevOps: Create Docker images for a Pull Request</h1><p class=desc>Being able to easily test code of a Pull Request is the key to have a better code management. Most of the time checking only the code increment is not enough to validate a PR</p></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
<span class=screen-reader-text>Posted on </span><time class=entry-date datetime=2024-07-07T07:00:42Z>2024, Jul 07</time>
</span><span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>
9 mins read</span></div></div></header><div class='container entry-content'><p>The whole Pull Request process mechanism has a single purpose, <strong>have a better quality of the code that reach develop or generally speaking main branch</strong>. The ability to share the code and being able to get feedback from other members of the team is invaluable, but it is enough?</p><p>The basic concept is: develop is a branch that should be <strong>considered production</strong> and it is not uncommon for teams to deploy develop branch automatically in internal production servers, a procedure called <strong>dogfooding</strong>. Here in Nebula Team we deploy automatically develop branch in our internal production servers, and sometimes you intercept bug before they hit master and production of all customer.</p><p>Now in this post I&rsquo;ll examine how you can have a better PR experiences, based on our experience of the subject.</p><p>Many thanks to <a href=https://www.linkedin.com/in/danielescarinci>Daniele Scarinci</a> and <a href=https://www.linkedin.com/in/giulianolatini>Giuliano Latini</a> that helped me in creating and putting this process in production for our team.</p><blockquote><p>The real question is: can bugs reach develop if we have Pull Requests?</p></blockquote><p>The answer is: <strong>yes</strong>.</p><p>While Pull Requests usually helps improving the overall quality, there are lots of problems that does not get caught in a pull request. This lead to a <strong>false sense of security</strong>.</p><h2 id=root-problems-of-pull-requests>Root problems of Pull Requests.</h2><p>*<strong>Lack of context or missing big picture</strong>: in most situation peoples uses the web interface to look at changed file, they can spot problems, but quite often they need to examine the code in a real IDE and maybe run in your local environment.</p><p><em><strong>Code is not really executed</strong></em>: in a ideal world, if you want to give green light to a Pull Requests you should execute the code, trying some edge cases, verifying that everything works as expected, then approve it. While we have almost 20k integration and Unit Tests, UI Components are hard to tests, so we can tell that <strong>some part of the code is tested automatically but we need to test manually something.</strong></p><p><em><strong>Pull request is for programmers</strong></em>: this is the major problem, quite often PR are reviewed by developer only, and this seems normal, why someone that is not a programmer want to look at code increment and approve or not?</p><blockquote><p>Pull Request is for the team and for stakeholder, people should be able to run the software of the PR in an environment to approve or reject</p></blockquote><h2 id=why-the-software-is-not-executed>Why the software is not executed?</h2><p>To test code developers should change branch, go to the branch under PR, then run software locally, <strong>the whole process can be tedious, especially because it disrupt local environment</strong>. What about having data that is not compatible because someone is working on another branch? <strong>But the real problem is: a non developer has no way to run PR code in a computer, we need to find a different solution</strong>.</p><blockquote><p>Running PR code often require IDE, installed libraries, database etc, so it is unfeasible to ask to a non-programmer to run PR code locally.</p></blockquote><p>To mitigate those problems it would be nice if we have a simple way to <strong>press a button and have the code resulting from merge of the target branch and source branch being deployed somewhere, maybe on the local computer</strong>. To achieve this the best way is using Docker or other container technique to create, on demand, an image containing PR code. This allows team member to simply pull the image associated to the PR and create a local deployment or automatically deploy on cloud environment.</p><p>Thanks to Azure DevOps this process can be streamlined without any problem. First of all our team started with a build that produces all artifacts needed to run the core of the solution, this runs automatically for develop branch and for master branch, <strong>creating a bunch of .7z files containing deployable code</strong>. We have two of these, producing a couple of services needed.</p><p><a target=_blank href=../images/build-complete-unique-host.png><img src=../images/build-complete-unique-host.png alt="Result of standard build"></a></p><p><em><strong>Figure 1:</strong></em> <em>Result of standard build</em></p><p>Ok, from now we proceeded creating some DOCKERFILE to create docker images from the result of these build. Since we are working with .NET 8 it is quite simple because it runs natively on linux and on ARM. Then we created a nice PowerShell script that <strong>download from a private Azure storage account some 7z files with backup of our demo, test or local instances</strong>. These archives are generated automatically and capture the image of an environment (basically is a complete backup for disaster recovery of database and file storage).</p><p>In these test dockerfile we add instructions to verify if we mounted a backup in a predefined location, if yes, it will <strong>unpack the archive and run a restore script that restore the environment</strong>.</p><blockquote><p>Now we have script to backup a live installation, and some dockerfile that starts from build artifacts and have the ability to completely restore a running environment with real data.</p></blockquote><h2 id=automate-creation-of-docker-images>Automate creation of docker images</h2><p>Thanks to Azure DevOps pipeline, automating the creation of these images is straightforward. First of all the author of docker file can simply</p><ol><li>Download artifacts from the release build</li><li>Unpack artifacts on local folder</li><li>Perform everything locally so he/she can test and fine tune the dockerfile</li></ol><p>Once the file is created, it is time to generate a special pipeline <strong>that is automatically triggered from the release build and can generate those docker images</strong>.</p><p>The pipeline starts with this code.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>trigger</span>: <span style=color:#ae81ff>none</span>
</span></span><span style=display:flex><span><span style=color:#f92672>pr</span>: <span style=color:#ae81ff>none</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>resources</span>: 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>pipelines</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>pipeline</span>: <span style=color:#ae81ff>UniqueHost</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>source</span>: <span style=color:#ae81ff>Publish-UniqueHost</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>branch</span>: <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>trigger</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>include</span>:
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>refs/pull/*/merge</span>
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>            - <span style=color:#ae81ff>develop</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>pipeline</span>: <span style=color:#ae81ff>Proxy</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>source</span>: <span style=color:#ae81ff>Jarvis.Proxy</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>branch</span>: <span style=color:#ae81ff>main</span></span></span></code></pre></td></tr></table></div></div><p>The important part is that this pipeline starts defining other pipeline as resources. The release pipeline is also used as trigger, so this pipeline starts <strong>whenever the publish-UniqueHost pipeline completes a run in develop, master, and any PR branches</strong>.</p><p>Then we can run some bash code to <strong>grab the name of the original pipeline, determined by GitVersion and other informations</strong>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>          - <span style=color:#f92672>download</span>: <span style=color:#ae81ff>UniqueHost</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>artifact</span>: <span style=color:#ae81ff>DeployPackage</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#34;Download Unique Host Artifacts&#34;</span>
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          - <span style=color:#f92672>download</span>: <span style=color:#ae81ff>Proxy</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>artifact</span>: <span style=color:#ae81ff>Jarvis.Proxy</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#34;Download Jarvis Proxy Host Artifacts&#34;</span>
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          - <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;PipelineName: $(resources.pipeline.UniqueHost.pipelineName)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;RunName: $(resources.pipeline.UniqueHost.runName)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;RunUri: $(resources.pipeline.UniqueHost.runURI)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;SourceBranch: $(resources.pipeline.UniqueHost.sourceBranch)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;SourceCommit: $(resources.pipeline.UniqueHost.sourceCommit)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              runName=&#34;$(resources.pipeline.UniqueHost.runName)&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              version=&#34;${runName##*- }&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;version is = $version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;##vso[build.updatebuildnumber]Docker Jarvis Plus Proxy - $version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              if [[ $version =~ PullRequest([0-9]+) ]]; then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  pullRequestNumber=&#34;${BASH_REMATCH[1]}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  version=&#34;PR$pullRequestNumber&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  echo &#34;$version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              elif [[ $version =~ ([0-9]+\.[0-9]+\.[0-9]+)-alpha ]]; then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  developNumber=&#34;${BASH_REMATCH[1]}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  version=&#34;$developNumber-develop&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  echo &#34;$version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>               elif [[ $version =~ ([0-9]+\.[0-9]+\.[0-9]+)-beta ]]; then
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  hotfixNumber=&#34;${BASH_REMATCH[1]}&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  version=&#34;$hotfixNumber-hotfix&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  echo &#34;$version&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              else
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                  echo &#34;No Pull Request found in the string.&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              fi
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              echo &#34;##vso[task.setvariable variable=version;]$version&#34;</span>              </span></span></code></pre></td></tr></table></div></div><p>It seems complicated but it is really simple:</p><ol><li>A couple of download task will simply download the artifacts of other pipeline defined as resources</li><li>A bunch of echo are only to demonstrate how we can grab data from the run of other pipelines, the important part is grabbing run version.</li><li>From run version (created by gitversion) we used some regex to understand the origin branch (PullRequest, alpha and beta) so we can create a meaningful tag for Docker Images</li><li>Used a special echo with ##vso to set a variable for the pipeline with the version we will use for tag</li></ol><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>         - <span style=color:#f92672>script</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              7z x &#34;$(Pipeline.Workspace)/UniqueHost/DeployPackage/jarvis.host.7z&#34; -o&#34;$(Build.SourcesDirectory)/Assets/Docker/Jarvis/Jarvis.Host&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              7z x &#34;$(Pipeline.Workspace)/Proxy/Jarvis.Proxy/Jarvis.Proxy.7z&#34; -o&#34;$(Build.SourcesDirectory)/Assets/Docker/Jarvis/Jarvis.Proxy&#34;</span>              
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#34;Prepare files&#34;</span>
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>Docker@2</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containerRegistry</span>: <span style=color:#e6db74>&#39;Nebula&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>command</span>: <span style=color:#e6db74>&#39;login&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Login to nebula repository&#39;</span>
</span></span><span style=display:flex><span>          
</span></span><span style=display:flex><span>          - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>Docker@2</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containerRegistry</span>: <span style=color:#e6db74>&#39;Nebula&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>repository</span>: <span style=color:#e6db74>&#39;Jarvis&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>command</span>: <span style=color:#e6db74>&#39;build&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>Dockerfile</span>: <span style=color:#e6db74>&#39;$(Build.SourcesDirectory)/Assets/Docker/Jarvis/Dockerfile&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>tags</span>: <span style=color:#e6db74>&#39;$(Version)&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Build the image&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          - <span style=color:#f92672>task</span>: <span style=color:#ae81ff>Docker@2</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>inputs</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containerRegistry</span>: <span style=color:#e6db74>&#39;Nebula&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>repository</span>: <span style=color:#e6db74>&#39;Jarvis&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>command</span>: <span style=color:#e6db74>&#39;push&#39;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>tags</span>: <span style=color:#e6db74>&#39;$(Version)&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>displayName</span>: <span style=color:#e6db74>&#39;Push the image&#39;</span></span></span></code></pre></td></tr></table></div></div><p>Finally we unpack the 7z packages, login into the Azure Docker Registry for our company then finally run a Docker@2 task to build the image. Thanks to Azure DevOps in Hosted agents we already have Docker configured to create images. <strong>Finally images are published.</strong></p><blockquote><p>In the end we have established a pipeline that create a release and automatically trigger another pipeline that download artifacts from that pipeline and create docker images with a correct tag depending on branch built.</p></blockquote><p>At the end of the process we have Docker Images automatically created for special branches (develop) and for PR branches.</p><h2 id=wire-everything-together>Wire everything together</h2><p>Ok now we need a last piece of the puzzle: <strong>how a person can request the creation of a Docker image for a Pull Request?</strong> This requirement is needed because we do not want to create an image for all Pull Requests, some of the PR are small and there is no need to execute them. The result is: Azure DevOps repository branch policies.</p><p>Now simply add the <strong>Original publish branch as Optional Check and Manual Run</strong>. This will make this pipeline not required to close the Pull Request, but if someone wants, he/she can simply request this pipeline to run directly from the PR page.</p><p><a target=_blank href=../images/branch-policy-publish.png><img src=../images/branch-policy-publish.png alt="Policy configuration to add an optional release build"></a></p><p><em><strong>Figure 2:</strong></em> <em>Policy configuration to add an optional release build</em></p><p>Here is how a branch can allow the trigger the creation of Docker Images on that PR. <strong>Remember that the build will build the PR code once merged with the target branch, so you are really creating an image of the code that will result from closing of the Pull Request</strong>. This is important because develop can contains code that can interact with PR code, so it is needed to test the merge of both branches.</p><p><a target=_blank href=../images/docker-optional-check.png><img src=../images/docker-optional-check.png alt="Optional Check in a Pull request"></a></p><p><em><strong>Figure 3:</strong></em> <em>Optional Check in a Pull request</em></p><p>As you can see in Figure 3 we have a standard Pull Request pipeline that runs and it is green, but we have <strong>one check not run so we can request a manual run</strong>. Clicking on View 2 Checks opens the list of the checks where you can request a run of the pipeline that create the build.</p><p><a target=_blank href=../images/manual-queue-build.png><img src=../images/manual-queue-build.png alt="You can simply queue the pipeline that create release package and then trigger Docker image creation pipeline"></a></p><p><em><strong>Figure 4:</strong></em> <em>You can simply queue the pipeline that create release package, at the end it will trigger automatically Docker image creation pipeline</em></p><p>Just wait a little bit and the you will find corresponding images into your Azure Docker Registry.</p><p><a target=_blank href=../images/docker-images.png><img src=../images/docker-images.png alt="Docker images automatically created"></a></p><p><em><strong>Figure 5:</strong></em> <em>Docker images automatically created</em></p><p>As you can see we have two images for two Pull Request then an image for the develop branch and one for the master branch.</p><blockquote><p>Thanks to Azure DevOps pipeline you can automate the whole process of build and create Docker Images from a Pull Request, creating Docker Images that contains the result of merge of PR branch with target branch.</p></blockquote><p>Now we can simply run a PowerShell script to have a version of the software running in our computer with some test data just installing Docker Desktop. This gives the ability to everyone in the team to Run Pull Request code and being able to test for edge cases, security or simply <strong>evaluating if the new feature is really good to be closed in the target branch</strong>.</p><p>And again this demonstrate the flexibility of Azure DevOps and the great feature it offers to keep your code quality to the max.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class='container sep-before'><div class=last-updated><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20 14.66V20a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2h5.34"/><polygon points="18 2 22 6 12 16 8 16 8 12 18 2"/></svg>
<span class=screen-reader-text>Last updated: </span><time class=entry-date datetime=2024-07-07T07:00:42Z>2024, Jul 07</time></div><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg>
<span class=screen-reader-text>Categories: </span><a class=category href=/categories/azuredevops/>AzureDevOps</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=screen-reader-text>Tags: </span><a class=tag href=/tags/azdo/>AzDo</a></div></div></footer></article><nav class=entry-nav><div class=container><div class='prev-entry sep-before'>Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class='prev-entry sep-before'><a href=/post/ai/gh-copilot-workspace-first-impression/><span aria-hidden=true>Previous</span>
<span class=screen-reader-text>Previous post: </span>GitHub Copilot Workspace: first impression</a></div><div class='next-entry sep-before'><a href=/post/azdo/pipeline/clean-docker-images-for-your-pull-requests/><span class=screen-reader-text>Next post: </span>Azure DevOps: Cleanup Docker images for your Pull Requests<span aria-hidden=true>Next</span></a></div></div></nav></main><footer id=footer class=footer><div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'><ul><li><a href=https://github.com/alkampfergit target=_blank rel='noopener me'><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel='noopener me'><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel='noopener me'><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel='noopener me'><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2025 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law"),$(document).euCookieLawPopup().init({cookiePolicyUrl:"/privacy/",popupPosition:"top",colorStyle:"default",compactStyle:!1,popupTitle:"This website is using cookies",popupText:"By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.",buttonContinueTitle:"Continue",buttonLearnmoreTitle:"Learn more about this site Privacy &amp; Cookies Policy",buttonLearnmoreOpenInNewWindow:!0,agreementExpiresInDays:30,autoAcceptCookiePolicy:!1,htmlMarkup:null})</script></body></html>