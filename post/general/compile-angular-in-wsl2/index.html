<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Windows subsystem for Linux now has a real Linux kernel and many other goodness. Let's explore how to use it"><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Compiling Angular app in WSL2 • Codewrecks"><meta property="og:description" content="Windows subsystem for Linux now has a real Linux kernel and many other goodness. Let's explore how to use it"><meta property="og:url" content="https://www.codewrecks.com/post/general/compile-angular-in-wsl2/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Linux"><meta property="article:tag" content="wsl2"><meta property="article:published_time" content="2020-06-06T08:00:00+02:00"><meta property="article:modified_time" content="2020-06-06T08:00:00+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Compiling Angular app in WSL2 • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/general/compile-angular-in-wsl2/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Compiling Angular app in WSL2</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Compiling Angular app in WSL2</h1><p class=desc>Windows subsystem for Linux now has a real Linux kernel and many other goodness. Let's explore how to use it</p></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2020-06-06T08:00:00+02:00>2020, Jun 06</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>Windows Subsystem for Linux was a nice toy to play, but never impressed me very much, one of the reason is its limitations. I do not work much on Linux, but usually I have Linux boxes with MongoDB, Elasticsearch and play with security related stuff and for those purposes <strong>I have <a href=http://www.codewrecks.com/post/security/play-security-in-a-secure-environment/>dedicated virtual machines</a>.</strong></p><p>This was the reason why I did not found any real useful usage for WSL, I&rsquo;ve tried to quick do NMAP scan, but I got errors since it did not run a real Linux full kernel and NMap wants to have full access to the NIC to do its stuff. <strong>Now that we have WSL2 things starts to change.</strong></p><blockquote><p>Second version of Windows Subsystem for Linux has a real Linux kernel, ext4, and it is a real VM that runs integrated in Windows</p></blockquote><p>Now that WSL2 is out I was convinced by my dear Friends Matteo Emili and Giulio Vian to give another try, so I <a href=https://docs.microsoft.com/en-us/windows/wsl/install-win10>followed the guide</a> and configured WSL2 on my machine. First of all I did an NMap scan to verify that everything is now good and the answer is YES!</p><p><a target=_blank href=../images/wsl2-nmap.png><img src=../images/wsl2-nmap.png alt="Nmap scan on WSL2"></a>
<em><strong>Figure1</strong></em>: <em>Nmap was able to perfectly scan a target in WSL2</em>.</p><p>As always my question is: Why I should use WSL2 if I can fire a standard Linux Virtual machine? The answer is not straightforward, but essentially it is really <strong>simpler for a user not used to virtualization and Linux to setup everything with few clicks</strong>. Probably the best advantage is that you can see and interact read/write to Windows filesystem from Linux and vice-versa. In WSL you can access Windows disks in /mnt but the cool part is that you can <strong>access Linux disk from Windows in the special share \WSL$</strong>.</p><p><a target=_blank href=../images/wsl2-liunux-share-in-action.png><img src=../images/wsl2-liunux-share-in-action.png alt="Linux share in action"></a>
<em><strong>Figure2</strong></em>: <em>Linux share in action, access Linux filesystem directly from Windows</em>.</p><blockquote><p>The best advantage of WSL2 is that you have full read/write access between host and WSL2 file systems with 0 friction.</p></blockquote><p>Given this nice feature and the fact that WSL2 runs a real ext4 filesystem I decided to test in a big Angular project I&rsquo;m working to, because everyone knows that ext4 performs better with lots of small files and I should not remind you of average size of node_modules folder. <strong>So I run a ng build &ndash;watch on this project, both on Windows filesystem and bot in WSL2</strong> and the difference in build time is quite important.</p><p>First build in Linux took 105 seconds to precompile everything then another 22 seconds to become operative.</p><p><a target=_blank href=../images/wsl2-jarvis-build-fresh.png><img src=../images/wsl2-jarvis-build-fresh.png alt="First build in WSL2"></a>
<em><strong>Figure3</strong></em>: <em>Build time in WSL2 of a big Angular project</em>.</p><p>This is the result of a fresh ng build &ndash;watch on the project, made inside WSL2, now I issued the very same command in Windows, I pay attention not to have other software running in the meanwhile to not affect the result and here is what I got.</p><p><a target=_blank href=../images/Windows-angular-build-fresh.png><img src=../images/Windows-angular-build-fresh.png alt="First build in Windows"></a>
<em><strong>Figure4</strong></em>: <em>Build time in Windows of the very same project</em>.</p><p>I can assure that these number are repeatable, build time tends to change and it is not stable, but it always show this kind of percentage difference from Windows and Linux. As you can see <strong>the difference in the first number is huge, about 50% less build time</strong>, while actually starting to watch the folder uses less time. If I stop the build &ndash;watch and run it again, in the second run all libraries are now precompiled (Angular 9) so I took another timing to understand the difference when libraries are precompiled.</p><p>This gives me 174 seconds in Windows and 92 seconds in Linux, <strong>this huge performance gain is too good to ignore</strong>, so I decided to start developing Angular part of the project in WSL.</p><p>This is really interesting because <strong>the result of Linux build, is perfectly accessible from Windows through the \WSL$ share</strong>, this gives me benefit of much quicker build time and the ability to have the result available to Windows.</p><blockquote><p>Thanks to WSL2 I can use full power of Linux machine to build my Angular project and access the result from Windows.</p></blockquote><p>Now the only thing that disappointed me is that I tried to expose the result of the build through the \WSL$ share in IIS as Virtual Folder(we actually have a Full Framework Web API solution hosted in IIS with Angular app served on the same host as subfolder) but <strong>IIS seems not to be able to access the share due to permissions</strong>. I do not know if this happens because my user is not an administrator of the machine, but this disappointed me a little bit.</p><p>In the meanwhile, while I&rsquo;m investigating on the ability of IIS to access \WSL$ share, <strong>I&rsquo;ve simply setup a SAMBA share on WSL2 and re-exposed my project folder through SAMBA and then serve that directory as Virtual folder in IIS.</strong></p><p>Now a usual question arise: Why spent all this time in WSL2 if you have all those Linux VM? The answer is YES, everything I did in WSL2 could be done with a Virtual Machine, but <strong>there is another cool player in this scenario Visual Studio Code with Remote WSL addin.</strong>. Thanks to that addin, my Visual Studio code can connect with a single command to my WSL2 instance and work With directly with project folder inside my WSL2 Linux.</p><p><a target=_blank href=../images/Visual-Studio-Code-WSL2.png><img src=../images/Visual-Studio-Code-WSL2.png alt="Visual studio Code connection to WSL2"></a>
<em><strong>Figure5</strong></em>: <em>Visual Studio Code can seamlessly connect to WSL</em>.</p><blockquote><p>Visual Studio Code can connect with a single command to WSL instance and work with Files as if you are working inside the WSL machine</p></blockquote><p>Ok, it is true that you can use the same technique to connect to a Linux machine in SSH, but with WSL2 it is just firing your Visual Studio Code, connecting to WSL machine and you are ready to go. No VM to start, no SSH to configure, no firewall management nothing, <strong>you have a real Linux VM running inside your system with seamlessly integration with your Windows Environment.</strong></p><p><a target=_blank href=../images/wsl2-virtual-machine.png><img src=../images/wsl2-virtual-machine.png alt="WSL2 virtual machine running"></a>
<em><strong>Figure 6</strong></em>: <em>WSL2 runs inside a real virtual environment as you can verify from Task Manager</em></p><p>As you can see from <strong>Figure 6</strong> WSL2 is running in a virtual environment, so there is really no reason to install a real Linux machine to use a Linux system if you have a Windows Environment. I still use Linux VM for lots of stuff, <strong>but it is really awesome to have a fully functional VM with few clicks and it works perfectly</strong>.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/general/>general</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/linux/>Linux</a>, <a class=tag href=/tags/wsl2/>wsl2</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/azdo/pipeline/release-multiple-build/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Release a product composed by multiple projects and builds</a></div><div class="next-entry sep-before"><a href=/post/security/kali-linux-in-wsl2/><span class=screen-reader-text>Next post: </span>Use Kali linux in Windows Subsystem for Linux <span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>