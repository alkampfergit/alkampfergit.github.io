<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I&rsquo;m not a javascript fan, but sometimes I have the need to write some client script code, to make the application more responsive.
In a project I was working on, we have the main page with a gridview that shows 15 components at time, each component has really a lot of information to show to the user, so the first version uses the ModalPopupExtender from AjaxControlToolkit to move in a popup the extended informations."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Using a single ModalPopupExtender to show Dynamic Complex Data • Codewrecks"><meta property="og:description" content="I&rsquo;m not a javascript fan, but sometimes I have the need to write some client script code, to make the application more responsive.
In a project I was working on, we have the main page with a gridview that shows 15 components at time, each component has really a lot of information to show to the user, so the first version uses the ModalPopupExtender from AjaxControlToolkit to move in a popup the extended informations."><meta property="og:url" content="https://www.codewrecks.com/post/old/2008/06/using-a-single-modalpopupextender-to-show-dynamic-complex-data/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Uncategorized"><meta property="article:published_time" content="2008-06-06T09:00:37+02:00"><meta property="article:modified_time" content="2008-06-06T09:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Using a single ModalPopupExtender to show Dynamic Complex Data • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2008/06/using-a-single-modalpopupextender-to-show-dynamic-complex-data/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Using a single ModalPopupExtender to show Dynamic Complex Data</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Using a single ModalPopupExtender to show Dynamic Complex Data</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2008-06-06T09:00:37+02:00>2008, Jun 06</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>I&rsquo;m not a javascript fan, but sometimes I have the need to write some client script code, to make the application more responsive.</p><p>In a project I was working on, we have the main page with a gridview that shows 15 components at time, each component has really a lot of information to show to the user, so the first version uses the ModalPopupExtender from AjaxControlToolkit to move in a popup the extended informations. We set a column in the gridview with a div with basic data, when you click on the div the modal popup opens up and shows extended data on the element clicked.</p><p>All works fine, until I realized that the page is 412kb too big&mldr;really too much. Commenting out the extended data in the modal popup the size dropped to 120 kb, still a big page, but really smaller than the original one. So I asked myself, <em>since the user does not want to see extended data for all the elements, it is possible to ask for these data on demand by client script code?</em></p><p>The idea to manipulate complex dom objects makes me feel unconfortable, the panel with extended data contains dropdown, images, and a lot of other control, so I decided to try a quick and dirty approach. I move the code that generates the extended data in a page on his own, I pass the id of the record via querystring, and I put all the content in a div. The result is a page that when called returns a page with all the content I need to show in the popup panel.</p><p>The tricky part of the code was actually the javascript part that needs to</p><ol><li><p>Store the div data in some sort of internal array (I do not want to ask for detail panel each time I click on the same object again and again)</p></li><li><p>If the div data is not saved, I had to call asincronously the server page that generate the data and grab all HTML</p></li><li><p>From the HTML returned by the page, I have to find the div that contains all data, then store the div in an internal array as cache</p></li><li><p>I must identify the div that is used by ModalPopupExtender, this div originally contains an empty div, my script simply swap the original empty div with the real one returned from the server page.</p></li></ol><p>Here is part of the script</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-CSharp data-lang=CSharp> <span style=color:#ae81ff>1</span> NSPreview.PreviewManager.prototype.ShowPanel = function(panelId, analysisId, fullPanelUrlGenerator, waitingimage, showPopup) {
 <span style=color:#ae81ff>2</span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>._panels[panelId] == <span style=color:#66d9ef>null</span> || <span style=color:#66d9ef>this</span>._panels[panelId].id != analysisId) {
 <span style=color:#ae81ff>3</span>         <span style=color:#66d9ef>var</span> reqFinished;
 <span style=color:#ae81ff>4</span>         <span style=color:#66d9ef>var</span> request = <span style=color:#66d9ef>new</span> Sys.Net.WebRequest();
 <span style=color:#ae81ff>5</span>         request.set_url(fullPanelUrlGenerator);
 <span style=color:#ae81ff>6</span>         <span style=color:#66d9ef>var</span> array = <span style=color:#66d9ef>this</span>._panels;
 <span style=color:#ae81ff>7</span>         <span style=color:#66d9ef>var</span> div = document.getElementById(<span style=color:#66d9ef>this</span>._theDivId);
 <span style=color:#ae81ff>8</span>         request.add_completed(function(executor, eventargs) {
 <span style=color:#ae81ff>9</span>             <span style=color:#66d9ef>var</span> data  = <span style=color:#66d9ef>new</span> Object();
<span style=color:#ae81ff>10</span>             <span style=color:#66d9ef>var</span> pageContent = executor.get_responseData();
<span style=color:#ae81ff>11</span>             <span style=color:#66d9ef>var</span> fullcontent = document.createElement(<span style=color:#960050;background-color:#1e0010>&#39;</span>div<span style=color:#960050;background-color:#1e0010>&#39;</span>);
<span style=color:#ae81ff>12</span>             fullcontent.innerHTML = pageContent;
<span style=color:#ae81ff>13</span>             <span style=color:#66d9ef>var</span> allDivs = fullcontent.getElementsByTagName(<span style=color:#960050;background-color:#1e0010>&#39;</span>div<span style=color:#960050;background-color:#1e0010>&#39;</span>);
<span style=color:#ae81ff>14</span>             <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> I = <span style=color:#ae81ff>0</span>; I &lt; allDivs.length; ++I) {
<span style=color:#ae81ff>15</span>                 <span style=color:#66d9ef>if</span> (allDivs[I].id == <span style=color:#960050;background-color:#1e0010>&#39;</span>info<span style=color:#960050;background-color:#1e0010>&#39;</span>) data.divElement = allDivs[I]; 
<span style=color:#ae81ff>16</span>             }
<span style=color:#ae81ff>17</span>             data.id = analysisId;
<span style=color:#ae81ff>18</span>             array[panelId] = data;
<span style=color:#ae81ff>19</span>             
<span style=color:#ae81ff>20</span>             div.replaceChild(data.divElement, div.childNodes[<span style=color:#ae81ff>0</span>]);
<span style=color:#ae81ff>21</span>             showPopup();
<span style=color:#ae81ff>22</span>         });
<span style=color:#ae81ff>23</span>         request.invoke();
<span style=color:#ae81ff>24</span>    } <span style=color:#66d9ef>else</span> {
<span style=color:#ae81ff>25</span>         <span style=color:#66d9ef>var</span> div = document.getElementById(<span style=color:#66d9ef>this</span>._theDivId); <span style=color:#75715e>//.innerHTML = this._panels[panelId].divElement.innerHTML;
</span><span style=color:#75715e></span><span style=color:#ae81ff>26</span>         div.replaceChild(<span style=color:#66d9ef>this</span>._panels[panelId].divElement, div.childNodes[<span style=color:#ae81ff>0</span>]);
<span style=color:#ae81ff>27</span>         showPopup();
<span style=color:#ae81ff>28</span>    }
<span style=color:#ae81ff>29</span>    <span style=color:#66d9ef>this</span>._current = panelId;
<span style=color:#ae81ff>30</span> }
</code></pre></td></tr></table></div></div><p>The function accept 5 parameters, the first is the index of the element in the grid 1, 2, 3… the second is the id of the element, the third is the full url that generates the panel, the fourth is the address of an image to show that the page is doing something (actually still nt used) then finally is a callback to call after the data in the div is changed (Actually used to show the popup). The line 2 is the condition, if I do not have the div into the array, or if the id associated with the div is not the same (maybe I move to the next page of records) I need to update data. I use a WebRequest object and get all the data from the page. The trick is in line 11, I create a dynamic div element in the DOM, I assign to its innerHTML the content of the page, then with getElementsByTagName I’m able to browse all the divs to find the one that has the content. Then I simply create an object to store the actual id of the element and the div with the data. Finally I call replaceChild to swap the old div with the new one, the game is done.</p><p>The result is that with no great effort, with Ajax Library, you are able to ask for a page in the server, takes all content, and use that content in main page. Size of the page is dropped to 120kb and the server is more responsive. Moreover the first implementation has a ModalPopupExtender for each line in the gridview, the new version has only one that manipulate the div with the dynamic content.</p><p>Alk.</p><p>Tags: <a href=http://technorati.com/tag/ModalPopupExtender>ModalPopupExtender</a></p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/general/>general</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/uncategorized/>Uncategorized</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2008/06/resharper-40-goes-in-rc-almost-finished/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Resharper 40 goes in RC almost finished</a></div><div class="next-entry sep-before"><a href=/post/old/2008/06/debugging-javascript-with-visual-studio-2005/><span class=screen-reader-text>Next post: </span>debugging Javascript with Visual Studio 2005<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>