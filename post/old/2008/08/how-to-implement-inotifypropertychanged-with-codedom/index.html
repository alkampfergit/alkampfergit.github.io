<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In a little series of posts I showed how to create runtime class that extend a base entity to implement INotifyPropertyChanged. Despite the fact that dynamic code generation is surely not the best option to implement such an interface, I’m still interested in showing how to do it.
The greatest problem of Run-Time code generation with Reflection.Emit or Castle.DynamicProxy is that you cannot use generated class in your code, this is simply due to the fact that the type exists only at runtime."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="How to implement INotifyPropertyChanged with CodeDom • Codewrecks"><meta property="og:description" content="In a little series of posts I showed how to create runtime class that extend a base entity to implement INotifyPropertyChanged. Despite the fact that dynamic code generation is surely not the best option to implement such an interface, I’m still interested in showing how to do it.
The greatest problem of Run-Time code generation with Reflection.Emit or Castle.DynamicProxy is that you cannot use generated class in your code, this is simply due to the fact that the type exists only at runtime."><meta property="og:url" content="https://www.codewrecks.com/post/old/2008/08/how-to-implement-inotifypropertychanged-with-codedom/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="NET framework"><meta property="article:published_time" content="2008-08-14T01:00:37+02:00"><meta property="article:modified_time" content="2008-08-14T01:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>How to implement INotifyPropertyChanged with CodeDom • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2008/08/how-to-implement-inotifypropertychanged-with-codedom/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>How to implement INotifyPropertyChanged with CodeDom</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>How to implement INotifyPropertyChanged with CodeDom</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2008-08-14T01:00:37+02:00>2008, Aug 14</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>In a little series of posts I showed how to create runtime class that extend a base entity to implement INotifyPropertyChanged. Despite the fact that dynamic code generation is surely not the best option to implement such an interface, I’m still interested in showing how to do it.</p><p>The greatest problem of Run-Time code generation with Reflection.Emit or Castle.DynamicProxy is that you cannot use generated class in your code, this is simply due to the fact that the type exists only at runtime. Another approach is to generate source code at design time, this makes possible to use the generated type wherever you want, and extend it thanks to Partial keyword.</p><p>A straightforward approach is simply generating the source code in a string, after all writing a.cs file filled with code is not a difficult task, but what about visual basic? It turns out that CodeDom is a best approach to generate source files, because you create a definition of the code with code, and then you can transform such a definition into source code with the provider of your language of choice. In the project that you can download <a href=http://www.codewrecks.com/blog/storage/codedyn.zip>here</a> you find a possible implementation in the file CodeDomProxy. In the beginning of the file you generate the type</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>newType = <span style=color:#66d9ef>new</span> CodeTypeDeclaration(className);
newType.BaseTypes.Add(baseType);
newType.TypeAttributes = TypeAttributes.Public;
newType.IsPartial = <span style=color:#66d9ef>true</span>;
newType.BaseTypes.Add(<span style=color:#66d9ef>new</span> CodeTypeReference(<span style=color:#66d9ef>typeof</span>(INotifyPropertyChanged)));
</code></pre></td></tr></table></div></div><p>This is really simple, as to create a new CodeTypeDeclaration object setting the base class, and various other properties. Then we must generate the PropertyChanged event</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>CodeMemberEvent PropertyChangedEvent = <span style=color:#66d9ef>new</span> CodeMemberEvent();
PropertyChangedEvent.Name = <span style=color:#e6db74>&#34;PropertyChanged&#34;</span>;
PropertyChangedEvent.Type = <span style=color:#66d9ef>new</span> CodeTypeReference( <span style=color:#66d9ef>typeof</span>(PropertyChangedEventHandler));
PropertyChangedEvent.Attributes = MemberAttributes.Public;
newType.Members.Add(PropertyChangedEvent);
</code></pre></td></tr></table></div></div><p>As you can see, working with codedom is mainly a matter of creating the right member of the class, CodeMemberEvent for an event, setting name, and finally adding the members collection of the CodeTypeDeclarationClass. Now our class has the event, but it lack a method called OnPropertyChanged used to invoke the event.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp> <span style=color:#ae81ff>1</span> CodeMemberMethod OnPropertyChanged = <span style=color:#66d9ef>new</span> CodeMemberMethod();
 <span style=color:#ae81ff>2</span> OnPropertyChanged.Name = <span style=color:#e6db74>&#34;OnPropertyChanged&#34;</span>;
 <span style=color:#ae81ff>3</span> OnPropertyChanged.Attributes = MemberAttributes.Family;
 <span style=color:#ae81ff>4</span> OnPropertyChanged.Parameters.Add(<span style=color:#66d9ef>new</span> CodeParameterDeclarationExpression(
 <span style=color:#ae81ff>5</span>     <span style=color:#66d9ef>new</span> CodeTypeReference(<span style=color:#66d9ef>typeof</span>(String)), <span style=color:#e6db74>&#34;Property&#34;</span>));
 <span style=color:#ae81ff>6</span> 
 <span style=color:#ae81ff>7</span> <span style=color:#75715e>//Declare temp variable holding the event
</span><span style=color:#75715e></span> <span style=color:#ae81ff>8</span> CodeVariableDeclarationStatement vardec = <span style=color:#66d9ef>new</span> CodeVariableDeclarationStatement(
 <span style=color:#ae81ff>9</span>     <span style=color:#66d9ef>new</span> CodeTypeReference(<span style=color:#66d9ef>typeof</span>(PropertyChangedEventHandler)), <span style=color:#e6db74>&#34;temp&#34;</span>);
<span style=color:#ae81ff>10</span> vardec.InitExpression =  <span style=color:#66d9ef>new</span> CodeEventReferenceExpression(
<span style=color:#ae81ff>11</span>     <span style=color:#66d9ef>new</span> CodeThisReferenceExpression(), <span style=color:#e6db74>&#34;PropertyChanged&#34;</span>);
<span style=color:#ae81ff>12</span> OnPropertyChanged.Statements.Add(vardec);
<span style=color:#ae81ff>13</span> 
<span style=color:#ae81ff>14</span> <span style=color:#75715e>//The part of the true, create the event and invoke it
</span><span style=color:#75715e></span><span style=color:#ae81ff>15</span> CodeObjectCreateExpression   createArgs = <span style=color:#66d9ef>new</span> CodeObjectCreateExpression(
<span style=color:#ae81ff>16</span>     <span style=color:#66d9ef>new</span> CodeTypeReference(<span style=color:#66d9ef>typeof</span>(PropertyChangedEventArgs)),
<span style=color:#ae81ff>17</span>     <span style=color:#66d9ef>new</span> CodeArgumentReferenceExpression(<span style=color:#e6db74>&#34;Property&#34;</span>));
<span style=color:#ae81ff>18</span> CodeDelegateInvokeExpression raiseEvent = <span style=color:#66d9ef>new</span> CodeDelegateInvokeExpression(
<span style=color:#ae81ff>19</span>     <span style=color:#66d9ef>new</span> CodeVariableReferenceExpression(<span style=color:#e6db74>&#34;temp&#34;</span>), 
<span style=color:#ae81ff>20</span>     <span style=color:#66d9ef>new</span> CodeThisReferenceExpression(), createArgs);
<span style=color:#ae81ff>21</span> 
<span style=color:#ae81ff>22</span> <span style=color:#75715e>//The conditino
</span><span style=color:#75715e></span><span style=color:#ae81ff>23</span> CodeExpression condition = <span style=color:#66d9ef>new</span> CodeBinaryOperatorExpression(
<span style=color:#ae81ff>24</span>     <span style=color:#66d9ef>new</span> CodeVariableReferenceExpression(<span style=color:#e6db74>&#34;temp&#34;</span>),
<span style=color:#ae81ff>25</span>     CodeBinaryOperatorType.IdentityInequality,
<span style=color:#ae81ff>26</span>     <span style=color:#66d9ef>new</span> CodePrimitiveExpression(<span style=color:#66d9ef>null</span>));
<span style=color:#ae81ff>27</span> 
<span style=color:#ae81ff>28</span> <span style=color:#75715e>//The if condition
</span><span style=color:#75715e></span><span style=color:#ae81ff>29</span> CodeConditionStatement ifTempIsNull = <span style=color:#66d9ef>new</span> CodeConditionStatement();
<span style=color:#ae81ff>30</span> ifTempIsNull.Condition = condition;
<span style=color:#ae81ff>31</span> ifTempIsNull.TrueStatements.Add(raiseEvent);
<span style=color:#ae81ff>32</span> OnPropertyChanged.Statements.Add(ifTempIsNull);
</code></pre></td></tr></table></div></div><p>In lines 1-5 I setup the method, declaring name, attributes and a parameter of type string called Property. In line 8-12 I created a temp variable to store a temp reference of the event handler, to declare a variable you use the CodeVariableDeclarationStatement, the constructor accepts an CodeTypeReference used to specify the type of the variable and a string specifying the name. The CodeVariableDeclarationStatement has a property named InitExpression that accepts a <em>CodeExpression</em> object, that is the base type used to declare statements with CodeDom. Since I want the temp variable to be initialized with the actual value of the event handler, I use a CodeEventReferenceExpression that needs the object instance (a CodeThisReferenceExpression() used to reference this) and the name of the Event. Finally you can add this instruction to the Statements collection of the OnPropertyChangedMethod.</p><p>Finally I have to define a simple condition (temp != null) and invoke the handler if it is true. Line 15-20 declare the block of the code used in the true part, is simply a CodeObjectCreateExpression used to create the PropertyChangedEventArgs needed by the event and finally a CodeDelegateInvokeExpression to invoke the delegate itself.</p><p>Lines 23-26 are used to create the condition, then lines 29-31 are used to generate the if and setup all the code block.</p><p>All this code to define a simple method that invoke the handler of the event if it’s not null, the CodeDom is really verbose. The rest of the code is really similar, it simply iterate all properties of the original object creating an override for each virtual one, finally if you want to generate the code you can call this function.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:#66d9ef>private</span> String GenerateCSharpFile()
{
    StringBuilder sb = <span style=color:#66d9ef>new</span> StringBuilder();
    TextWriter tw = <span style=color:#66d9ef>new</span> StringWriter(sb);
    CodeDomProvider provider = <span style=color:#66d9ef>new</span> CSharpCodeProvider();
    CodeNamespace nspace = <span style=color:#66d9ef>new</span> CodeNamespace(<span style=color:#e6db74>&#34;MyProxy&#34;</span>);

    nspace.Types.Add(newType);

    provider.GenerateCodeFromNamespace(nspace, tw, <span style=color:#66d9ef>new</span> CodeGeneratorOptions());
    tw.Close();
    <span style=color:#66d9ef>return</span> sb.ToString();
}
</code></pre></td></tr></table></div></div><p>Really simple, isn’t it? the result with the Customer sample class is the following.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-CSharp data-lang=CSharp><span style=color:#66d9ef>namespace</span> MyProxy {
    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>partial</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyClass</span> : VariousTests.Customer, System.ComponentModel.INotifyPropertyChanged {
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>string</span> Property {
            <span style=color:#66d9ef>get</span> {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.Property;
            }
            <span style=color:#66d9ef>set</span> {
                <span style=color:#66d9ef>this</span>.OnPropertyChanged(<span style=color:#e6db74>&#34;Property&#34;</span>);
                <span style=color:#66d9ef>base</span>.Property = <span style=color:#66d9ef>value</span>;
            }
        }
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>int</span> AnotherProp {
            <span style=color:#66d9ef>get</span> {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.AnotherProp;
            }
            <span style=color:#66d9ef>set</span> {
                <span style=color:#66d9ef>this</span>.OnPropertyChanged(<span style=color:#e6db74>&#34;AnotherProp&#34;</span>);
                <span style=color:#66d9ef>base</span>.AnotherProp = <span style=color:#66d9ef>value</span>;
            }
        }
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>double</span> Added {
            <span style=color:#66d9ef>get</span> {
                <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>base</span>.Added;
            }
            <span style=color:#66d9ef>set</span> {
                <span style=color:#66d9ef>this</span>.OnPropertyChanged(<span style=color:#e6db74>&#34;Added&#34;</span>);
                <span style=color:#66d9ef>base</span>.Added = <span style=color:#66d9ef>value</span>;
            }
        }
        <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>event</span> System.ComponentModel.PropertyChangedEventHandler PropertyChanged;
        <span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>virtual</span> <span style=color:#66d9ef>void</span> OnPropertyChanged(<span style=color:#66d9ef>string</span> Property) {
            System.ComponentModel.PropertyChangedEventHandler temp = <span style=color:#66d9ef>this</span>.PropertyChanged;
            <span style=color:#66d9ef>if</span> ((temp != <span style=color:#66d9ef>null</span>)) {
                temp(<span style=color:#66d9ef>this</span>, <span style=color:#66d9ef>new</span> System.ComponentModel.PropertyChangedEventArgs(Property));
            }
        }
    }
}
</code></pre></td></tr></table></div></div><p>The game is done :D, you have generated dynamic code to subclass a base class and make it implements the INotifyPropertyChanged.</p><p><a href=http://www.codewrecks.com/blog/storage/codedyn.zip>Sample code download.</a></p><p>alk.</p><p>Tags: <a href=http://technorati.com/tag/CodeDom>CodeDom</a> <a href=http://technorati.com/tag/INotifyPropertyChanged>INotifyPropertyChanged</a></p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/net-framework/>NET framework</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/net-framework/>NET framework</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2008/08/lambda-recursion-pay-attention-to-performances/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Lambda recursion pay attention to performances</a></div><div class="next-entry sep-before"><a href=/post/old/2008/08/overriding-the-equalsmethod/><span class=screen-reader-text>Next post: </span>Overriding the Equals Method for object used as a key in hashtable<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>