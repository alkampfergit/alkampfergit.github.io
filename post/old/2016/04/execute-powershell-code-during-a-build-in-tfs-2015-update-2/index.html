<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="In TFS 2015 build system, running a PowerShell script stored in source code is simple because there is a dedicated action to accomplish this task, but if you want to run a PowerShell script that is not in source control, you have no option out of the Box.
Thanks to Update 2, you have now the ability to use the extensions you can find on Visual Studio Marketplace directly in your on-premise TFS installation."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Execute powershell code during a build in TFS 2015 Update 2 • Codewrecks"><meta property="og:description" content="In TFS 2015 build system, running a PowerShell script stored in source code is simple because there is a dedicated action to accomplish this task, but if you want to run a PowerShell script that is not in source control, you have no option out of the Box.
Thanks to Update 2, you have now the ability to use the extensions you can find on Visual Studio Marketplace directly in your on-premise TFS installation."><meta property="og:url" content="https://www.codewrecks.com/post/old/2016/04/execute-powershell-code-during-a-build-in-tfs-2015-update-2/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Tfs"><meta property="article:published_time" content="2016-04-16T08:00:37+02:00"><meta property="article:modified_time" content="2016-04-16T08:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Execute powershell code during a build in TFS 2015 Update 2 • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2016/04/execute-powershell-code-during-a-build-in-tfs-2015-update-2/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Execute powershell code during a build in TFS 2015 Update 2</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Execute powershell code during a build in TFS 2015 Update 2</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2016-04-16T08:00:37+02:00>2016, Apr 16</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>3 mins read</span></div></div></header><div class="container entry-content"><p>In TFS 2015 build system, running a PowerShell script stored in source code is simple because there is a dedicated action to accomplish this task, but <strong>if you want to run a PowerShell script that is not in source control, you have no option out of the Box</strong>.</p><p><strong>Thanks to Update 2, you have now the ability to use the extensions you can find on Visual Studio Marketplace directly in your on-premise TFS installation</strong>. In the Upper Right corner of Web Ui you can find an icon that link to</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image-7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image_thumb-7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image_thumb-7.png alt="This image shows the link in TFS UI to open the control panel to manage extension."></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Link to manage extensions</em></p><p>This opens an administration page that allows you to manage extensions of your TFS installation. The first time you open this page, you will see no extension installed, so it is time to browse <a href=https://marketplace.visualstudio.com/VSTS>Visual Studio MarketPlace</a> to find an extension. Actually I want to run inline PowerShell and I can immediately find that there is <a href="https://marketplace.visualstudio.com/items?itemName=petergroenewegen.PeterGroenewegen-Xpirit-Vsts-Build-InlinePowershell">an extension that can solve my need</a>.</p><p>As you can see from <strong>Figure 2</strong> , this extension have a couple of button, the first one, Install, is used to install this extension on one of your VSTS account, but <strong>if the extension is compatible with on-premise TFS you have also the option to Download the extension</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image-8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image_thumb-8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image_thumb-8.png alt="This image shows that extensions can be downloaded to local pc to be installed to TFS"></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Once you find an extension compatible with on-premise TFS you can download it.</em></p><p>The extension is a simple.vsix file, and from extension administration page you can upload to your TFS.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image10_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image10_thumb.png alt="This image shows how you can upload downloaded extension to your TFS instance."></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Once downloaded you can upload the extension to your TFS.</em></p><p>The process of uploading is really simple:</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image13_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image13_thumb.png alt="This image shows how you can choose the file to upload"></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Browse for downloaded extension</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image16.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image16_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image16_thumb.png alt="Tfs shows info for file to upload"></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Upload UI shows all the detail of the file</em></p><p>Now you can press Upload button, and the extension is uploaded to TFS and ready to be activated.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image19.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image19_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image19_thumb.png alt="TFS shows the list of uploaded and installed extensions"></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Uploaded extension is now listed in the list of available extension</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image22.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image22_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image22_thumb.png alt="For each extension TFS ask you to install in specific project collection"></a></a></p><ol><li><em><strong>Figure 7</strong></em>: <em>Install the extension on one or more collection</em></li></ol><blockquote><p><a target=_blank href=https://ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif><img src=https://ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif alt></a>The concept behind “install then activate” is that, once uploaded the extension is available for the TFS Server instance, but then you should install in each Project Collection where you want to use that extension.</p></blockquote><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image25.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image25_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image25_thumb.png alt="TFS asks you to choose the collection where you want to use the extension."></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Choose the collection you want to install the extension into</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image28.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image28_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image28_thumb.png alt="Once you choose the Project Collection you need to confirm the operation"></a></a></p><p><em><strong>Figure 9</strong></em>: <em>Confirm the selection</em></p><p>Once the Extension is installed in one Project Collection it can be used. In this example the extension contains a new build Task that allows you to execute an arbitrary PowerShell script during the build. To verify that everything is ok you can create a build and verify that the new Task is available and ready to use.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image31.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image31_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/04/image31_thumb.png alt="the extension is used in a build, where I was able to add the new task that executes arbitrary powershell code"></a></a></p><p><em><strong>Figure 10</strong></em>: <em>The extension is ready and can be used</em></p><blockquote><p>Thanks to TFS 2015 Update 2 you can Download and install extension for VSTS Marketplace to your on-premise TFS installation with few clicks.</p></blockquote><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/tfs/>Tfs</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2016/04/change-how-mongodb-c-driver-serialize-guid-in-new-driver-version/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Change how MongoDb C Driver serialize Guid in new driver version</a></div><div class="next-entry sep-before"><a href=/post/old/2016/04/error-in-wsus-after-windows-update-kb3148812/><span class=screen-reader-text>Next post: </span>Error in WSUS after Windows Update KB3148812<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>