<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I’ve got an interesting question about the possibility to import via REST API a Git Repository between Team Projects of VSTS. Actually the problem is: **you want to import a private git repository from a Source repository(in this situation is another VSTS git repository but it could be hosted everywhere) to a VSTS Target repository using only REST API. **The operation is quite simple thanks to the new api described here (https://www."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Import a Git Project with REST API between VSTS Team Projects • Codewrecks"><meta property="og:description" content="I’ve got an interesting question about the possibility to import via REST API a Git Repository between Team Projects of VSTS. Actually the problem is: **you want to import a private git repository from a Source repository(in this situation is another VSTS git repository but it could be hosted everywhere) to a VSTS Target repository using only REST API. **The operation is quite simple thanks to the new api described here (https://www."><meta property="og:url" content="https://www.codewrecks.com/post/old/2016/10/import-a-git-project-with-rest-api-between-vsts-team-projects/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Git"><meta property="article:tag" content="Rest APIs"><meta property="article:tag" content="VSTS"><meta property="article:published_time" content="2016-10-08T09:00:37+02:00"><meta property="article:modified_time" content="2016-10-08T09:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Import a Git Project with REST API between VSTS Team Projects • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2016/10/import-a-git-project-with-rest-api-between-vsts-team-projects/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Import a Git Project with REST API between VSTS Team Projects</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Import a Git Project with REST API between VSTS Team Projects</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2016-10-08T09:00:37+02:00>2016, Oct 08</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>I’ve got an interesting question about the possibility to import via REST API a Git Repository between Team Projects of VSTS. Actually the problem is: **you want to import a private git repository from a <em>Source repository</em>(in this situation is another VSTS git repository but it could be hosted everywhere) to a VSTS <em>Target  repository</em> using only REST API. **The operation is quite simple thanks to the new api described here (<a href=https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository title=https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository>https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository</a>) and in this post I’ll give you all the details.</p><h2 id=step-1--create-a-pat-to-access-vsts-through-rest-api-you-have-many-option-to-authenticate-the-call-but-the-easiest-one-is-using-pat-personal-access-token-if-you-do-no-already-have-a-valid-pat-you-can-create-one-using-security-page-of-your-account>Step 1 – create a PAT** To access VSTS through REST API you have many option to authenticate the call, but the easiest one is using PAT (Personal Access Token). **If you do no already have a valid PAT you can create one using security page of your account.</h2><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb.png alt=image></a></a>** Figure 1: ***Open security page of your account*</p><p>Creating a PAT is really simple, you should only select Personal Access Token (1), then give a description, an expiration time, and the account where PAT is valid into. Since I have more than one VSTS Account I have a combo where all of my account are listed (2).</p><p>Finally <strong>you should select only the permission you want to give to the token.</strong> The default option is All Scopes, and this will imply that the token can do pretty much anything you can do. If you need this token to manage import of repositories you can simply select only code related permission.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-1.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-1.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-1.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Create a PAT to access your account.</em></p><blockquote><p>Personal Access Token are the most secure way to authenticate an application in VSTS because they can be revoked, you can choose the permission you want to give to the token and they have an automatic expiration.</p></blockquote><p>If your <em>Source Account</em>is on a different account from the <em>Target Account</em> you need to create PAT both in <em>Source Account VSTS Instance and in Target Account VSTS Instance.</em> In this example VSTS instance is the very same, so I need only one PAT.</p><h2 id=step-2--create-endpoint-to-access-source-repository>Step 2 – Create endpoint to access Source Repository</h2><p>**My target repository is called ImportTest, and it is important that this repository is created empty. This is my *Target Repository,*the repository where I want to import the <em>Source Repository.</em> **<a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-2.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-2.png> <img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-2.png alt=image></a></a>** Figure 3: ***Create Target Repository with standard Web Interface*</p><p>The import routine should be able to access <em>Source Repository</em>and this imply that it needs to be authenticated. To maximize security **you need to create an Endpoint that point to the *Source Repository in the Team Project of Target Repository.***This can be easily done from the administration page of the Team Project that contains the *Target Repository.*The team project that contains my ImportTest repository is contained in GitMiscellaneous Team Project, and I can proceed to manually create the endpoint.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-3.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-3.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-3.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Create an endpoint of type External Git</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-4.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-4.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-4.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Specify endpoint details</em></p><p>In Figure 5 you can see all the options needed, you should specify a connection name, then the URL parameter is the url of the Source Repository, the same url you use to clone the repository. Finally you need to use the PAT as username, then you can press OK.</p><p>This service endpoint <strong>should be created in the Team Project that contains the Target Repository</strong> , because it will be used by the import routine to authenticate to the Source Repository to take data to import.</p><blockquote><p>An endpoint is basically an URL and an authentication that is used by the server to access an external service</p></blockquote><p><strong>If you need to automate the whole process, the endpoint can be created easily with REST API</strong> (<a href=https://www.visualstudio.com/en-us/docs/integrate/api/endpoints/endpoints title=https://www.visualstudio.com/en-us/docs/integrate/api/endpoints/endpoints>https://www.visualstudio.com/en-us/docs/integrate/api/endpoints/endpoints</a>) here is a simple call in Postman.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-5.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-5.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-5.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Creation of the endpoint with REST API</em></p><p>This does not need any explanation because it is a simple call with the very same option that you specify on the UI.</p><h2 id=heading></h2><h2 id=step-3--create-the-call-to-import-repository>Step 3 – Create the call to import repository</h2><p>To create the call to start repository import routine you need some parameters: first of all <strong>you need the id of the Endpoint you created in step 2</strong>. If you created the endpoint through REST API this is not a problem, because the Id is present in the response</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-6.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-6.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-6.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Response of the request shown in Figure 6 contains endpoint Id</em></p><p>If you created the endpoint through Web UI the id can be grabbed by the url in the administration page of the endpoints, but <strong>a simpler and better method is to list all endpoint of the Team Project through REST API</strong>. In my situation is a simple GET call to this url <a href="https://gianmariaricci.VisualStudio.com/GitMiscellaneous/_apis/distributedtask/serviceendpoints?api-version=3.0-preview.1" title="https://gianmariaricci.VisualStudio.com/GitMiscellaneous/_apis/distributedtask/serviceendpoints?api-version=3.0-preview.1">https://gianmariaricci.VisualStudio.com/GitMiscellaneous/_apis/distributedtask/serviceendpoints?api-version=3.0-preview.1</a></p><p>The answer is the very same of Figure 7, and this gives me the id of the endpoint that points to the <em>Source Repository: df12f2e3-7c40-4885-8dbd-310f1781369a</em></p><p>Now I need to create the import request, as described here (<a href=https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository title=https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository>https://www.visualstudio.com/en-us/docs/integrate/api/git/import-requests#create-a-request-to-import-a-repository</a>). And the only information I’m missing is the Id of the Target Repository</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-7.png alt=image></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Repository part of the url in the call should be replaced by repository ID</em></p><p>As shown in Figure8 the only annoying part of the request is the Id of the <em>Target Repository</em>because <strong>it is the GUID of the repository not the name</strong>. Obtaining this value is not difficult, because with REST API this is a simple GET call to this url: <a href="https://gianmariaricci.VisualStudio.com/DefaultCollection/GitMiscellaneous/_apis/git/repositories?api-version=1.0" title="https://gianmariaricci.VisualStudio.com/DefaultCollection/GitMiscellaneous/_apis/git/repositories?api-version=1.0">https://gianmariaricci.VisualStudio.com/DefaultCollection/GitMiscellaneous/_apis/git/repositories?api-version=1.0</a>. From the answer of this call the ID of the ImportTest repository is: 3037268a-0c91-4fe1-8435-a76e9b731f5e</p><p>Now I have everything to create the import request, just forge the request in Postman or similar tool and fire the request.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-8.png alt=image></a></a></p><p><em><strong>Figure 9</strong></em>: <em>The import request where 1 is the ID of Target Repository and 2 is the ID of the endpoint.</em></p><p>If you are quick enough and refresh the page of <em>Target Repository</em>while the import routine is running, you should be able to see this image</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-9.png alt=image></a></a></p><p><em><strong>Figure 10</strong></em>: <em>Importing is running</em></p><p>After a little bit (depending on the source of <em>Source Repository</em>) the <em>Target Repository</em>will be a perfect clone of the <em>Source Repository.</em></p><p>If there are errors during the import process in the source code page of <em>Target Repository</em>you are warned with the error*,* as shown in **Figure 11**.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image-10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-10.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/10/image_thumb-10.png alt=image></a></a></p><p><em><strong>Figure 11</strong></em>: <em>Error in the importing routing were shown to source  code page of Target Repository</em></p><p>As an example the error in the above image is due to a misconfiguration of the Endpoint (done in part 2), as an example if you created the endpoint with wrong credentials.</p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/git/>Git</a>, <a class=tag href=/tags/rest-apis/>Rest APIs</a>, <a class=tag href=/tags/vsts/>VSTS</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2016/09/use-different-excel-tfs-vsts-addin-at-the-same-time/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Use different Excel TFS VSTS Addin at the same time</a></div><div class="next-entry sep-before"><a href=/post/old/2016/10/using-pat-to-authenticate-your-tools/><span class=screen-reader-text>Next post: </span>Using PAT to authenticate your tools<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>