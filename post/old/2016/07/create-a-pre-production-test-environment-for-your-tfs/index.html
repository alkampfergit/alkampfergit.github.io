<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="There are a lot of legitmate reasons to create a clone of your TFS installation: verifying an upgrade, testing some customization and so on, but traditionally creating a test environment is not an easy task.
The problem is avoiding that the test installation could interfere and corrupt your production instance and since TFS is a complex product, there are a series of steps you need to do to perform this kind of operations."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Create a Pre-Production  Test environment for your TFS • Codewrecks"><meta property="og:description" content="There are a lot of legitmate reasons to create a clone of your TFS installation: verifying an upgrade, testing some customization and so on, but traditionally creating a test environment is not an easy task.
The problem is avoiding that the test installation could interfere and corrupt your production instance and since TFS is a complex product, there are a series of steps you need to do to perform this kind of operations."><meta property="og:url" content="https://www.codewrecks.com/post/old/2016/07/create-a-pre-production-test-environment-for-your-tfs/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Upgrade"><meta property="article:published_time" content="2016-07-16T08:00:37+02:00"><meta property="article:modified_time" content="2016-07-16T08:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Create a Pre-Production Test environment for your TFS • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2016/07/create-a-pre-production-test-environment-for-your-tfs/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="page type-post has-sidebar"><div class=site><div id=sidebar class=sidebar><a class=screen-reader-text href=#main-menu>Skip to Main Menu</a><div class=container><section class="widget widget-about sep-after"><header><div class=logo><a href=/><img src=/images/logo.png></a></div><h2 class="title site-title"><a href=/>Codewrecks</a></h2><div class=desc>Wrecks of code floating in the sea of internet</div></header></section><section class="widget widget-sidebar_menu sep-after"><nav id=sidebar-menu class="menu sidebar-menu" aria-label="Sidebar Menu"><div class=container><ul><li class=item><a href=/>Home</a></li></ul></div></nav></section><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6590055118491660" crossorigin=anonymous></script><section class="widget widget-taxonomy_cloud sep-after"><header><h4 class="title widget-title">Tags</h4></header><div class="container list-container"><ul class="list taxonomy-cloud"><li><a href=/tags/actions/ style=font-size:1.0078740157480315em>Actions</a></li><li><a href=/tags/addin/ style=font-size:1.0078740157480315em>Addin</a></li><li><a href=/tags/agile/ style=font-size:1.0236220472440944em>Agile</a></li><li><a href=/tags/ai/ style=font-size:1em>AI</a></li><li><a href=/tags/alm/ style=font-size:1.0629921259842519em>ALM</a></li><li><a href=/tags/aop/ style=font-size:1.0236220472440944em>Aop</a></li><li><a href=/tags/api/ style=font-size:1.110236220472441em>Api</a></li><li><a href=/tags/applicationinsights/ style=font-size:1.0236220472440944em>ApplicationInsights</a></li><li><a href=/tags/architecture/ style=font-size:1.1023622047244095em>Architecture</a></li><li><a href=/tags/architecture-castle/ style=font-size:1.0078740157480315em>Architecture Castle</a></li><li><a href=/tags/aspnet/ style=font-size:1.3700787401574803em>ASPNET</a></li><li><a href=/tags/aspnet-mvc/ style=font-size:1.031496062992126em>AspNet MVC</a></li><li><a href=/tags/azdo/ style=font-size:1.1653543307086613em>AzDo</a></li><li><a href=/tags/azure/ style=font-size:1.0866141732283465em>Azure</a></li><li><a href=/tags/azure-devops/ style=font-size:1.110236220472441em>Azure Devops</a></li><li><a href=/tags/azure-pipelines/ style=font-size:1.031496062992126em>Azure Pipelines</a></li><li><a href=/tags/azuredevops/ style=font-size:1.094488188976378em>AzureDevOps</a></li><li><a href=/tags/backup/ style=font-size:1.0078740157480315em>Backup</a></li><li><a href=/tags/blend/ style=font-size:1.0078740157480315em>Blend</a></li><li><a href=/tags/blog/ style=font-size:1.0078740157480315em>Blog</a></li><li><a href=/tags/blogging/ style=font-size:1.0551181102362204em>blogging</a></li><li><a href=/tags/books/ style=font-size:1.015748031496063em>Books</a></li><li><a href=/tags/branch/ style=font-size:1em>Branch</a></li><li><a href=/tags/build/ style=font-size:1.5984251968503937em>build</a></li><li><a href=/tags/c/ style=font-size:1.0078740157480315em>C</a></li><li><a href=/tags/castle/ style=font-size:1.236220472440945em>castle</a></li><li><a href=/tags/chatgpt/ style=font-size:1.0078740157480315em>ChatGPT</a></li><li><a href=/tags/clickonce/ style=font-size:1.0236220472440944em>ClickOnce</a></li><li><a href=/tags/codeanalysis/ style=font-size:1.0078740157480315em>CodeAnalysis</a></li><li><a href=/tags/codespaces/ style=font-size:1.0236220472440944em>Codespaces</a></li><li><a href=/tags/continuos-integration/ style=font-size:1.031496062992126em>Continuos Integration</a></li><li><a href=/tags/continuous-deployment/ style=font-size:1.0393700787401574em>Continuous Deployment</a></li><li><a href=/tags/continuous-integration/ style=font-size:1.0866141732283465em>Continuous Integration</a></li><li><a href=/tags/continuousdeployment/ style=font-size:1.0551181102362204em>ContinuousDeployment</a></li><li><a href=/tags/copilot/ style=font-size:1.015748031496063em>Copilot</a></li><li><a href=/tags/cqrs/ style=font-size:1.0078740157480315em>CQRS</a></li><li><a href=/tags/datadude/ style=font-size:1.0393700787401574em>DataDude</a></li><li><a href=/tags/datagrid/ style=font-size:1.0078740157480315em>DataGrid</a></li><li><a href=/tags/ddd/ style=font-size:1.1181102362204725em>DDD</a></li><li><a href=/tags/debugging/ style=font-size:1.0078740157480315em>Debugging</a></li><li><a href=/tags/developing/ style=font-size:1em>developing</a></li><li><a href=/tags/devops/ style=font-size:1.1181102362204725em>DevOps</a></li><li><a href=/tags/docker/ style=font-size:1.0078740157480315em>Docker</a></li><li><a href=/tags/dotnet/ style=font-size:1em>dotnet</a></li><li><a href=/tags/ef/ style=font-size:1.0078740157480315em>EF</a></li><li><a href=/tags/ef-code-first/ style=font-size:1.031496062992126em>EF Code First</a></li><li><a href=/tags/ef41/ style=font-size:1.0236220472440944em>EF41</a></li><li><a href=/tags/ef5/ style=font-size:1.015748031496063em>EF5</a></li><li><a href=/tags/enterprise-library/ style=font-size:1.0236220472440944em>Enterprise Library</a></li><li><a href=/tags/entity-framework/ style=font-size:1.094488188976378em>Entity Framework</a></li><li><a href=/tags/everydaylife/ style=font-size:1.047244094488189em>EverydayLife</a></li><li><a href=/tags/excel/ style=font-size:1.0078740157480315em>Excel</a></li><li><a href=/tags/experiences/ style=font-size:1.2440944881889764em>Experiences</a></li><li><a href=/tags/frameworks/ style=font-size:1.0629921259842519em>Frameworks</a></li><li><a href=/tags/general/ style=font-size:2em>General</a></li><li><a href=/tags/git/ style=font-size:1.2283464566929134em>Git</a></li><li><a href=/tags/git-tf/ style=font-size:1.0078740157480315em>git-tf</a></li><li><a href=/tags/github/ style=font-size:1.1968503937007875em>GitHub</a></li><li><a href=/tags/github-actions/ style=font-size:1.015748031496063em>GitHub Actions</a></li><li><a href=/tags/gpt4/ style=font-size:1em>GPT4</a></li><li><a href=/tags/hacking/ style=font-size:1em>Hacking</a></li><li><a href=/tags/hardware/ style=font-size:1.031496062992126em>Hardware</a></li><li><a href=/tags/homelab/ style=font-size:1em>HomeLab</a></li><li><a href=/tags/hql/ style=font-size:1.0078740157480315em>HQL</a></li><li><a href=/tags/html/ style=font-size:1.0078740157480315em>Html</a></li><li><a href=/tags/hugo/ style=font-size:1em>hugo</a></li><li><a href=/tags/icriteria/ style=font-size:1.0078740157480315em>ICriteria</a></li><li><a href=/tags/iis/ style=font-size:1.015748031496063em>IIS</a></li><li><a href=/tags/ioc/ style=font-size:1.015748031496063em>IoC</a></li><li><a href=/tags/javascript/ style=font-size:1.0078740157480315em>Javascript</a></li><li><a href=/tags/jquery/ style=font-size:1.047244094488189em>JQuery</a></li><li><a href=/tags/lab-management/ style=font-size:1.1023622047244095em>Lab Management</a></li><li><a href=/tags/languages/ style=font-size:1.0551181102362204em>Languages</a></li><li><a href=/tags/linq/ style=font-size:1.204724409448819em>LINQ</a></li><li><a href=/tags/linux/ style=font-size:1.0551181102362204em>Linux</a></li><li><a href=/tags/log4net/ style=font-size:1.047244094488189em>log4net</a></li><li><a href=/tags/lucene/ style=font-size:1.0629921259842519em>lucene</a></li><li><a href=/tags/macro/ style=font-size:1.0236220472440944em>Macro</a></li><li><a href=/tags/masstransit/ style=font-size:1.015748031496063em>masstransit</a></li><li><a href=/tags/mef/ style=font-size:1.0236220472440944em>MEF</a></li><li><a href=/tags/metroui/ style=font-size:1.0078740157480315em>MetroUi</a></li><li><a href=/tags/microsoft-test-manager/ style=font-size:1.015748031496063em>Microsoft Test Manager</a></li><li><a href=/tags/mms/ style=font-size:1.015748031496063em>mms</a></li><li><a href=/tags/mongo/ style=font-size:1.0236220472440944em>Mongo</a></li><li><a href=/tags/mongodb/ style=font-size:1.1574803149606299em>MongoDB</a></li><li><a href=/tags/msbuild/ style=font-size:1.031496062992126em>Msbuild</a></li><li><a href=/tags/mstest/ style=font-size:1.0078740157480315em>MsTest</a></li><li><a href=/tags/mvvm/ style=font-size:1.0708661417322836em>MVVM</a></li><li><a href=/tags/nablasoft/ style=font-size:1.0236220472440944em>Nablasoft</a></li><li><a href=/tags/ndepend/ style=font-size:1.0236220472440944em>NDepend</a></li><li><a href=/tags/net/ style=font-size:1.0236220472440944em>Net</a></li><li><a href=/tags/net-core/ style=font-size:1.0078740157480315em>NET Core</a></li><li><a href=/tags/net-framework/ style=font-size:1.5118110236220472em>NET framework</a></li><li><a href=/tags/netcore/ style=font-size:1.0236220472440944em>NETCORE</a></li><li><a href=/tags/nhibernate/ style=font-size:1.5039370078740157em>Nhibernate</a></li><li><a href=/tags/nosql/ style=font-size:1.0629921259842519em>NoSql</a></li><li><a href=/tags/nsm/ style=font-size:1em>nsm</a></li><li><a href=/tags/nuget/ style=font-size:1.0393700787401574em>nuget</a></li><li><a href=/tags/nunit/ style=font-size:1.0393700787401574em>Nunit</a></li><li><a href=/tags/office/ style=font-size:1.0236220472440944em>Office</a></li><li><a href=/tags/oidc/ style=font-size:1em>OIDC</a></li><li><a href=/tags/oop/ style=font-size:1.0236220472440944em>OOP</a></li><li><a href=/tags/openxml/ style=font-size:1.0078740157480315em>OpenXml</a></li><li><a href=/tags/orm/ style=font-size:1.0236220472440944em>ORM</a></li><li><a href=/tags/performance/ style=font-size:1.0393700787401574em>Performance</a></li><li><a href=/tags/pgp/ style=font-size:1em>PGP</a></li><li><a href=/tags/pills/ style=font-size:1.141732283464567em>Pills</a></li><li><a href=/tags/pipeline/ style=font-size:1.0629921259842519em>Pipeline</a></li><li><a href=/tags/pipelines/ style=font-size:1em>pipelines</a></li><li><a href=/tags/plugin/ style=font-size:1.031496062992126em>Plugin</a></li><li><a href=/tags/power-tools/ style=font-size:1.0236220472440944em>Power Tools</a></li><li><a href=/tags/powershell/ style=font-size:1.1023622047244095em>PowerShell</a></li><li><a href=/tags/process-template/ style=font-size:1.047244094488189em>Process Template</a></li><li><a href=/tags/programming/ style=font-size:1.141732283464567em>Programming</a></li><li><a href=/tags/pull-requests/ style=font-size:1.0078740157480315em>Pull Requests</a></li><li><a href=/tags/pullrequests/ style=font-size:1em>PullRequests</a></li><li><a href=/tags/python/ style=font-size:1.015748031496063em>Python</a></li><li><a href=/tags/ravendb/ style=font-size:1.031496062992126em>RavenDB</a></li><li><a href=/tags/release/ style=font-size:1.031496062992126em>release</a></li><li><a href=/tags/resharper/ style=font-size:1.0236220472440944em>Resharper</a></li><li><a href=/tags/rest-apis/ style=font-size:1.0236220472440944em>Rest APIs</a></li><li><a href=/tags/rhinomock/ style=font-size:1.0078740157480315em>RhinoMock</a></li><li><a href=/tags/scrum/ style=font-size:1.0078740157480315em>Scrum</a></li><li><a href=/tags/searching/ style=font-size:1.0393700787401574em>searching</a></li><li><a href=/tags/security/ style=font-size:1.3622047244094488em>security</a></li><li><a href=/tags/shim/ style=font-size:1.0078740157480315em>shim</a></li><li><a href=/tags/silverlight/ style=font-size:1.015748031496063em>Silverlight</a></li><li><a href=/tags/software-architecture/ style=font-size:1.125984251968504em>Software Architecture</a></li><li><a href=/tags/solr/ style=font-size:1.0551181102362204em>Solr</a></li><li><a href=/tags/sonarcloud/ style=font-size:1.0078740157480315em>sonarcloud</a></li><li><a href=/tags/sonarqube/ style=font-size:1.0551181102362204em>sonarqube</a></li><li><a href=/tags/source-control/ style=font-size:1em>Source control</a></li><li><a href=/tags/springnet/ style=font-size:1em>SpringNET</a></li><li><a href=/tags/sql-server/ style=font-size:1.236220472440945em>Sql Server</a></li><li><a href=/tags/ssd/ style=font-size:1.047244094488189em>SSD</a></li><li><a href=/tags/symbols/ style=font-size:1em>Symbols</a></li><li><a href=/tags/team-foundation-server/ style=font-size:1.4330708661417324em>Team Foundation Server</a></li><li><a href=/tags/teamfoundationserver/ style=font-size:1.0236220472440944em>TeamFoundationServer</a></li><li><a href=/tags/terraform/ style=font-size:1em>terraform</a></li><li><a href=/tags/test/ style=font-size:1.0078740157480315em>Test</a></li><li><a href=/tags/testing/ style=font-size:1.5511811023622046em>Testing</a></li><li><a href=/tags/tfs/ style=font-size:1.889763779527559em>Tfs</a></li><li><a href=/tags/tfs-build/ style=font-size:1.236220472440945em>TFS Build</a></li><li><a href=/tags/tfs-power-tools/ style=font-size:1.0078740157480315em>Tfs Power Tools</a></li><li><a href=/tags/tfs-service/ style=font-size:1.0078740157480315em>Tfs service</a></li><li><a href=/tags/tfs11/ style=font-size:1em>TFS11</a></li><li><a href=/tags/tfsapi/ style=font-size:1.031496062992126em>TfsAPI</a></li><li><a href=/tags/tfsbuild/ style=font-size:1.0629921259842519em>TfsBuild</a></li><li><a href=/tags/tfvc/ style=font-size:1.0078740157480315em>TFVC</a></li><li><a href=/tags/tika/ style=font-size:1.0236220472440944em>tika</a></li><li><a href=/tags/tls/ style=font-size:1.0078740157480315em>TLS</a></li><li><a href=/tags/tools/ style=font-size:1.0078740157480315em>Tools</a></li><li><a href=/tags/tools-and-library/ style=font-size:1.1338582677165354em>Tools and library</a></li><li><a href=/tags/tryhackme/ style=font-size:1em>TryHackMe</a></li><li><a href=/tags/uat/ style=font-size:1.015748031496063em>UAT</a></li><li><a href=/tags/ubuntu/ style=font-size:1em>Ubuntu</a></li><li><a href=/tags/unit-testing/ style=font-size:1.047244094488189em>Unit Testing</a></li><li><a href=/tags/unittesting/ style=font-size:1em>UnitTesting</a></li><li><a href=/tags/upgrade/ style=font-size:1em>Upgrade</a></li><li><a href=/tags/vcs/ style=font-size:1.015748031496063em>VCS</a></li><li><a href=/tags/virtual-machine/ style=font-size:1.031496062992126em>Virtual Machine</a></li><li><a href=/tags/visual-studio/ style=font-size:1.3307086614173227em>Visual Studio</a></li><li><a href=/tags/visual-studio-2013/ style=font-size:1.0078740157480315em>Visual Studio 2013</a></li><li><a href=/tags/visual-studio-alm/ style=font-size:1.2519685039370079em>Visual Studio ALM</a></li><li><a href=/tags/visual-studio-database-edition/ style=font-size:1.031496062992126em>Visual Studio Database Edition</a></li><li><a href=/tags/visualstudio/ style=font-size:1em>VisualStudio</a></li><li><a href=/tags/vnext/ style=font-size:1.0551181102362204em>vNext</a></li><li><a href=/tags/vs11/ style=font-size:1.0236220472440944em>VS11</a></li><li><a href=/tags/vs2010/ style=font-size:1.0078740157480315em>VS2010</a></li><li><a href=/tags/vs2012/ style=font-size:1.031496062992126em>VS2012</a></li><li><a href=/tags/vsalm/ style=font-size:1.0236220472440944em>VSAlm</a></li><li><a href=/tags/vso/ style=font-size:1.0708661417322836em>VSO</a></li><li><a href=/tags/vsts/ style=font-size:1.2913385826771653em>VSTS</a></li><li><a href=/tags/vstsdbedition/ style=font-size:1.0078740157480315em>VSTSDBEdition</a></li><li><a href=/tags/wcf/ style=font-size:1.125984251968504em>Wcf</a></li><li><a href=/tags/wcf-iis7/ style=font-size:1.0078740157480315em>WCF IIS7</a></li><li><a href=/tags/web-test/ style=font-size:1.015748031496063em>Web Test</a></li><li><a href=/tags/webbrowser/ style=font-size:1.015748031496063em>WebBrowser</a></li><li><a href=/tags/windows/ style=font-size:1.031496062992126em>Windows</a></li><li><a href=/tags/winforms/ style=font-size:1.0236220472440944em>Winforms</a></li><li><a href=/tags/workflow/ style=font-size:1.0236220472440944em>workflow</a></li><li><a href=/tags/wpf/ style=font-size:1.3937007874015748em>WPF</a></li><li><a href=/tags/wsl/ style=font-size:1em>WSL</a></li><li><a href=/tags/wsl2/ style=font-size:1em>wsl2</a></li><li><a href=/tags/xaml/ style=font-size:1.015748031496063em>XAML</a></li><li><a href=/tags/yaml/ style=font-size:1em>YAML</a></li><li><a href=/tags/zero-trust-security/ style=font-size:1.0078740157480315em>Zero Trust Security</a></li></ul></div></section></div><div class=sidebar-overlay></div></div><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><a class=screen-reader-text href=#content>Skip to Content</a>
<button id=sidebar-toggler class=sidebar-toggler aria-controls=sidebar>
<span class=screen-reader-text>Toggle Sidebar</span>
<span class=open><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></span><span class=close><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></span></button><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/git-videos/>Git Videos</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Create a Pre-Production Test environment for your TFS</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Create a Pre-Production Test environment for your TFS</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2016-07-16T08:00:37+02:00>2016, Jul 16</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>7 mins read</span></div></div></header><div class="container entry-content"><p>There are a lot of legitmate reasons to create a clone of your TFS installation: verifying an upgrade, testing some customization and so on, but traditionally <strong>creating a test environment is not an easy task</strong>.</p><p>The problem is avoiding that the test installation could interfere and corrupt your production instance and since TFS is a complex product, there are a series of steps you need to do to perform this kind of operations. <strong>Thankfully with the upcoming version of TFS most of the work will be accomplished with a wizard</strong>.</p><blockquote><p>Kudo to TFS Team for including a wizard experience to create a clone of your TFS Environment.</p></blockquote><p>Here are the detailed steps to create a clone environment.</p><h2 id=heading></h2><h2 id=step-1-backup-database--install-tfs-on-new-server--restore-database>Step 1: Backup Database / install TFS on new Server / Restore Database</h2><p>First of all you can login to your TFS server, open c:\Program Files\Microsoft Team Foundation Server 14.0\Tools and launch TfsBackup.exe to take a backup of all databases.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-16-26.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-16-26_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-16-26_thumb.jpg alt=2016-07-09_11-16-26></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Take a backup of your Production Database</em></p><p>You should only specify the name of the instance of SQL Server where you have your production databases. A wizard will start asking you to select databases to backup and the location where you want to place the backup.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-17-23.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-17-23_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-17-23_thumb.jpg alt=2016-07-09_11-17-23></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Choose databases to backup</em></p><p>The backup routine will perform a full backup.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-22-06.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-22-06_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_11-22-06_thumb.jpg alt=2016-07-09_11-22-06></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Backup is taken automatically from the routine</em></p><p>Next step is creating a new Virtual Machine, install Sql Server in a compatible version with TFS “15” preview (I suggest SQL 2016) then install TFS.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-20-57.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-20-57_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-20-57_thumb.jpg alt=2016-07-09_12-20-57></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Install TFS on the target machine</em></p><p>Once the installer finishes TFS “15” Configuration wizard will appear</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-08.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-08_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-08_thumb.jpg alt=2016-07-09_12-31-08></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Once installer is complete the Configuration Wizard will ask you to configure the server</em></p><p>Now you should go to c:\Program Files\Microsoft Team Foundation Server 15.0\Tools and launch TfsRestore.Exe.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-42.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-42_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-31-42_thumb.jpg alt=2016-07-09_12-31-42></a></a></p><p><em><strong>Figure 6</strong></em>: <em>TfsRestore will perform database restore</em></p><p>You should only choose the name of the SQL Server instance you want to use, in this example I’m creating a Pre-Production environment composed by only one machine called RMTEST. You should transfer backup file to target computer or place them in a network share accessible from the Target machine.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-33-53.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-33-53_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-33-53_thumb.jpg alt=2016-07-09_12-33-53></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Restore routine will prompt you for Backup Location</em></p><p>Once you specify the directory with the backup the wizard will automatically list all the database to restore for you.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-00.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-00_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-00_thumb.jpg alt=2016-07-09_12-36-00></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Database are restored in Sql Server</em></p><h2 id=step-2-extra-security-precautions-to-avoid-production-corruption>Step 2: Extra security precautions to avoid Production corruption</h2><p>Now all databases are restored in the Sql Server that will be used by the Pre-Production environment and you can start TFS configuration wizard, but I’ll wait to perform extra security precautions.</p><p><strong>You should edit the hosts file of Pre-Production machine to redirect to an inexistent IP every machine name used in Production Environment</strong>. As an example, I have Build and Release definition that will deploy software on demo machines, and I want to prevent that a build triggered on Pre-Production TFS Instance will access Production servers.</p><blockquote><p>As extra security tip, I suggest you to use the <a href=http://www.codewrecks.com/blog/index.php/2015/08/07/create-a-safe-clone-of-your-tfs-environment/>hosts file trick</a> to minimize the risk of Production Environment corruption</p></blockquote><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/image-16.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/image_thumb-16.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/image_thumb-16.png alt=image></a></a></p><p><em><strong>Figure 9</strong></em>: <em>Editing hosts file will guarantee extra safety net against Production environment corruption</em></p><p>As an example, in Figure 9 I showed a typical hosts file, the Production instance is called TFS2013PreviewOneBox so I redirect this name to localhost in the new name. Then <strong>I redirect all machines used as deploy target or build server etc to 10.200.200.200 that is an unexistent IP</strong>.</p><p>You can also create some network rules to isolate the Pre-Production machine from the Production Environment completely, such as placing it in another network segment and prevent routing entirely, but using the hosts file is a simpler approach that works well for small and medium installation.</p><h2 id=step-3-perform-the-configuration-with-new-tfs-15-wizard>Step 3: Perform the configuration with new TFS “15” wizard</h2><p>Before TFS “15” now you should resort to command line trickery to change server id from database etc, but luckily you can do everything using configuration wizard. Lets come back to Configuration Wizard and choose the option “I have existing database to use … “</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-22.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-22_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-22_thumb.jpg alt=2016-07-09_12-36-22></a></a></p><p><em><strong>Figure 10</strong></em>: <em>Start upgrade wizard using existing databases</em></p><p>The wizard will prompt you to choose the instance of Sql Server and the database to use.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-44.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-44_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-36-44_thumb.jpg alt=2016-07-09_12-36-44></a></a></p><p><em><strong>Figure 11</strong></em>: <em>Choose database to use for the upgrade</em></p><p>Until now it is the standard Upgrade Wizard, but the next screen is the great news of this new installer because it will present you the option to create a Pre-Production environment.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-20.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-20_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-20_thumb.jpg alt=2016-07-09_12-42-20></a></a></p><p><em><strong>Figure 12</strong></em>: <em>This is the new option, you can choose to create a Pre-Production Upgrade Testing</em></p><p>Pressing Next you will see another screen that reminds you the step that the wizard will perform to create the Clone environment. As you can see <strong>the wizard will take care of remapping connection string, changing all identifiers and remove all scheduled backup jobs</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-37.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-37_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-42-37_thumb.jpg alt=2016-07-09_12-42-37></a></a></p><p><em><strong>Figure 13</strong></em>: <em>Overview of the Pre-Production scenario</em></p><blockquote><p>Thanks to the wizard you can create a Test Clone of your Production TFS without worrying to corrupt your Production environment. The wizard will takes care of everything</p></blockquote><p>Now the wizard will continue, but there is another good surprise, each screen contains suggestions to minimize risk of Production Environment corruption.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-44-40.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-44-40_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-44-40_thumb.jpg alt=2016-07-09_12-44-40></a></a></p><p><em><strong>Figure 14</strong></em>: <em>Wizard suggests you to use a different user to run TFS Services</em></p><p>The suggestion in Figure 14 is the most important one, I usually use an account called TfsService to run my TFS Server and that account has several privileges in my network. In the Pre-Production environment it is better to use standard Network Service account or a different account. <strong>This is a really important security settings, because if the Pre-Production server will try to perform some operations on other servers it will probably be blocked because the account has no right permission.</strong> > <strong>Never use for Pre-Production environment the same users that you use for Production environment to minimize risk of corruption. Use Network Service or users with no privilege in the network created specifically for Cloned Environments</strong> Clearly the wizard will suggest you to use different url than production server. Resist the temptation to use the same url and rely on hosts file redirection, it is really better to use a new name. This will allows you to communicate this new name to the team and ask them to access Pre-Production server to verify that everything is working, as an example after a test upgrade.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-45-02.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-45-02_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-45-02_thumb.jpg alt=2016-07-09_12-45-02></a></a></p><p><em><strong>Figure 15</strong></em>: <em>Use a different url than production environment</em></p><p>You can now follow the wizard, basically the screen are the same of the upgrade, but each screen will suggest you to use different accounts and different resources than production instance.</p><p>At the end of the wizard you will have a perfect clone of your production environment to play with.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-56-10.jpg><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-56-10_thumb.jpg><img src=https://www.codewrecks.com/blog/wp-content/uploads/2016/07/2016-07-09_12-56-10_thumb.jpg alt=2016-07-09_12-56-10></a></a></p><p><em><strong>Figure 16</strong></em>: <em>Configuration is finished, you have now a Clone of your environment.</em></p><h2 id=step-4-extra-steps-for-furter-extra-security>Step 4: extra steps for furter extra security</h2><p>If you want to be Extra sure that your production environment is safe from corruption, <strong>configure the firewall of your Production system to block any access from IP of any machine part of cloned environment</strong>. This extra security measure will prevent human errors.</p><p>Some customers have custom software that connect to TFS instance to perform some custom logic. As an example <strong>you could have software that use bisubsribe.exe or hooks to listen to TFS events then send command to TFS.</strong> Suppose you want to test this kind of software against your Cloned environment, so you let people install and configure everything on Pre-Production machine, <strong>but someone did a bad mistake and configured the software to listen to the Pre-Production environment, but send command against Production Environment. If you blocked all traffic from Pre-Production machines to your TFS Production environment you will be protected against this kind of mistake.</strong> If you are good in networking, probably the best solution is creating all machines part of Pre-Production environment (TFS, SQL, build server, etc) in another network segment, than configure routing / firewall to allow machines in pre-prod network to access only domain controllers or in general to access only machine that are stricly needed. <strong>This will prevent machines from Pre-Production environment to connect any machine of your Production Environment.</strong> You can then allow selected ip from your regular network to access Pre-Production for testing.</p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/tfs/>Tfs</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/upgrade/>Upgrade</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2016/07/impressions-on-installing-tfs-15-preview/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Impressions on installing TFS '15' Preview</a></div><div class="next-entry sep-before"><a href=/post/old/2016/07/isolate-your-tfs-pre-production-environment-for-maximum-security/><span class=screen-reader-text>Next post: </span>Isolate your TFS Pre-Production environment for maximum security<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2023 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>