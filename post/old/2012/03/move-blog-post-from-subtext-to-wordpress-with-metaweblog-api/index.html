<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="My desire is to move my Italian blog located in http://blogs.ugidotnet.org/rgm to a WordPress blog in our domain http://www.nablasoft.com, because I really feel nostalgic of my old domain, but I face a bad problem, because the export routine of the original blog, based on Subtext , seems not to work. I started thinking to a solution and I decided to try to write a simple program that download post from an original blog engine via Metaweblog API and repost to destination blog."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Move blog post from subtext to WordPress with Metaweblog API • Codewrecks"><meta property="og:description" content="My desire is to move my Italian blog located in http://blogs.ugidotnet.org/rgm to a WordPress blog in our domain http://www.nablasoft.com, because I really feel nostalgic of my old domain, but I face a bad problem, because the export routine of the original blog, based on Subtext , seems not to work. I started thinking to a solution and I decided to try to write a simple program that download post from an original blog engine via Metaweblog API and repost to destination blog."><meta property="og:url" content="https://www.codewrecks.com/post/old/2012/03/move-blog-post-from-subtext-to-wordpress-with-metaweblog-api/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Blog"><meta property="article:tag" content="Tools"><meta property="article:published_time" content="2012-03-24T07:00:37+02:00"><meta property="article:modified_time" content="2012-03-24T07:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Move blog post from subtext to WordPress with Metaweblog API • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2012/03/move-blog-post-from-subtext-to-wordpress-with-metaweblog-api/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Move blog post from subtext to WordPress with Metaweblog API</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Move blog post from subtext to WordPress with Metaweblog API</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2012-03-24T07:00:37+02:00>2012, Mar 24</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p>My desire is to move my Italian blog located in <a href=http://blogs.ugidotnet.org/rgm>http://blogs.ugidotnet.org/rgm</a> to a <a href=http://wordpress.com/><strong>WordPress</strong></a> blog in our domain <a href=http://www.nablasoft.com>http://www.nablasoft.com</a>, because I really feel nostalgic of my old domain, but I face a bad problem, because the export routine of the original blog, based on <strong><a href="http://subtextproject.com/default.aspx?AspxAutoDetectCookieSupport=1">Subtext</a></strong> , seems not to work. I started thinking to a solution and I decided to try to write a simple program that download post from an original blog engine via <a href=http://xmlrpc.scripting.com/metaWeblogApi.html><strong>Metaweblog API</strong></a> and repost to destination blog.</p><p>The starting point is looking for a library that takes care of implementing Metaweblog API communication in your language of choice, I’ve find the <a href=http://joeblogs.codeplex.com/><strong>Joe Blogs</strong></a> ** ** on <em>Codeplex</em> so I decided to give it a look to verify if it suits my need. I’ve started creating a minimal interface in Winform.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2012/03/image29.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2012/03/image_thumb29.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2012/03/image_thumb29.png alt="A screenshot of the tool in action while it is migrating my blog"></a></a></p><p><em><strong>Figure 1</strong></em>: <em>A screenshot of the tool in action while it is migrating my blog</em></p><p>As you can see from the screenshot the only information I need for each blog is Username/Password and the url that implement the <strong>XMLRPC Metaweblog API</strong> and since all major <em>Blog Engine</em> actually implement this interface, this utility can virtually migrate blog from every source and destination. The code is really simple, you can grab the list of post of the source blog with a single call.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>AlexJamesBrown.JoeBlogs.MetaWeblogWrapper wrapper = 
<span style=color:#66d9ef>new</span> MetaWeblogWrapper(xmlrpcurlSource.Text, usernameSource.Text, passwordSource.Text);
<span style=color:#66d9ef>var</span> posts = wrapper.GetRecentPosts(<span style=color:#ae81ff>10000</span>);
</code></pre></td></tr></table></div></div><p>Now you could simply create another wrapper to the Destination blog, iterate into all the post returned from the GetRecentPost and save them to the new blog.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>Post newPost = <span style=color:#66d9ef>new</span> Post();
newPost.categories = post.categories;
newPost.title = post.title;
newPost.description = document.DocumentNode.InnerHtml;
newPost.dateCreated = post.dateCreated;
<span style=color:#66d9ef>var</span> result = wrapperDest.NewPost(newPost, <span style=color:#66d9ef>true</span>);
</code></pre></td></tr></table></div></div><p>In *less than 10 lines of codes you can migrate post from a source blog to a destination one.*The only drawback is that you need to <strong>replicate categories manually</strong> from the original blog to the destination one, because the Joe Blog library does not support creation of categories, but this is a simple process that takes little works. My routine actually takes care of moving also the image resources from the original post to the destination one. When you blog with tools like <em>Windows Live Writer</em>, when you embed images into a post, the tool usually upload the image in destination blog, and if you only copy the blog post with the above code, <strong>all the images still refer to the one uploaded to the old blog</strong>. If the old blog will remain online usually this is not a big problem, but if you plan to turn off source blog entirely, all the image will not be available anymore.</p><p>The solution is fairly simple, usually in my post, windows live writer creates a thumbnail and each image is enclosed in <strong>anchor tag</strong> that will link to the full size image, so I start to identify all images in the post thanks to <strong><a href=http://htmlagilitypack.codeplex.com/>HtmlAgilityPack</a>.</strong><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>HtmlDocument document = <span style=color:#66d9ef>new</span> HtmlDocument();
document.LoadHtml(post.description);
<span style=color:#66d9ef>var</span> images = document.DocumentNode.SelectNodes(<span style=color:#e6db74>&#34;//img&#34;</span>);
 <span style=color:#66d9ef>if</span> (images != <span style=color:#66d9ef>null</span>)
 {
 		<span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> imageNode <span style=color:#66d9ef>in</span> images)
</code></pre></td></tr></table></div></div></p><p>Finding images is really simple, now for each image I need to <strong>download from the original source blog and reupload to the new destination blog</strong>. I will not show the entire code, but basically it is a matter of using a <strong>WebRequest</strong> object to download the image locally and reupload with the Joe Blog library</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>MediaObject newBlogImage = <span style=color:#66d9ef>new</span> MediaObject();
 newBlogImage.bits = ms.ToArray();
 newBlogImage.name = Guid.NewGuid().ToString() + realImageName;
newBlogImage.type = Path.GetExtension(realImageName);
info = wrapper.NewMediaObject(newBlogImage);
</code></pre></td></tr></table></div></div><p>Now you can simply <strong>change the src attribute</strong> of the image with the new url returned from the NewMediaObject call and the game is done, you are migrating both post and image resources from your old blog to the new one.</p><p>Full code <a href=http://www.codewrecks.com/files/blogmigrator.zip>can be downloaded here</a>, use at your own risk, because it is not tested, I’ve only tried to do migration of my blog and nothing more. The result of the export is in <a href=http://www.nablasoft.com/gianmaria/ title=http://www.nablasoft.com/gianmaria/>http://www.nablasoft.com/gianmaria/</a> and I’m actually doing some verification right now to verify if the export/import went good.</p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/programming/>Programming</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/blog/>Blog</a>, <a class=tag href=/tags/tools/>Tools</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2012/03/order-by-a-property-expressed-as-string-in-a-linq-query/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Order by a property expressed as string in a LINQ Query</a></div><div class="next-entry sep-before"><a href=/post/old/2012/03/mongo-cleanup-older-log/><span class=screen-reader-text>Next post: </span>Keep your Mongo log database small deleting old logs<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>