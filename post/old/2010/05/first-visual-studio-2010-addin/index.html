<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Code Downloadable Here . Visual Studio is really a complex and big product, but it is amazing to see how simple it is to write an addin to extend its functionality. First of all we have a dedicated project type for writing an add-in from inside Visual Studio (dogfooding)

Choosing the Visual Studio Add-in a Wizard helps you to decide the type of the addin.The wizard asks for the language to use, and some information, like if the addin should be loaded at startup and if it must be listed under the tools menu."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="First Visual studio 2010 addin • Codewrecks"><meta property="og:description" content="Code Downloadable Here . Visual Studio is really a complex and big product, but it is amazing to see how simple it is to write an addin to extend its functionality. First of all we have a dedicated project type for writing an add-in from inside Visual Studio (dogfooding)

Choosing the Visual Studio Add-in a Wizard helps you to decide the type of the addin.The wizard asks for the language to use, and some information, like if the addin should be loaded at startup and if it must be listed under the tools menu."><meta property="og:url" content="https://www.codewrecks.com/post/old/2010/05/first-visual-studio-2010-addin/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Addin"><meta property="article:tag" content="Visual Studio"><meta property="article:published_time" content="2010-05-22T09:00:37+02:00"><meta property="article:modified_time" content="2010-05-22T09:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>First Visual studio 2010 addin • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2010/05/first-visual-studio-2010-addin/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>First Visual studio 2010 addin</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>First Visual studio 2010 addin</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2010-05-22T09:00:37+02:00>2010, May 22</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p><a href=http://www.codewrecks.com/files/myaddin1.zip><strong>Code Downloadable Here</strong></a> <strong>.</strong> Visual Studio is really a complex and big product, but it is amazing to see how simple it is to write an addin to extend its functionality. First of all we have a dedicated project type for writing an add-in from inside Visual Studio (dogfooding)</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image18.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb18.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb18.png alt=image></a></a></p><p>Choosing the Visual Studio Add-in a Wizard helps you to decide the type of the addin.The wizard asks for the language to use, and some information, like if the addin should be loaded at startup and if it must be listed under the tools menu. After you created the project you can go to project properties and verify that, in the debug pane, the project is setup to start devenv.exe as <em>start External Program</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image19.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb19.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb19.png alt=image></a></a></p><p>The default arguments are the <strong>/resetaddin MyAddin1.Connect</strong> , but I also added the <a href=http://msdn.microsoft.com/en-us/library/bb166560%28VS.80%29.aspx>/rootsuffix Exp</a> to start with the <a href=http://msdn.microsoft.com/en-us/library/bb166560%28VS.100%29.aspx>Experimental Registry Hive</a>. This is needed to prevent that the addin you are developing will mess with normal settings of Visual Studio. Now you can simply press F5 and you should see another instance of Visual Studio that will opens up, and your new command should be listed in the tools menu. No modification is made to the standard Visual Studio settings, so you are sure that you cannot damage VS during development of your addin.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image20.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb20.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb20.png alt=image></a></a></p><p>The good point is that you obtained this without a single line of code and with no effort. Now I want to execute some code just to understand how to interact with the VS IDE.</p><p>I want to develop an addin that simply iterate through all solution projects and files and dump all names to the output console.</p><p>The code for doing this is really simple, you need to locate the connect.cs class, and write code inside the Exec method.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image21.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb21.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb21.png alt=image></a></a></p><p>As you can see it is really simple to interact with VS IDE; thanks to _applicationObject I can interact with the solution and enumerate projects, but I can also obtain a reference to the <em>General</em> pane of the output windows, to write string to the output console. Now I can simply dump solution name, then iterate into all the projects dumping project name and project Items. The DumpFiles method is a really simple recursive method to iterate into all project contents.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image22.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb22.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb22.png alt=image></a></a></p><p>The really amazing stuff is that you can setup a breakpoint in code, press F5, go to the newly opened Visual Studio instance (Experimental Hive), load a solution, invoke your command and theh breakpoint will be hit in the original instance of VS :) you are debugging Visual Studio with the Visual Studio debugger, with all the features enabled, like for example <a href=http://msdn.microsoft.com/en-us/library/dd264915.aspx>Intellitrace</a> or pinning variable values to the windows, or doing whatever you can do in a standard debugging session.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image23.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb23.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb23.png alt=image></a></a></p><p>The ability to use intellitrace is AMAZING because it helps you a lot to understand what is happening and <strong>what is happened</strong> inside VS. In the above screenshot I put a breakpoint into the function that output file name and traverse project tree, then I continue my debug session pressing F5 or F10, but with intellitrace I can simply look at variable values for each execution of the recursive iteration, as well as looking at events. In that example I can see that visual studio is actually accessing physical solution files :) but I can move in the past to understand the values of the Item object in each interation.</p><p>When the function finishes to execute I can verify in the debugged VS that the addin really did what I&rsquo;m expecting, so i take a look to the output windows in the General pane. In this example I&rsquo;m dumping the content of a <a href=http://msmvps.com/blogs/deborahk/archive/2010/05/02/vs-2010-database-project-an-introduction.aspx>Database Project</a> where I imported the Northwind structure and a simple empty C# project.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image24.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb24.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb24.png alt=image></a></a> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image25.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb25.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb25.png alt=image></a></a> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image26.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb26.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2010/05/image_thumb26.png alt=image></a></a></p><p>As you can see, with very few lines of code you are able to write an addin that explores solutions files, and with a fantastic Debugging Experience.</p><p><a href=http://www.codewrecks.com/files/myaddin1.zip><strong>Code Downloadable Here</strong></a> <strong>.</strong> Alk.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/visual-studio/>Visual Studio</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/addin/>Addin</a>, <a class=tag href=/tags/visual-studio/>Visual Studio</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2010/05/blame-on-me-for-old-vb-code-net-1-0-completely-not-cls/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Blame on me for old vb code net 10 completely not CLS</a></div><div class="next-entry sep-before"><a href=/post/old/2010/05/error-log4neterror-nhibernateprofilerappender-attempted-to-append-to-closed-appender-named-nhibernate-profiler/><span class=screen-reader-text>Next post: </span>Error log4netERROR NHibernateProfilerAppender Attempted to append to closed appender named NHibernateProfiler<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>