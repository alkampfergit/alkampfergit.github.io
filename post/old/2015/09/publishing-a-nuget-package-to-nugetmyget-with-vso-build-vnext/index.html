<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Publishing a package to myget or nuget with a TFS/VSO vNext build is a breeze. First of all you should create a** .nuspec file** that specify everything about your package and include it in your source control. Then Add a variable to the build called NugetVersion as shown in Figure 1. 
Figure 1: Added NugetVersion variable to build definition.
In this build I disabled continuous integration, because I want to publish my package only when I decided that the code is good enough to be published."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Publishing a Nuget package to NugetMyget with VSO Build vNext • Codewrecks"><meta property="og:description" content="Publishing a package to myget or nuget with a TFS/VSO vNext build is a breeze. First of all you should create a** .nuspec file** that specify everything about your package and include it in your source control. Then Add a variable to the build called NugetVersion as shown in Figure 1. 
Figure 1: Added NugetVersion variable to build definition.
In this build I disabled continuous integration, because I want to publish my package only when I decided that the code is good enough to be published."><meta property="og:url" content="https://www.codewrecks.com/post/old/2015/09/publishing-a-nuget-package-to-nugetmyget-with-vso-build-vnext/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="build"><meta property="article:tag" content="vNext"><meta property="article:published_time" content="2015-09-26T09:00:37+02:00"><meta property="article:modified_time" content="2015-09-26T09:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Publishing a Nuget package to NugetMyget with VSO Build vNext • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2015/09/publishing-a-nuget-package-to-nugetmyget-with-vso-build-vnext/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Publishing a Nuget package to NugetMyget with VSO Build vNext</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Publishing a Nuget package to NugetMyget with VSO Build vNext</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2015-09-26T09:00:37+02:00>2015, Sep 26</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>Publishing a package to myget or nuget with a TFS/VSO vNext build is a breeze. First of all you should <strong>create a** </strong>.nuspec file**<a href=https://docs.nuget.org/create/nuspec-reference></a> <strong>that specify everything about your package and include it in your source control</strong>. Then Add a variable to the build called NugetVersion as shown in <strong>Figure 1.</strong> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image6.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb6.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb6.png alt="Adding NugetVersion variable to the list of variables for this build."></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Added NugetVersion variable to build definition.</em></p><p>In this build I disabled continuous integration, because I want to publish my package only when I decided that the code is good enough to be published. Publishing to a feed for each build is usually a waste of resources and a nice way to make the history of your package a pain. Since I want to do manual publishing I’ve checked the <strong>“Allow at Queue Time” checkbox, to be able to change Nuget Version Number at queue time.</strong> <strong>Build vNext has a dedicated step called NugetPackager that takes care of creating your package from nuspec file</strong> , so you do not need to include nuget.exe in your repository or in the server. If you are curious where is nuget.exe stored, you can check installation folder of your build agent, and browse the Task Directory where all the tasks are contained. There you should find the NugetPackager folder where all the script used by the tasks are stored.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb7.png alt="How to configure Nuget Packager to create your package."></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Added Nuget Packager step to my build.</em></p><p>You can use wildchars as pattern to nuspec files; as an example **you can specify **\*.nuspec to create a package for all nuspec file in your source directory **. In this example I’have multiple nuspec in my repository, but I want to deploy only a specific package during this build, so I’ve decided to specify a single file to use. Thanks to the small button with ellipsis at the right of the textbox, you can choose the file browsing the repository.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb8.png alt="Thanks to source browsing you can easily choose your nuspec file to create package."></a></a>** Figure 3: ***Browsing source files to choose nuspec file to use.*</p><p>Then <strong>I’ve choose $(Build.StagingDirectory) as Package folder, to be sure that resulting nupkg file will be created in staging directory, outside of the src folder</strong>. This is important, because if you do not choose to clean src folder before each build, you will end with multiple nupkg file in your agent work directory, one for each version you published in the past. If you use StagingDirectory as destination for your nupkg files, it will be automatically cleared before each build. <strong>With this configuration you are sure that staging directory contains only.nupkg files created by current build</strong>.</p><p>Finally in the Advanced tab I’ve used the Nuget Arguments textbox to specify the -version option to force using version specified in the $(NugetVersion) build parameter.</p><p>The last step is including a step of type Nuget Publisher, that will be used to publish your package to nuget / Myget.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb9.png alt="Configuration of NugetPublisher step to publish your package to your feed"></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Final publishing step to publish nuget to your feed.</em></p><p>If you use Staging Directory as output folder for your Nuget Package step,**you can specify a pattern of $(build.stagingDirectory)\*.nupkg to automatically publish all packages created in previous steps **. If you will change the build in the future adding other NugetPackager steps to create other packages, you can use this single Nuget Publisher to automatically publish every.nupkg file found in staging directory.</p><p>Finally you need to specify the Nuget Server Endpoint; probably your combobox is empty, so you need to click the** Manage **link at the right of the combo to manage your endpoint.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML563093.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML563093_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML563093_thumb.png alt="Manage endpoint in your VSO account"></a></a>** Figure 5: ***Managing endpoint*</p><p>Clicking Manage link, a new tab is opened in the service tab of Collection configuration, here <strong>you can add endpoint to connect your VSO account to other service. Since Nuget or MyGet is not in the list, you should add a new service endpoint of type</strong> <strong>Generic.</strong> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb10.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb10.png alt="Specify your server url and your api key to create an endopint"></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Adding endpoint for nuget or myget server</em></p><p>**You must specify the server url of your feed and your API KEY in the <em>Password/Token Key</em>field of the endpoint. **Once you press OK the endpoint is created; no one will be able to read the API KEY from the configuration and your key is secured in VSO.</p><p>Now all Project Administrators can use this endpoint in your Nuget Publisher step to publish against that feed, without giving them API KEY or password.** All endpoints have specific security **so you can specify the list of the users that will be able to change that specific endpoint or list of users that will be only able to Read that specific endpoint. This is a nice way to save details of your nuget feed in VSO, specifying the list of the user that can use this feed, without giving password or token to anyone.</p><p>When everything is done, you can simply queue a new build, and choose the version number you want to assign to your Nuget Package.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image11.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb11.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb11.png alt="You can queue the build specifying branch and Nuget Numbering"></a></a>** Figure 7: ***Queuing a build to publish your package with a specific number.*</p><p>You have the ability to choose the branch you want to publish, as well as the Number of your nuget package to use. Once the build is finished your package should be published.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML601346.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML601346_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/SNAGHTML601346_thumb.png alt="Feed detail in MyGet account correctly list packages published by my vNext build"></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Your package is published in your MyGet feed.</em></p><p>In previous example I’ve used master branch and published version number 1.3.1. Suppose you want to publish a pre-release package with new features that are not still stable. <strong>These features are usually in develop branch (especially true if you use GitFlow with git repositories), and thanks to configuration you can simply queue a new build to publish pre-release package</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image12.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb12.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb12.png alt="Specifing developing branch and a package number ending with beta1 you can publish pre-release packages."></a></a></p><p><em><strong>Figure 9</strong></em>: <em>Publish a pre-release package using develop branch and a nuget version that has a –beta1 suffix.</em></p><p><strong>I’ve specified to use develop branch and a nuget version number ending with –beta1, to specify that it is a pre-release package</strong>. When the build is finished you can check from your visual studio that everything is ok.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb13.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb13.png alt="Verify that in Visual Studio stable and Pre-Release package is ok."></a></a></p><p><em><strong>Figure 10</strong></em>: <em>Verify in Visual Studio that everything is ok.</em></p><p>Thanks to Build vNext, publishing your package to myget or nuget or private nuget feed is just a matter of including a couple of steps and filling few textboxes.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/build/>build</a>, <a class=tag href=/tags/vnext/>vNext</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2015/09/why-im-not-a-great-fan-of-linq-query-for-mongodb/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Why Irsquom not a great fan of LINQ query for MongoDb</a></div><div class="next-entry sep-before"><a href=/post/old/2015/10/how-to-add-a-user-to-project-collection-service-account-in-tfs-vso/><span class=screen-reader-text>Next post: </span>How to add a user to Project Collection Service Account in TFS VSO<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>