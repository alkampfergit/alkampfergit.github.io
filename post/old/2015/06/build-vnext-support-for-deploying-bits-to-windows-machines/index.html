<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="One of the most interesting trend of DevOps movement is continuous deployment using build machines. Once you get your continuous build up and running, the next step is customizing the build to deploy on one or more test environments. If you do not need to deploy in production, there is no need of a controlled release pipeline (Ex: Release Management) and using a simple build is the most productive choiche. In this scenario one of the biggest pain is moving bits from the build machine to target machines."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Build vNext support for deploying bits to Windows machines • Codewrecks"><meta property="og:description" content="One of the most interesting trend of DevOps movement is continuous deployment using build machines. Once you get your continuous build up and running, the next step is customizing the build to deploy on one or more test environments. If you do not need to deploy in production, there is no need of a controlled release pipeline (Ex: Release Management) and using a simple build is the most productive choiche. In this scenario one of the biggest pain is moving bits from the build machine to target machines."><meta property="og:url" content="https://www.codewrecks.com/post/old/2015/06/build-vnext-support-for-deploying-bits-to-windows-machines/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="devops"><meta property="article:published_time" content="2015-06-20T13:00:37+02:00"><meta property="article:modified_time" content="2015-06-20T13:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Build vNext support for deploying bits to Windows machines • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2015/06/build-vnext-support-for-deploying-bits-to-windows-machines/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Build vNext support for deploying bits to Windows machines</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Build vNext support for deploying bits to Windows machines</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2015-06-20T13:00:37+02:00>2015, Jun 20</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p>One of the most interesting trend of DevOps movement is continuous deployment using build machines. Once you get your continuous build up and running, the next step is <strong>customizing the build to deploy on one or more test environments</strong>. If you do not need to deploy in production, there is no need of a controlled release pipeline (Ex: Release Management) and using a simple build is the most productive choiche. In this scenario <strong>one of the biggest pain is moving bits from the build machine to target machines.</strong> Once build output is moved to a machine, installing bits is usually only a matter of using some PowerShell script.</p><blockquote><p>In Build, Deploy, Test scenario, quite often copying build output to target machine is the most difficult part</p></blockquote><p>Thanks to Build vNext solving this problem is super easy. If you go to your visualstudio.com account, and choose the TEST hub, you can notice a submenu called machines.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb13.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb13.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Machines functionality in Visualstudio.com</em></p><p>This new menu is related to a new feature, still in preview, used to define groups of machine that can be use for deploy and testing workflows. In <strong>Figure 1</strong> you notice a group called Cyberpunk1. Creating a group is super-easy, <strong>you just need to give it a name, specify administrative credentials and the list of the machines that will compose the group</strong>. You can also use different credentials for each machine, but using machine in Active Directory domain is usually the simplest scenario.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image14.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb14.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb14.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Editing of machine groups</em></p><p>Actually this feature still does not support Azure Virtual Machines, but you can easily target machine in your on-premise infrastructure. You just need to be sure that</p><ul><li><em>All machines are reachable from the machine where the build agent is running</em></li><li><em>Check your DNS to verify that the names resolution is ok</em></li><li><em>All target machines should have Powershell remoting enabled</em></li><li><em>All target machines should have sharing of file system enabled</em></li><li><em>Firewall port are opened.</em></li></ul><p>I’ve tested with an environment where both machines are running Windows Server 2012 R2, with latest update and file sharing enabled. Once you defined a machine group, you can use it to automatically copy files from build agent to all machines with a simple task of build vNext.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/SNAGHTML3b78ea.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/SNAGHTML3b78ea_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/SNAGHTML3b78ea_thumb.png alt=SNAGHTML3b78ea></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Windows machine File Copy task</em></p><p>Thanks to this simple task you can simply copy files from build machine to destination machine, without the need to install any agent or other components. <strong>All you need to do is choose the machine group, target folder and source folder.</strong> If you get error running the build, a nice new feature of build vNext is the ability to download full log as zip, where all the logs are separated by tasks</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image15.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb15.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb15.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>All build logs are separated for each step, to simplify troubleshooting</em></p><p>Opening the file 4_Copy … you can read logs related to the copy build step, to understand why the step is failing. Here is what I find in one of my build that failed.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Failed to connect to the path <span style=color:#ae81ff>\\</span>vsotest.cyberpunk.local with the user administrator@cyberpunk.local <span style=color:#66d9ef>for</span> copying.System error <span style=color:#ae81ff>53</span> has occurred. 
 2015-06-10T08:35:02.5591803Z The network path was not found.</code></pre></td></tr></table></div></div><p>In this specific situation the RoboCopy tool is complaining that the network path was not found, because I forgot to enable file sharing on the target machine. Once I enabled file sharing an running again the build everything was green, and I can verify that all files were correctly copied on target machines.</p><blockquote><p>As a general rule, whenever a build fails, download all log and inspect the specific log for the task that failed.</p></blockquote><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image16.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb16.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2015/06/image_thumb16.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Sample application was correctly copied to target machines.</em></p><p>In my first sample, I’ve used TailspinToys sample application, I’ve configured MsBuild to use StagingDirectory as output folder with parameter OutDir: /p:OutDir=$(build.stagingDirectory) and thanks to Windows Machine File Copy task all build output is automatically copied on target machines.</p><p>Once you got your build output copied on target machine, you need only to create a script to install the new bits, and maybe some integration test to verify that the application is in healthy state.</p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a>, <a class=category href=/categories/testing/>Testing</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/devops/>DevOps</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2015/06/build-vnext-and-continuous-integration-on-github/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Build vNext and continuous integration on GitHub</a></div><div class="next-entry sep-before"><a href=/post/old/2015/06/git-for-windows-getting-invalid-username-or-password-with-wincred/><span class=screen-reader-text>Next post: </span>Git for windows getting Invalid username or password with Wincred<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>