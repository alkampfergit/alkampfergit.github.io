<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Microsoft Security Code Analysis contains a set of Tasks for Azure DevOps pipeline to automate some security checks during building of your software. Automatic security scanning tools are not a substitute in any way for human security analysis, remember: if you develop code ignoring security, no tool can save you.
Despite this fact, there are situation where static analysis can really give you benefit, because it can avoid you some simple and silly errors, that can lead to troubles."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Quick Peek at Microsoft Security Code Analysis Credential Scanner • Codewrecks"><meta property="og:description" content="Microsoft Security Code Analysis contains a set of Tasks for Azure DevOps pipeline to automate some security checks during building of your software. Automatic security scanning tools are not a substitute in any way for human security analysis, remember: if you develop code ignoring security, no tool can save you.
Despite this fact, there are situation where static analysis can really give you benefit, because it can avoid you some simple and silly errors, that can lead to troubles."><meta property="og:url" content="https://www.codewrecks.com/post/old/2019/11/quick-peek-at-microsoft-security-code-analysis-credential-scanner/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="AzureDevOps"><meta property="article:tag" content="build"><meta property="article:published_time" content="2019-11-23T16:00:37+02:00"><meta property="article:modified_time" content="2019-11-23T16:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Quick Peek at Microsoft Security Code Analysis Credential Scanner • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2019/11/quick-peek-at-microsoft-security-code-analysis-credential-scanner/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Quick Peek at Microsoft Security Code Analysis Credential Scanner</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Quick Peek at Microsoft Security Code Analysis Credential Scanner</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2019-11-23T16:00:37+02:00>2019, Nov 23</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>6 mins read</span></div></div></header><div class="container entry-content"><p><a href=https://secdevtools.azurewebsites.net/><strong>Microsoft Security Code Analysis</strong></a> <strong>contains a set of Tasks for Azure DevOps pipeline to automate some security checks during building of your software.</strong> Automatic security scanning tools are not a substitute in any way for human security analysis, remember: if you develop code ignoring security, no tool can save you.</p><p><strong>Despite this fact, there are situation where static analysis can really give you benefit,</strong> because it can avoid you some simple and silly errors, that can lead to troubles. All Tasks in Microsoft Security Code Analysis package are designed to solve a particular problem and to prevent some common mistake.</p><blockquote><p>Remember that security cannot be enforced only with automated tools; nevertheless they are useful to avoid some common mistakes and are not meant to replace security audit of your code.</p></blockquote><p>The first task I suggest you to look at is <strong>Credential Scanner, a simple task that searches source code for potential credentials inside files.</strong> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-12.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-12.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-12.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Credential scanner task</em></p><p>Modern projects, especially those designed for the cloud, use tons of sensitive data that can be mistakenly stored in source code. The easiest mistake is storing credential for databases or other services inside configuration file, like web.config for ASP.Net projects or <strong>we can left some Token for Cloud resource or services, leaving that resource unprotected.</strong> Including Credential Scanner in your azure pipeline can save you troubles, with minimal configuration you can have it scan your source code to find credentials. <strong>All you need to do is drop the task in the pipeline, use default configuration and you are ready to go.</strong> Full details on configuring the task <a href=https://secdevtools.azurewebsites.net/helpcredscan.html>could be found here.</a></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-13.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-13.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Configuration pane for Credential Scanner</em></p><p>Credential scan will run in your pipeline and report problem found.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-14.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-14.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-14.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Credential scanner found a match.</em></p><p>If you look in <em><strong>Figure 3</strong></em>: Credential scanner found a match, but the task does not make the build fails (as you could expect). This is normal behvior, because <strong>all security tasks are meant to produce an output file with scan result, and it is duty of another dedicated task to analyze all results file and make the build fail if problems are found</strong>.</p><blockquote><p>It is normal to have security related tasks not to fail the build immediately, a dedicated tasks is needed to analyze ALL log files and fail the build if needed</p></blockquote><p>Post Analysis task is your friends here.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-15.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-15.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-15.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Add a Post Analysis task to have the build fails if some of the security related task failed</em></p><p>Actually this special task allows you to specify which of the security task you want to analyze and this is the reason why the build does not fails immediately when Credential Scanner found a problem. <strong>The goal here is running ALL security related tasks, then analyze all of them and have the build fails if problems where found.</strong> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-16.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-16.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-16.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Choose which analyzer you want to use to make the build fail.</em></p><p>After you added this task at the end of the build, your build fails if security problems are found.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-17.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-17.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-17.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Build fails because some of the analysis found some problems. In this specific situation we have credentials in code.</em></p><p>As you can see from <strong>Figure 6</strong> Credential Scan task is green and is the Security Post Analysis Task that made the build fails. It also log some information in build errors page as you can see from <strong>Figure 7.</strong> <a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-18.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-18.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-18.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Build fails for issues in credential scanner</em></p><p><strong>Now the final question is: where can I found the csv file generated by the tool?</strong> The answer is simple, there is another special task whose purpose is upload all logs as artifacts of the build.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-19.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-19.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-19.png alt=image></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Simply use the PublishSecurityAnalysisLog task to have all security related logs published as artifacts.</em></p><p>As you can see from <strong>Figure 9</strong> all the logs are correctly uploaded as artifacts and divided by tool type.  In this example I’ve ran only the Credential Scanner Tool so it is the only output I have in my artifacts folder.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-20.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-20.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-20.png alt=image></a></a></p><p><em><strong>Figure 9</strong></em>: <em>Credential Scanner output included as artifact build.</em></p><p>Downloading the file you can open it with excel (I usually use csv file output for Credential Scanner) and find what’s wrong.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-21.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-21.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-21.png alt=image></a></a></p><p><em><strong>Figure 10</strong></em>: <em>Csv output contains the file with the error, the number of the line but everything else is redacted out for security</em></p><p>As I can verify from csv output, I’ve some problem at line 9 of config.json file, time to look at the code and find the problem.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/SNAGHTML7881da.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/SNAGHTML7881da_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/SNAGHTML7881da_thumb.png alt=SNAGHTML7881da></a></a></p><p><em><strong>Figure 11</strong></em>: <em>Password included in a config file.</em></p><blockquote><p>In CSV output file, Credential Scanner task only store file, row number and hash of the credential found, this is needed to avoid the credential leak from build output.</p></blockquote><p>Now, this example was made for this post, so do not try that password against me, it will just not work :). If you think that you never fall for this silly mistake remember that noone is perfect. Even if I’m trying to avoid these kind of errors, I must admit that <strong>some</strong> <strong>years ago I was contacted by a nice guy that told me that I’ve left a valid token in one of my sample source.</strong> Shame on me, but this kind of errors could happen. Thanks to Credential Scanner you can really mitigate them.</p><p>If you wonder what kind of rules the task uses to identify password, the documentation states that</p><p><em>CredScan relies on a set of content searchers commonly defined in the buildsearchers.xml file. The file contains an array of XML serialized objects that represent a ContentSearcher object. The program is distributed with a set of searchers that have been well tested but it does allow you to implement your own custom searchers too.</em></p><p>So you can download the task, and examine the dll, but the nice aspect is that you can include your own searcher too.</p><p><strong>If the tool find false positive and you are really sure that the match is really a false positive, you can use an exclude file</strong> as for the documentation.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image-22.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-22.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2019/11/image_thumb-22.png alt=image></a></a></p><p><em><strong>Figure 12</strong></em>: <em>Suppression rules for the task.</em></p><p>I must admit that Credential Scanner is really a powerful tool that should be included in every build, especially if you are developing open source code. <strong>Remember that there are lots of tools made to scavenge projects for this kind of vulnerabilities in code</strong> , so, if you publish some sensitive password or keys in open source project, it constitutes a big problem. Sooner or later this will bite you.</p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/security/>security</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/azuredevops/>AzureDevOps</a>, <a class=tag href=/tags/build/>build</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2019/11/unable-to-execute-net-core-unit-test-in-vs-after-uninstalling-older-sdk/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Unable to execute NET core unit test in VS after uninstalling older sdk</a></div><div class="next-entry sep-before"><a href=/post/old/2019/11/security-in-2019-still-unprotected-elasticsearch-instance-exists/><span class=screen-reader-text>Next post: </span>Security in 2019 still unprotected ElasticSearch instance exists<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>