<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Yesterday I’ve started an old virtual machine with an old version of TFS and when I try to access the instance I got a “Service Unavailable” error.

Figure 1: General Service Unavailable error for TFS Web interface
This error happens most of the time if you have wrong user credentials in the worker process used by IIS to run the TFS Application. To verify this assumption, you can simply open IIS Manager console and verify the status of the worker process that is used to run IIS ( Figure 2 )"><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Troubleshoot 'service unavailable' in TFS • Codewrecks"><meta property="og:description" content="Yesterday I’ve started an old virtual machine with an old version of TFS and when I try to access the instance I got a “Service Unavailable” error.

Figure 1: General Service Unavailable error for TFS Web interface
This error happens most of the time if you have wrong user credentials in the worker process used by IIS to run the TFS Application. To verify this assumption, you can simply open IIS Manager console and verify the status of the worker process that is used to run IIS ( Figure 2 )"><meta property="og:url" content="https://www.codewrecks.com/post/old/2018/02/troubleshoot-service-unavailable-in-tfs/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Team Foundation Server"><meta property="article:published_time" content="2018-02-26T18:00:37+02:00"><meta property="article:modified_time" content="2018-02-26T18:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Troubleshoot 'service unavailable' in TFS • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2018/02/troubleshoot-service-unavailable-in-tfs/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Troubleshoot 'service unavailable' in TFS</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Troubleshoot 'service unavailable' in TFS</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2018-02-26T18:00:37+02:00>2018, Feb 26</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>3 mins read</span></div></div></header><div class="container entry-content"><p>Yesterday I’ve started an old virtual machine with an old version of TFS and when I try to access the instance I got a “Service Unavailable” error.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-6.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-6.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-6.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>General Service Unavailable error for TFS Web interface</em></p><p>This error happens most of the time if you have wrong user credentials in the worker process used by IIS to run the TFS Application. To verify this assumption, you can simply <strong>open IIS Manager console and verify the status of the worker process</strong> that is used to run IIS ( <strong>Figure 2</strong> )</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-7.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>The application pool in IIS is stopped.</em></p><p>As you can verify from <strong>Figure 2,</strong> the IIS app pool used to run service is stopped, if I tried to start again the pool, it immediately stopped again. This is usually the symptom of  bad authentication, this means that the pool is running with wrong user credentials. You can verify this in Event Viewer log, but <strong>absolutely avoid messing with the setting of the Application Pools directly,</strong> this is a task that should be demanded to the administration console.</p><blockquote><p>As a general rule, you should never manually edit the configuration used for TFS in your IIS instance, everything should be done through the correct command</p></blockquote><p>To fix this error open the Admin console and verify the Service Account used to run your TFS Instance</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-8.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Application tier configuration, you can view Service Account user.</em></p><p>You can run Service Account with standard NETWORK SERVICE account, but <strong>I prefer using specific domain account, because I have more control on how all TFS Services will authenticate on the other machine of the domain.</strong> I changed the password of that account a couple of month ago, but that specific VM was never updated with the new credentials.</p><p><strong>This is something that can happens in a domain, especially if you care about security and you force every account to change password every certain number of months</strong>. In this scenario my TFS instance cannot start again because it was still configured with the old password, but you can fix it with a couple of clicks.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-9.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Reapplying account can save your days when password of service user account of TFS was changed.</em></p><p>If you look in <strong>figure 4</strong> , the solution is really simple, because the Reapply Account command gives you the ability to re-enter the new password for the account, use the test function to verify that it is correct and once you press OK, the administration console takes care of everything.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-10.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-10.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Result of re-applying the account.</em></p><p>As you can see in Figure 5, the account is used not only in the application Tier, but also for Message Queue, TFSJobAgent and so on. This is the reason why I warned you not to fix the credential in IIS manually, doing this does not fix every place where wrong authentication are used.</p><p>Everything was green now green in the console, so I immediately tried to access the instance again, to verify that indeed everything is up and running again.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-11.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-11.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-11.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Everything is up and running again.</em></p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/team-foundation-server/>Team Foundation Server</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2018/02/vsts-tfs-use-wildcards-for-continuous-integration-in-git/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>VSTS TFS use Wildcards for continuous integration in Git</a></div><div class="next-entry sep-before"><a href=/post/old/2018/03/test-explorer-in-vs-15-6/><span class=screen-reader-text>Next post: </span>Test Explorer in VS 156<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>