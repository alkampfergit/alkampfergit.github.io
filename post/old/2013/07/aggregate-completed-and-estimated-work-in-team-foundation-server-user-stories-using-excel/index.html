<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="If you use the Agile process template, you have three columns related to planning and tracking task duration, they are called:
 Original Estimate Completed Work Remaining Work  The only problem is that TFS only aggregates the Remaining Work in the agile boards , as you can see in Figure 1 :

Figure 1: Board with Original Estimate and Completed Work columns visible
There is a Server Side plugin called TFS Aggregator available in Codeplex that can mitigate this issue, but using a Server Side plugin could not be the optimal solution."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Aggregate Completed and Estimated Work in Team Foundation Server User Stories using Excel • Codewrecks"><meta property="og:description" content="If you use the Agile process template, you have three columns related to planning and tracking task duration, they are called:
 Original Estimate Completed Work Remaining Work  The only problem is that TFS only aggregates the Remaining Work in the agile boards , as you can see in Figure 1 :

Figure 1: Board with Original Estimate and Completed Work columns visible
There is a Server Side plugin called TFS Aggregator available in Codeplex that can mitigate this issue, but using a Server Side plugin could not be the optimal solution."><meta property="og:url" content="https://www.codewrecks.com/post/old/2013/07/aggregate-completed-and-estimated-work-in-team-foundation-server-user-stories-using-excel/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Tfs"><meta property="article:published_time" content="2013-07-10T15:00:37+02:00"><meta property="article:modified_time" content="2013-07-10T15:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Aggregate Completed and Estimated Work in Team Foundation Server User Stories using Excel • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2013/07/aggregate-completed-and-estimated-work-in-team-foundation-server-user-stories-using-excel/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Aggregate Completed and Estimated Work in Team Foundation Server User Stories using Excel</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Aggregate Completed and Estimated Work in Team Foundation Server User Stories using Excel</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2013-07-10T15:00:37+02:00>2013, Jul 10</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>5 mins read</span></div></div></header><div class="container entry-content"><p>If you use the Agile process template, you have three columns related to planning and tracking task duration, they are called:</p><ul><li>Original Estimate</li><li>Completed Work</li><li>Remaining Work</li></ul><p>The only problem is that TFS <strong>only aggregates the Remaining Work in the agile boards</strong> , as you can see in <strong>Figure 1</strong> :</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image25.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb25.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb25.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Board with Original Estimate and Completed Work columns visible</em></p><p>There is a <strong>Server Side plugin called</strong> <a href=http://tfsaggregator.codeplex.com/><strong>TFS Aggregator</strong></a> available in Codeplex that can mitigate this issue, but using a Server Side plugin could not be the optimal solution. If you are using <strong>TF Service on Azure you have no option to install any server side plugin or any customization of process template</strong> , but even for on-premise installation, installing a server side plugin can complicate your maintenance of the server and you should trust the author of the plugin for keeping it update as new versions of TFS will be released.</p><p>A possible solution is <strong>using TFS API to load all data in a custom program and then doing calculation directly with custom code</strong> , but this can be an expensive solution in terms of time.</p><p>The third solution is using excel to do the calculation for you. If you load data from TFS and choose to add the three aforementioned columns, you can start adding another column after each of the three as shown in this picture.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image26.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb26.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb26.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Three empty columns added to the Excel worksheet connected to TFS</em></p><p>Now we need to create some formula to aggregate data of all task into parent User Story. In such a situation the simplest approach is creating a custom excel macro, es:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=color:#66d9ef>Function</span> <span style=color:#a6e22e>SumUntilNull</span>(startCell <span style=color:#f92672>As</span> Range) <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>
Application.Volatile
<span style=color:#66d9ef>If</span> startCell.Cells(1, 1) <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#66d9ef>Then</span>

    <span style=color:#66d9ef>Dim</span> running <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>
    running <span style=color:#f92672>=</span> 0
    <span style=color:#66d9ef>Dim</span> row <span style=color:#f92672>As</span> <span style=color:#66d9ef>Integer</span>
    row <span style=color:#f92672>=</span> 2
    <span style=color:#66d9ef>While</span> startCell.Cells(row, 1) <span style=color:#f92672>&lt;&gt;</span> <span style=color:#e6db74>&#34;&#34;</span>
        running <span style=color:#f92672>=</span> running <span style=color:#f92672>+</span> startCell.Cells(row, 1)
        row <span style=color:#f92672>=</span> row <span style=color:#f92672>+</span> 1
    <span style=color:#66d9ef>Wend</span>
    SumUntilNull <span style=color:#f92672>=</span> running
<span style=color:#66d9ef>Else</span>

    SumUntilNull <span style=color:#f92672>=</span> 0
<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span></code></pre></td></tr></table></div></div><p>This is a super simple macro, it accepts a Range and it does the following operations</p><ul><li>If the first cell of the range is not empty it returns 0</li><li>if the first cell is empty it starts to cycle all the cells below the first cell</li><li>for each cell that is not empty it sum the number to a running total</li><li>the cycle will stop when the first empty cell below the first one is encountered</li></ul><p>Once you have defined such a function you can use in your new columns, the interesting part is that you can simply start typing your formula (=SumUntilNull), then you click the Remaining Work column of the cell in the left, and Excel automatically understand the field you are using, as you can see in <strong>Figure 2</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image27.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb27.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb27.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Use your function to create the aggregation</em></p><p>Once you finish the formula, Excel will replicate the formula to all the rows of the area connected to TFS. The trick is: for each row where a User Story (the father item) is present, the value of the cell is null, so your function automatically iterates on all related task until it find another null cell (end of the interval or the next User Story). This will aggregate the data for you.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image28.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb28.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb28.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Your formula correctly aggregates all the value from child work items (Task) to the parent (User Story)</em></p><p>the advantage of this approach is that you can simply press “refresh” in the TEAM tab, and Excel will update all work items from Team foundation Server, new Task will be loaded and your totals will updates automatically without any further modification.</p><p><strong>Thanks to excel macro, manipulating the result of a TFS Query is a really simple operation</strong>. If you are not interested in the Task part of the query, but you want only to visualize the User Story and the aggregate value, you can also use another simple macro that hides all Task rows whenever a cell in the Worksheet change.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vb data-lang=vb><span style=color:#66d9ef>Private</span> <span style=color:#66d9ef>Sub</span> <span style=color:#a6e22e>Worksheet_Change</span>(<span style=color:#66d9ef>ByVal</span> Target <span style=color:#f92672>As</span> Range)
     <span style=color:#66d9ef>For</span> rownum <span style=color:#f92672>=</span> 3 <span style=color:#66d9ef>To</span> 100
        <span style=color:#66d9ef>If</span> <span style=color:#66d9ef>Me</span>.Cells(rownum, 2) <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Task&#34;</span> <span style=color:#66d9ef>Then</span>
            <span style=color:#66d9ef>Me</span>.Rows(rownum).EntireRow.Hidden <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
        <span style=color:#66d9ef>Else</span>
            <span style=color:#66d9ef>Me</span>.Rows(rownum).EntireRow.Hidden <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
        <span style=color:#66d9ef>End</span> <span style=color:#66d9ef>If</span>

    <span style=color:#66d9ef>Next</span>

<span style=color:#66d9ef>End</span> <span style=color:#66d9ef>Sub</span></code></pre></td></tr></table></div></div><p>The above macro iterate in the first 100 rows of the sheet (it should be placed inside the sheet where you loaded the Work Items) and change the visibility of the row, hiding all Task Rows. A better solution is adding a <strong>couple of buttons to hide/show tasks</strong> , instead of having it run for each change in the Worksheet :), but it is only to give you an idea of what you can achieve with excel.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image29.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb29.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb29.png alt=image></a></a>+</p><p><em><strong>Figure 3</strong></em>: <em>A couple of hide / Unhide buttons to simply hide / unhide all tasks rows</em></p><p>Manipulating data with Excel is really interesting, because it does not require so many technical skill, it can be easily done even by managers and does not require a developer. Once the macro is in place, it is just a matter of opening the excel, choose to refresh the data from TFS and the game is done.</p><p>You can download an Excel connected to the <a href=http://aka.ms/almvms>Brian Keller Virtual machine</a> with all the macro at this address <a href=http://sdrv.ms/16lxfxJ title=http://sdrv.ms/16lxfxJ>http://sdrv.ms/16lxfxJ</a></p><p>Gian Maria</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/tfs/>Tfs</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2013/07/deploying-on-azure-web-sites-from-on-premise-tfs/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Deploying on Azure Web sites from on-premise TFS</a></div><div class="next-entry sep-before"><a href=/post/old/2013/07/customize-process-template-experience-in-tfs-2013/><span class=screen-reader-text>Next post: </span>Customize process template experience in TFS 2013<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>