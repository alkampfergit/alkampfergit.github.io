<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Customizing process template is a real cool part of Team Foundation Server, because it permits you to follow the “ do not adapt your process to the tool but adapt the tool to your process ” scenario. There are a lot of best practices and a really good guide published by TFS Rangers, in this post I want to show how you can use a PowerShell script in a Tfs2013 Build to automatically update your Template at each push of a new definition."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Customize process template experience in TFS 2013 • Codewrecks"><meta property="og:description" content="Customizing process template is a real cool part of Team Foundation Server, because it permits you to follow the “ do not adapt your process to the tool but adapt the tool to your process ” scenario. There are a lot of best practices and a really good guide published by TFS Rangers, in this post I want to show how you can use a PowerShell script in a Tfs2013 Build to automatically update your Template at each push of a new definition."><meta property="og:url" content="https://www.codewrecks.com/post/old/2013/07/customize-process-template-experience-in-tfs-2013/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Process Template"><meta property="article:published_time" content="2013-07-10T20:00:37+02:00"><meta property="article:modified_time" content="2013-07-10T20:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Customize process template experience in TFS 2013 • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2013/07/customize-process-template-experience-in-tfs-2013/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Customize process template experience in TFS 2013</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Customize process template experience in TFS 2013</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2013-07-10T20:00:37+02:00>2013, Jul 10</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>6 mins read</span></div></div></header><div class="container entry-content"><p>Customizing process template is a real cool part of Team Foundation Server, because it permits you to follow the “ <strong>do not adapt your process to the tool but adapt the tool to your process</strong> ” scenario. There are a lot of best practices and a <a href=http://vsartfsptguide.codeplex.com/>really good guide published by TFS Rangers</a>, in this post I want to show how you can use a PowerShell script in a Tfs2013 Build to automatically update your Template at each push of a new definition.</p><p>First of all, whenever you customize a process template <strong>you should always store your modified process in source control</strong> , because this is the only way to track down exactly what you have changed and gives you the whole history of the customization. This is especially useful if, upgrading to a new version to TFS, the automatic process upgrade does not work and you need to reapply all your customization to the new process.</p><p>To create this demo <strong>I created a Team Project called PtCustomization based on Git repository</strong> (support for git is new in TFS 2013). The process template of the Team Project is Scrum and the first step is downloading the actual process template in a folder where I’ve cloned the repository. After the first download I immediately commit everything, so I have the original version of the template as the first commit. The next step is creating a couple of helper files</p><ul><li><em>A powershell script that will upload all Work Item Definition to a specific Team Project</em></li><li><em>A personalized build to simply run a Script during a TFS build</em></li></ul><p>The first file is a powershell script that will upload process template customization to the PtCustomization Team Project. Having such a script makes customization really simpler: <strong>modify the process template, run the script and the Team Project immediately reflects the modifications</strong>. Here is the script</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell>$TeamProjectName = <span style=color:#e6db74>&#34;PtCustomization&#34;</span>
$baseLocation = Split-Path -parent $PSCommandPath
$witdLocation = $baseLocation + <span style=color:#e6db74>&#34;\scrum\WorkItem Tracking\TypeDefinitions&#34;</span>

$CollectionUrl = <span style=color:#e6db74>&#34;http://tfs2013preview:8080/tfs/ExperimentalCollection&#34;</span>
$WitAdmin = <span style=color:#e6db74>&#34;${env:ProgramFiles(x86)}\Microsoft Visual Studio 12.0\Common7\IDE\witadmin.exe&#34;</span>

$items = Get-ChildItem -Path $witdLocation 
<span style=color:#66d9ef>foreach</span> ($item <span style=color:#66d9ef>in</span> $items)
{
    $witd = $item.FullName
    &amp; $WitAdmin importwitd /collection<span style=color:#960050;background-color:#1e0010>:</span>$CollectionUrl /p:$TeamProjectName /f:<span style=color:#e6db74>&#34;$witd&#34;</span>
}
&amp; $WitAdmin importcategories /collection<span style=color:#960050;background-color:#1e0010>:</span>$CollectionUrl /p:$TeamProjectName /f:<span style=color:#e6db74>&#34;$baseLocation\scrum\WorkItem Tracking\categories.xml&#34;</span>
&amp; $WitAdmin importprocessconfig /collection<span style=color:#960050;background-color:#1e0010>:</span>$CollectionUrl /p:$TeamProjectName /f:<span style=color:#e6db74>&#34;$baseLocation\scrum\WorkItem Tracking\Process\ProcessConfiguration.xml&#34;</span></code></pre></td></tr></table></div></div><p>The script is really simple, it just define location of the Project Collection and the name of the Team Project, then enumerate all Work Item Definition and call Witadmin importwitd for every definition, then it imports also categories and process config.</p><p>To test the process <strong>I’ve modified definition of Task Work Item, adding another field called Original Estimate</strong> (I know that is really not Scrum like, but many people likes to have this kind of information) and modify the layout of the Work Item to actually show this new Field.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image30.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb30.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb30.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Adding a new Field Definition to store Original Estimate</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image31.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb31.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb31.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Adding the new field in the Ui layout</em></p><p>Then I’ve created a <strong>custom build definition to run powershell uploader script during a Team Project Build</strong>. The script was created simply using the Default.xaml template for Git Project, removing all the compile and test part, leaving only the Clone part and adding a Run Script task. Basically this build does nothing that getting source and running a script. To use a custom script, you can simply commit in git source, push to the server and choose it pressing New in the Process Section of the build.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image35.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb35.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb35.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Change the template used for the build to use your customized process</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image36.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb36.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb36.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>You should simply browse your local repository and choose the file after you’ve pushed it to the server</em></p><p>Now you should be sure that the account used to run the build server has enough right to customize a process template, or you will get an error</p><p><em>TF237113: You don’t have enough permissions to complete the import operation.</em></p><p>during the build. To accomplish this you should open TFS Administration console, choose the Project Collection that contains your project and be sure that the account you are using or the Right Group has the Manage Process Template right</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image37.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb37.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb37.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Give Manage Process Template Rights to the right group or to the user that runs the build agent</em></p><p>Now everything you need to do is configuring a build, choose the Script to run and the game is done, just push modification to the server and the Process Template will be automatically uploaded for you.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image38.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb38.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb38.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Final configuration of the process.</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image39.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb39.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb39.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Full log of the build, output of witadmin importwitd are visible into the log.</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image32.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb32.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb32.png alt=image></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Once the build is complete Process Template is automatically updated</em></p><p>The advantage of using Git as source control comes in hand when it is time to manage updating production Team Projects. In this scenario the PtCustomization Team Project has the main purpose to testing Process Template customization and is not used for anything else than managing this customization. Thanks to the continuous integration each push will upgrade the Template to immediately being able to test new customization, but at a certain point you should start to manage <strong>deploying those customization to real production Team Projects</strong>.</p><p>Thanks to git builds this process is really simple, suppose you have a <strong>Team Project called ProductionProjectA and you want to apply the new modified process to it</strong>. The first step is creating a Branch of the customization you’ve done.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image40.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb40.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb40.png alt=image></a></a></p><p><em><strong>Figure 9</strong></em>: <em>Create a branch of the PtCustomization repository, and give it the same name of the Team Project you want to upgrade</em></p><p>Then you switch to that branch and edit the powershell script <strong>changing the name of the Team Project that will be updated</strong>. Then commit and push everything to the server.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image41.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb41.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb41.png alt=image></a></a></p><p><em><strong>Figure 10</strong></em>: <em>Change the powershell script of the branch to point to the Team Project you want to upgrade</em></p><p>Finally change the build definition to <strong>monitor the new branch for continuous integration</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image42.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb42.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb42.png alt=image></a></a></p><p><em><strong>Figure 11</strong></em>: <em>Configure the build so it will trigger an automatic build whenever there is a push on master or ProductionProjectA branch</em></p><p>Now if you issue another push into the ProductionProjectA branch, the process template of corresponding Team Project will be upgraded atuomatically. This is a great way to proceed, because <strong>you can try customization on Master branch, and once the customization is stable, you can automatically updates other Team Project doing a simple merge and push of the modification to the corresponding branch</strong>.</p><p>In this example I’ve created a new branch to manage updating of a single Team Project, but noone prevents you to change the script to run for multiple Team Projects. You can create a branch called Production, and change the script to upgrade all of your production Team Project. In this scenario whenever you will push into the Production branch multiple Team Project will be updated.</p><p><em>You can finally use TFS API to enumerate Team Projects of an entire collection, and you can create a branch of the customization for each Project Collection, so whenever you push on it, all Team Project of an entire Project Collection will be updated. This scenario is much more risky, because you should be sure that all Team Project of the collection are using the same base template.</em></p><p><em><a href="https://skydrive.live.com/redir?resid=288FBF38C031D5F3!48009&authkey=!AL1jftSelC_jbfI"><strong>You can download Powershell script and the customized build here.</strong></a></em></p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/process-template/>Process Template</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2013/07/aggregate-completed-and-estimated-work-in-team-foundation-server-user-stories-using-excel/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Aggregate Completed and Estimated Work in Team Foundation Server User Stories using Excel</a></div><div class="next-entry sep-before"><a href=/post/old/2013/07/converting-a-visual-studio-plugin-from-2012-to-2013/><span class=screen-reader-text>Next post: </span>Converting a Visual Studio plugin from 2012 to 2013<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>