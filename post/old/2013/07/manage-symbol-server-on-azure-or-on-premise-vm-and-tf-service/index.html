<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="One of the coolest capabilities of Team Foundation Server Build is the ability to automatically manage a symbol server. Suppose this scenario: you have a library and you want to distribute to all people in your organization, with the ability to being able to debug code in the dll and to identify the code that build each version of this dll. If you have TF Service you can use a VM in azure, but the overall process is really similar if you want to have a build on-premise."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Manage Symbol server on Azure or on-premise VM and TF Service • Codewrecks"><meta property="og:description" content="One of the coolest capabilities of Team Foundation Server Build is the ability to automatically manage a symbol server. Suppose this scenario: you have a library and you want to distribute to all people in your organization, with the ability to being able to debug code in the dll and to identify the code that build each version of this dll. If you have TF Service you can use a VM in azure, but the overall process is really similar if you want to have a build on-premise."><meta property="og:url" content="https://www.codewrecks.com/post/old/2013/07/manage-symbol-server-on-azure-or-on-premise-vm-and-tf-service/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="TF Service"><meta property="article:published_time" content="2013-07-04T05:00:37+02:00"><meta property="article:modified_time" content="2013-07-04T05:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Manage Symbol server on Azure or on-premise VM and TF Service • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2013/07/manage-symbol-server-on-azure-or-on-premise-vm-and-tf-service/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Manage Symbol server on Azure or on-premise VM and TF Service</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Manage Symbol server on Azure or on-premise VM and TF Service</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2013-07-04T05:00:37+02:00>2013, Jul 04</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>6 mins read</span></div></div></header><div class="container entry-content"><p>One of the coolest capabilities of <strong>Team Foundation Server Build is the ability to automatically manage a</strong> <a href=http://www.edsquared.com/2011/02/12/Source+Server+And+Symbol+Server+Support+In+TFS+2010.aspx><strong>symbol server</strong>.</a> Suppose this scenario: you have a library and you want to distribute to all people in your organization, with the ability to being able to debug code in the dll and to identify the code that build each version of this dll. If you have TF Service you can use a VM in azure, but the overall process is really similar if you want to have a build on-premise.</p><ul><li>Enable the File and storage service Server Role (to enable sharing)</li><li>Enable the Web server role</li><li>Install Team Foundation Server express Update 3</li></ul><p>Once everything is in place you can simply <strong>create a local folder and share in read / write</strong> , my machine is called TfsSymbolServer so the folder will be <a href>\tfssymbolserver\symbols</a></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image3.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb3.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb3.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Share a folder in Read / write mode</em></p><p>Now you should simply <a href=http://www.codewrecks.com/blog/index.php/2012/04/02/installing-on-premise-component-against-tfs-service-tfs-on-azure/>configure Team Foundation Server express build server</a> to connect to your TF Service account. The express version is free and you can install on your VM with few clicks. The necessary steps are identical if you are installing the Build Server on-premise.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image4.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb4.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb4.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Build controller and agent correctly configured for my TF Service account</em></p><p>Now you should <strong>create a TFS Build to release your library and automatically publish symbols on previous network share</strong>. In the Build Defaults choose your new Build Controller you’ve installed in the VM and ask to copy the Build Output to the server</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image5.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb5.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb5.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Configure the build defaults</em></p><p>In the Build Process you can now simply choose the item you want to publish (with all desired configurations), and <strong>choose to index sources, specifying the network share you created in the Virtual Machine</strong>. That network share is not visible outside that VM, but since the build controller and the share are on the same machine, you will have no problem during the build. Even if the machine is on azure and it is not connected to any VPN, the build will succeed because the publish symbol share is local.</p><p><em>If everything is on-premise, you can clearly use any network share that is visible from the machine with the Build Agents</em>.</p><p>Another interesting aspect of the build, is the use of a <strong>different build process template used to version assembly and taken from the</strong> <a href=http://tfsversioning.codeplex.com/><strong>TFS Versioning library on codeplex</strong></a>. That build process is used to give to the assemblies a unique FileAssemblyVersion, where you usually specify Major and Minor, and the template will add the date as julian and the incremental number of the build. You have plenty of documentation if you download from the project site [<a href=http://tfsversioning.codeplex.com/>http://tfsversioning.codeplex.com/</a>]</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image6.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb6.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb6.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Build process, index the source and use TfsVersioning to version assemblies</em></p><p>Now that everything is in place you can fire a build an verify in the Virtual Machine that the Symbols directory have symbols file in it.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb7.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Symbols files are correctly published in the local share</em></p><p><strong>If the VM with the Build Agent is on-premise, you have nothing to do</strong> , because people will have access to the same network share used by the build Agent, but if the VM is on Azure, people are not able to see network share.</p><p>To share symbols with the team, the simplest solution is creating a site in IIS that points to symbols directory ** ** and enable the directory browsing. An alternative approach is creating a Vpn from the Azure VM and your local directory, but <strong>IIS is simpler to setup and to manage and it is my preferred solution</strong>.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb8.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Symbol server is now publishing the symbol directory to the web with IIS</em></p><p>I’ve chosen port 27000 to bind the site, <strong>so I needed to both open the local firewall in Windows Server and adding an endpoint in the Virtual Machine Endpoints from the Azure Web Portal</strong>. You should now verify that you are able to connect to that site from your local machines of your organization</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb9.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Symbol server is now exposed in Http</em></p><p>Now you can simply configure Visual Studio to access that symbol server and to enable symbol server support during debugging.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb10.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb10.png alt=image></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Your symbol server is now configured in Visual Studio</em></p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image11.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb11.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb11.png alt=image></a></a></p><p><em><strong>Figure 9</strong></em>: <em>General configuration for the Debugging in Visual Studio to enable source server support</em></p><p>Now you can simply tell to all members of your teams, interested in using this library, that it is published through standard TFS Builds. You can give to people the address of the Drop Location (it is a zip stored in Azure Blob) for stable builds and this is everything you need to do to distribute your Dll. <strong>You can put in place more complex scenario, Es distributing with Nuget or in Source Control,</strong> but the important aspect is that the dll has a specific number that identifies it, and it has symbol server support.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image12.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb12.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb12.png alt=image></a></a></p><p><em><strong>Figure 10</strong></em>: <em>People can download the library as a zip directly from the build.</em></p><p>The technique used to distribute the Dll is not important, what is important is that, * <strong>once you create a project and reference that dll, you are able to drill down with F11 in the methods of the dll, and Visual Studio will connect to the Symbol Server, check the version of the file, and will download the correct version directly from TFS</strong> *.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb13.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb13.png alt=image></a></a></p><p><em><strong>Figure 11</strong></em>: <em>When you press F11 Visual Studio correctly download the correct version from TFS</em></p><p>If you look at the complete file location of <strong>Figure 11</strong> , you can notice the number 1046 preceding file name. If you wonder what it means, it is the changeset id of the version of the file that was included in the dll you are using.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image14.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb14.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb14.png alt=image></a></a></p><p><em><strong>Figure 12</strong></em>: <em>MyLogLibrary.cs latest modification was done in Changeset 1046</em></p><p>This means that Visual Studio not only downloads automatically the file from TFS to enable debugging the library, but <strong>it always grab the exact version used to compile the dll</strong>.</p><p>Thanks to TFS Versioning tool you are also able to tell the exact version of the dll you are using, and you can find the build used to create that dll.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image15.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb15.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/07/image_thumb15.png alt=image></a></a></p><p><em><strong>Figure 13</strong></em>: <em>File Version Number helps you identify date and build number used to produce the dll</em></p><p>Symbol server is not useful only to distribute library; you should always use, especially to create binaries that will get distributed and installed, because thanks of the source server support you will be able to debug them or to effectively use Intellitrace in production.</p><p>Remember also <strong>not to delete builds associated to published dll, or to choose not to delete information from Symbol Server</strong>.</p><p>If you are not using Symbol Server to distribute your software you are losing a big piece of TFS.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/tf-service/>TF Service</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2013/07/tfsrestore-exe-database-restored-with-strange-suffix/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>TFSRestoreexe database restored with strange suffix</a></div><div class="next-entry sep-before"><a href=/post/old/2013/07/deploying-on-azure-web-sites-from-on-premise-tfs/><span class=screen-reader-text>Next post: </span>Deploying on Azure Web sites from on-premise TFS<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>