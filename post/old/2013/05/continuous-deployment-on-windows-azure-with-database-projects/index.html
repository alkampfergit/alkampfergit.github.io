<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I’ve already blogged about Deploying on Azure Web Site with Database Project in the past, but in that article I showed how to accomplish it with customization of the Build Template. That technique is useful because quite often you need to run custom scripts or tools to do additional deploy related procedures to the site , but if your need is simply deploying schema change to an Azure Database with a Database Project you can accomplish it even without the need to touch the Build Workflow."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Continuous Deployment on Windows Azure with Database projects • Codewrecks"><meta property="og:description" content="I’ve already blogged about Deploying on Azure Web Site with Database Project in the past, but in that article I showed how to accomplish it with customization of the Build Template. That technique is useful because quite often you need to run custom scripts or tools to do additional deploy related procedures to the site , but if your need is simply deploying schema change to an Azure Database with a Database Project you can accomplish it even without the need to touch the Build Workflow."><meta property="og:url" content="https://www.codewrecks.com/post/old/2013/05/continuous-deployment-on-windows-azure-with-database-projects/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Azure"><meta property="article:tag" content="Continuous Deployment"><meta property="article:published_time" content="2013-05-22T06:00:37+02:00"><meta property="article:modified_time" content="2013-05-22T06:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Continuous Deployment on Windows Azure with Database projects • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2013/05/continuous-deployment-on-windows-azure-with-database-projects/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Continuous Deployment on Windows Azure with Database projects</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Continuous Deployment on Windows Azure with Database projects</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2013-05-22T06:00:37+02:00>2013, May 22</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>3 mins read</span></div></div></header><div class="container entry-content"><p>I’ve already blogged about <a href=http://www.codewrecks.com/blog/index.php/2013/03/15/tf-service-deploy-on-azure-web-site-with-database-project/>Deploying on Azure Web Site with Database Project</a> in the past, but in that article I showed how to accomplish it with customization of the Build Template. That technique is useful because quite often you need to <strong>run custom scripts or tools to do additional deploy related procedures to the site</strong> , but <em>if your need is simply deploying schema change to an Azure Database with a Database Project you can accomplish it even without the need to touch the Build Workflow</em>.</p><p>First of all download the publishing profile from your azure site.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image3.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb3.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb3.png alt=image></a></a></p><p><em><strong>Figure 1</strong></em>: <em>Download publishing profile from Azure Web Site</em></p><p>Once you have publishing profile, <strong>it can be imported in Visual Studio</strong> , just Right-Click on Project node inside Visual Studio and choose Publish. From there you can import publishing profile just downloaded and modify it for your need.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image4.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb4.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb4.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Importing publishing profile from Visual Studio</em></p><p>From the settings tab you have the option to specify a.dacpac file to update database schema.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image5.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb5.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb5.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Use a.dacpac to deploy database schema changes</em></p><p>Unfortunately this configuration is good from direct publishing with Visual Studio, but to make it works during a TFS Build you need to do some manual modification. Once the modified publishing file is changed, you can find it inside Properties/PublishProfiles node of your project, and you can edit it with a simple XML Editor.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image6.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb6.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb6.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>Modify the location of the dacpac to match the location this file will have during TFS build</em></p><p>The trick here is <strong>modifying the path of the.dacpac file to match its location in the build server during the build</strong>. Knowing the location is quite simple, usually I map an entire branch (trunk, main or some release branch) as root dir for the build</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image7.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb7.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb7.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Workspace configuration of Deploy build</em></p><p>Now I need to examine the structure of project folders, suppose the trunk has a sub-folder called TailspinToys that contains my web site project I want to deploy (called Tailspin.WebUpgraded).</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb8.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Folder structure of my project</em></p><p>When the build takes place, <strong>all build output (including all.dacpac files) are stored in a folder called bin that is one level above the folder you mapped in the build workspace</strong>. To locate the build file during publish, I need to go three folder up to locate the parent of the trunk (my project is in Trunk\TailspinToys\Tailspin.WebUpgraded) then adding bin and the name of the.dacpac file. So the location of dacpac file is......\bin\xxxxx.dacpac as you can see in <strong>Figure 4.</strong> Do not worry if it seems complicated, it is just a matter of a couple of tentative to find the root folder ;).</p><p>Once the publish file was modified and checked-in you can use it in your build definition.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2013/05/image_thumb9.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>Choose your new publish file as a publishing profile for the build.</em></p><p>Now you can run the build and database linked to the Web Site will be automatically updated with the definition of your Database Project.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/visual-studio-alm/>Visual Studio ALM</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/azure/>Azure</a>, <a class=tag href=/tags/continuous-deployment/>Continuous Deployment</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2013/05/visual-studio-alm-links-week-20/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Visual Studio ALM Links Week 20</a></div><div class="next-entry sep-before"><a href=/post/old/2013/05/visual-studio-alm-links-week-21/><span class=screen-reader-text>Next post: </span>Visual Studio ALM Links Week 21<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>