<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="If you heavily work with branches, one of the most frustrating error you can do is modify the wrong branch. I have a project composed by several solution each one containing different UI Projects, each one using WCF as back end but released as separate software. Whenever we do a release of a new version of one of the UI we create a branch, so we can support hotfix, SP, etc."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="Visual studio Macro to the rescue • Codewrecks"><meta property="og:description" content="If you heavily work with branches, one of the most frustrating error you can do is modify the wrong branch. I have a project composed by several solution each one containing different UI Projects, each one using WCF as back end but released as separate software. Whenever we do a release of a new version of one of the UI we create a branch, so we can support hotfix, SP, etc."><meta property="og:url" content="https://www.codewrecks.com/post/old/2011/04/visual-studio-macro-to-the-rescue/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Addin"><meta property="article:tag" content="Macro"><meta property="article:tag" content="Visual Studio"><meta property="article:published_time" content="2011-04-07T13:00:37+02:00"><meta property="article:modified_time" content="2011-04-07T13:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>Visual studio Macro to the rescue • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2011/04/visual-studio-macro-to-the-rescue/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>Visual studio Macro to the rescue</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>Visual studio Macro to the rescue</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2011-04-07T13:00:37+02:00>2011, Apr 07</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p>If you heavily work with branches, one of the most frustrating error you can do is modify the wrong branch. I have a project composed by several solution each one containing different UI Projects, each one using WCF as back end but released as separate software. Whenever we do a release of a new version of one of the UI we create a branch, so we can support hotfix, SP, etc.</p><p><a target=_blank href=http://farm2.static.flickr.com/1088/3169788471_e372d6b617.jpg><img src=http://farm2.static.flickr.com/1088/3169788471_e372d6b617.jpg alt></a></p><p><em><strong>Figure 1</strong></em>: <em>A branching strategy taken from the <a href=http://tfsbranchingguideiii.codeplex.com/>branchingguidance</a></em></p><p>With this scenario I&rsquo;m prone to this error:</p><p>Someone call me telling to create an hotfix for the UI XYZ, I open the solution from Branch\Releases\XYZ\R3_0 to open the third (is the latest) release of the XYZ UI, I do the hotfix, test it, run all the test etc etc, then other people of the team call me asking for modification in other part, so I open the same solution from a different branch (say the trunk or the Feature BLABLA) and do some modification. Now I have two Visual Studio opened, with the very same solution, sometimes I got confused and I modify the wrong line of code&mldr; too bad, because this can cause a really bad problem. The problem arise from having more than one instance of Visual Studio opened with solutions of same name, just from different branch <a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/wlEmoticon-sadsmile.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/wlEmoticon-sadsmile.png alt="Sad smile"></a> and you can become confused.</p><p><a target=_blank href=http://www.whimsys-menagerie.com/17066-Orange-Man-Carrying-A-Large-Yellow-Question-Mark-Over-His-Shoulder-Symbolizing-Curiousity-Uncertainty-Or-Confusion-Clipart-Illustration.jpg><img src=http://www.whimsys-menagerie.com/17066-Orange-Man-Carrying-A-Large-Yellow-Question-Mark-Over-His-Shoulder-Symbolizing-Curiousity-Uncertainty-Or-Confusion-Clipart-Illustration.jpg alt></a></p><p>This is expecially true when you use HG or subversion or any other VCS tools that are not integrated in Visual Studio.</p><p>A simple solution is creating a <a href=http://www.helixoft.com/blog/archives/32>Visual Studio Macro</a> that uses a Regex to parse the fullpath of the solution file, searching for a specific folder structure that identify a Branch. Here is the full code</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp>Declare Auto Function SetWindowText Lib <span style=color:#e6db74>&#34;user32&#34;</span> (ByVal hWnd As System.IntPtr, _
ByVal lpstring As String) As Boolean
 
 
Private Sub showTitle(ByVal title As String)
SetWindowText(New System.IntPtr(DTE.MainWindow.HWnd), title &amp; <span style=color:#e6db74>&#34; - &#34;</span> &amp; DTE.Name)
End Sub
 
 
Private Sub SolutionEvents_Opened() Handles SolutionEvents.Opened
Dim m As Match = Regex.Match( _
DTE.Solution.FullName, _
<span style=color:#e6db74>&#34;Branch.*\\(?&lt;project&gt;.*)\\(?&lt;branch&gt;.*)\\(?&lt;sln&gt;.*)\.sln&#34;</span>, _
RegexOptions.IgnoreCase)
If (m.Success) Then
Dim project As String = m.Groups(<span style=color:#e6db74>&#34;project&#34;</span>).Value
Dim version As String = m.Groups(<span style=color:#e6db74>&#34;branch&#34;</span>).Value
Dim sln As String = m.Groups(<span style=color:#e6db74>&#34;sln&#34;</span>).Value
showTitle(String.Format(<span style=color:#e6db74>&#34;BRANCH [{0}] - Project {1} - {2}&#34;</span>, _
version, project, sln))
 
End If
End Sub
</code></pre></td></tr></table></div></div><p>You need to paste this code in the Macros editor, opened from Tools –> Macros –> Macros IDE</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML1889083.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML1889083_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML1889083_thumb.png alt=SNAGHTML1889083></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Open the Macro editor</em></p><p>From the opened editor you just double click on MyMacros, expand the EnvironmentEvents, and you can add your code to every handler supported from Visual Studio.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML18c25a1.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML18c25a1_thumb.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/SNAGHTML18c25a1_thumb.png alt=SNAGHTML18c25a1></a></a></p><p><em><strong>Figure 3</strong></em>: <em>You can handle standard events from the IDE, such as when a solution is opened.</em></p><p>If you look at the code, I&rsquo;ve simply put a regex that permits me to parse the typical branch path structure I have on my projects, where I have Branch\someothertext\nameoftheproject\branchnumber\solutionfile.sln. When I open the trunk version I got only the solution name on the title bar.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image1.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb1.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb1.png alt=image></a></a></p><p><strong>Figure 4</strong> : <em>the solution is opened from the trunk (main) because only the name of the solution is shown in title bar</em></p><p>I&rsquo;ve opened the same solution from a release of a specific UI and I got</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image2.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb2.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb2.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>The same solution is opened from a branch folder, now title bar shows me that I&rsquo;m working on branch</em></p><p>I immediately visualize that this solution is a branch, the version number is R3_0 (Release three point zero), the project released is ZZZZManager that resides on the XXXXXWeb-Vs2010 solution ;) now it is really difficult for me and other people to write code on a wrong branch, because all the informations I need are on the title bar.</p><p>Using title of the windows gives also the exceptional advantage of having these information in Windows 7 tray bar</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image3.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb3.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb3.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Using the title bar, I got the very same information when I need to maximize a windows from Windows 7 tray bar</em></p><p>So you can immediately know witch is the right windows to use. Moreover developing such a macro is a matter of minutes, because you can simply add the handler and some code inside the macro editor, Then save the macro, close and reopen visual studio, open again the macro editor and activate the debugger</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image4.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb4.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/04/image_thumb4.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>I can even debug the macro, an invaluable option when you are experimenting on your code.</em></p><p>Now you can put breakpoint around the code, and debugging your macro to tune it.</p><p>Alk.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/visual-studio/>Visual Studio</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/addin/>Addin</a>, <a class=tag href=/tags/macro/>Macro</a>, <a class=tag href=/tags/visual-studio/>Visual Studio</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2011/04/unable-to-open-word-or-excel-document-from-sky-drive/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Unable to open word or excel document from sky Drive</a></div><div class="next-entry sep-before"><a href=/post/old/2011/04/use-a-webbrowser-to-login-into-a-site-that-use-httponly-cookie/><span class=screen-reader-text>Next post: </span>Use a WebBrowser to login into a site that use HttpOnly cookie<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>