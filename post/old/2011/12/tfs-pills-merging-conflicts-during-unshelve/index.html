<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Shelvesets are a really useful concept in TFS, and you should be aware that thanks to Power Tools you can even do a Merge during an Unshelve in case of conflicts. As an example suppose this simple and stupid scenario, you have this code.

Figure 1 * : Original Code*
Now lets generate a conflict with Shelveset; simply typing some text.

Figure 2: Modified code, insertion of a simple comment."><meta name=theme-color content="#ffcd00"><meta property="og:title" content="TFS Pills merging conflicts during unshelve • Codewrecks"><meta property="og:description" content="Shelvesets are a really useful concept in TFS, and you should be aware that thanks to Power Tools you can even do a Merge during an Unshelve in case of conflicts. As an example suppose this simple and stupid scenario, you have this code.

Figure 1 * : Original Code*
Now lets generate a conflict with Shelveset; simply typing some text.

Figure 2: Modified code, insertion of a simple comment."><meta property="og:url" content="https://www.codewrecks.com/post/old/2011/12/tfs-pills-merging-conflicts-during-unshelve/"><meta property="og:site_name" content="Codewrecks"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:tag" content="Power Tools"><meta property="article:tag" content="Team Foundation Server"><meta property="article:published_time" content="2011-12-02T15:00:37+02:00"><meta property="article:modified_time" content="2011-12-02T15:00:37+02:00"><meta name=twitter:card content="summary"><meta name=generator content="Hugo 0.74.3"><title>TFS Pills merging conflicts during unshelve • Codewrecks</title><link rel=canonical href=https://www.codewrecks.com/post/old/2011/12/tfs-pills-merging-conflicts-during-unshelve/><link rel=icon href=/favicon.ico><link rel=stylesheet href=/assets/css/main.ab98e12b.css><style>:root{--color-accent:#ffcd00}</style><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-1773115-4','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script src=https://www.codewrecks.com/js/jquery-eu-cookie-law-popup.js></script><link rel=stylesheet href=https://www.codewrecks.com/css/jquery-eu-cookie-law-popup.css></head><body class="page type-post"><div class=site><a class=screen-reader-text href=#content>Skip to Content</a><div class=main><nav id=main-menu class="menu main-menu" aria-label="Main Menu"><div class=container><ul><li class=item><a href=/>Home</a></li><li class=item><a href=/categories/>Categories</a></li><li class=item><a href=/about/>About</a></li><li class=item><a href=/privacy/>Privacy</a></li></ul></div></nav><div class=header-widgets><div class=container><style>.widget-breadcrumbs li:after{content:'\2f '}</style><section class="widget widget-breadcrumbs sep-after"><nav id=breadcrumbs><ol><li><a href=/>Home</a></li><li><a href=/post/>Posts</a></li><li><span>TFS Pills merging conflicts during unshelve</span></li></ol></nav></section></div></div><header id=header class="header site-header"><div class="container sep-after"><div class=header-info><p class="site-title title">Codewrecks</p><p class="desc site-desc">Wrecks of code floating in the sea of internet</p></div></div></header><main id=content><article lang=en class=entry><header class="header entry-header"><div class="container sep-after"><div class=header-info><h1 class=title>TFS Pills merging conflicts during unshelve</h1></div><div class=entry-meta><span class=posted-on><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><span class=screen-reader-text>Posted on</span>
<time class=entry-date datetime=2011-12-02T15:00:37+02:00>2011, Dec 02</time></span>
<span class=reading-time><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 15 15"/></svg>4 mins read</span></div></div></header><div class="container entry-content"><p>Shelvesets are a really useful concept in TFS, and you should be aware that thanks to Power Tools you can even do a Merge during an Unshelve in case of conflicts. As an example suppose this simple and stupid scenario, you have this code.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image8.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb8.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb8.png alt=image></a></a></p><p><strong>Figure 1</strong> * <strong>:</strong> Original Code*</p><p>Now lets generate a conflict with Shelveset; simply typing some text.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image9.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb9.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb9.png alt=image></a></a></p><p><em><strong>Figure 2</strong></em>: <em>Modified code, insertion of a simple comment.</em></p><p>I’ve simply typed some comment into the class, now Shelve the file without preserving pending changes, the file reverts to the code in Figure 1, now modify again the comment of the class as shown in Figure 3       <br><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image10.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb10.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb10.png alt=image></a></a></p><p><em><strong>Figure 3</strong></em>: <em>Another modification done to the class, this modification conflicts with the version in Figure 2.</em></p><p>Now check-in and commit this code (this simulates the situation when you need to suspend with shelve the work you are doing to accomplish higher priority task), then unshelve the previous shelveset, as you can verify the code revert to that one shown in Figure 2, and you lose the modification of the last check-in. This happens because the unshelve operation does not trigger a merge in case of conflicts. If you looks at the output windows you should find a message telling you that a newer version exists in source control as shown in Figure 4</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image11.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb11.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb11.png alt=image></a></a></p><p><em><strong>Figure 4</strong></em>: <em>A warning by the source control, a newer version of the file exists.</em></p><p>Now you should simply reissue a Get Latest command and TFS will present you a list of all conflicts that originates from the unshelving operation.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image12.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb12.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb12.png alt=image></a></a></p><p><em><strong>Figure 5</strong></em>: <em>Issuing a Get Latest will trigger the conflict windows that shows each file that conflicted after the unshelve operation.</em></p><p>This is a situation where you have a simple conflict when a file that got in the shelveset was modified and checked-in after the shelve operation, you can merge with the tool of choiche, accept both the comment and check-in, to proceed to the next example. The situation of the file is now represented in Figure 6 and this is the starting point of another example of merging shelvesets when a conflict happen between two users</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image13.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb13.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb13.png alt=image></a></a></p><p><em><strong>Figure 6</strong></em>: <em>Both comment where accepted during the merge.</em></p><p>Another type of conflict arise from unshelving conflicting code from another developer. Suppose Dev A and Dev B start both from the code in figure 6, Dev A types a third line of comment telling “<em>third comment line</em>” <strong>and shelve the code</strong>. At the very same time Dev B <strong>does a conflicting modification</strong> , typing a third line of code that states “<em>conflicting third comment line</em>” and after this modification, she receives a call from Dev A that asks to review his shelveset. If Dev B try to unshelve the shelveset from Dev A she got the error in Figure 7</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image14.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb14.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb14.png alt=image></a></a></p><p><em><strong>Figure 7</strong></em>: <em>It is not possible to unshelve because of conflicts.</em></p><p>This happens because the standard unshelve operation does not permits to handle conflicts, if Visual Studio unshelve a conflicting file from Dev A, all the modification pending from Dev B will be lost. This is an annoying situation that you can solve with Power Tools.</p><p>If Dev B want to merge the code in the shelve of Dev A with her current code, she should open a Visual Studio Command prompt, move to the workspace where the project resides, then issue a * <strong>tfpt.exe unshelve</strong> *command directly from command line. The command line utility will open the same UI to unshelve that you got in Visual Studio, but now, when she browse to the shelvesets of Dev A and try to unshelve, she got a nice windows that shows all conflicts.</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image15.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb15.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb15.png alt=image></a></a></p><p><em><strong>Figure 8</strong></em>: <em>Tfpt.exe unshelve presents you a list of all conflicts that occurred during the unshelve operation</em></p><p>Now you can try automerge, and if it fails, you can press the “Resolve” button (or you can directly go for the “resolve” button without try automerge if you do not like to automerge conflicts :)</p><p><a href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image16.png><a target=_blank href=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb16.png><img src=https://www.codewrecks.com/blog/wp-content/uploads/2011/11/image_thumb16.png alt=image></a></a></p><p><strong>Figure 9</strong> <em>: Resolve conflict during unshelve.</em></p><p>In Figure 9 you can see how to ask for a manual merge. Pressing OK Will open the standard tool for merging, you can now do a manual merge and save the result of the merging. Taaadaaaa, thanks to Power Tools you are able to unshelve conflicting shelvesets made by other developers.</p><p>Now what happens if Dev B want to revert to the original code she has before merging with the shelveset of Dev A? No problem, because the tfpt.exe unshelve command had created a backup shelveset with all the pending changes just before the merging operation, so if you want to dischard all the modification and revert to the same code that you have prior of the unshelve operation, you can issue another tfpt.exe unshelve operation, choose the backup shelveset (it has the same name of the unshelved shelveset with the string _backup appended), and when the Resolve Unshelve Conflict windows appears (Figure 9) you can simply choose to undo my local changes and take the shelved changes, and you are done.</p><p>Happy shelving.</p><p>Gian Maria.</p></div><footer class=entry-footer><div class="container sep-before"><div class=categories><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5A2 2 0 014 3H9l2 3h9a2 2 0 012 2z"/></svg><span class=screen-reader-text>Categories: </span><a class=category href=/categories/team-foundation-server/>Team Foundation Server</a></div><div class=tags><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2H12l8.59 8.59A2 2 0 0120.59 13.41z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=screen-reader-text>Tags: </span><a class=tag href=/tags/power-tools/>Power Tools</a>, <a class=tag href=/tags/team-foundation-server/>Team Foundation Server</a></div></div></footer></article><nav class=entry-nav><div class=container><div class="prev-entry sep-before">Leave comment in GitHub discussion page<a target=_blank href=https://github.com/alkampfergit/personal-blog/discussions> alkampfergit/personal-blog/discussions</a></div><div class="prev-entry sep-before"><a href=/post/old/2011/12/custom-xml-serialization/><span aria-hidden=true><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="20" y1="12" x2="4" y2="12"/><polyline points="10 18 4 12 10 6"/></svg>Previous</span>
<span class=screen-reader-text>Previous post: </span>Custom XML Serialization</a></div><div class="next-entry sep-before"><a href=/post/old/2011/12/team-foundation-service-december-update/><span class=screen-reader-text>Next post: </span>Team Foundation Service december update<span aria-hidden=true>Next<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><line x1="4" y1="12" x2="20" y2="12"/><polyline points="14 6 20 12 14 18"/></svg></span></a></div></div></nav></main><footer id=footer class=footer><div class="container sep-before"><section class="widget widget-social_menu sep-after"><nav aria-label="Social Menu"><ul><li><a href=https://github.com/alkampfergit target=_blank rel=noopener><span class=screen-reader-text>Open Github account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href=https://twitter.com/alkampfer target=_blank rel=noopener><span class=screen-reader-text>Open Twitter account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><title>Twitter icon</title><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></a></li><li><a href=mailto:alkampfer@nablasoft.com target=_blank rel=noopener><span class=screen-reader-text>Contact via Email</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a></li><li><a href=https://linkedin.com/in/gianmariaricci target=_blank rel=noopener><span class=screen-reader-text>Open Linkedin account in new tab</span><svg class="icon" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" aria-hidden="true"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></a></li></ul></nav></section><div class=copyright><p>&copy; 2020-2022 Ricci Gian Maria</p></div></div></footer></div></div><script>window.__assets_js_src="/assets/js/"</script><script src=/assets/js/main.c3bcf2df.js></script><script>console.log("this is cookie law");$(document).euCookieLawPopup().init({cookiePolicyUrl:'/privacy/',popupPosition:'top',colorStyle:'default',compactStyle:false,popupTitle:'This website is using cookies',popupText:'By continuing I assume your permission to deploy cookies, as detailed in the Privacy &amp; Cookies Policy.',buttonContinueTitle:'Continue',buttonLearnmoreTitle:'Learn more about this site Privacy &amp; Cookies Policy',buttonLearnmoreOpenInNewWindow:true,agreementExpiresInDays:30,autoAcceptCookiePolicy:false,htmlMarkup:null});</script></body></html>