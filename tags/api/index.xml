<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>API on Codewrecks</title><link>https://www.codewrecks.com/tags/api/</link><description>Recent content in API on Codewrecks</description><generator>Hugo</generator><language>en</language><lastBuildDate>Thu, 22 Feb 2024 07:12:42 +0200</lastBuildDate><atom:link href="https://www.codewrecks.com/tags/api/index.xml" rel="self" type="application/rss+xml"/><item><title>Azure Devops Api - Update list of allowed values for Custom Fields</title><link>https://www.codewrecks.com/post/azdo/api/manage-custom-field-with-api/</link><pubDate>Thu, 22 Feb 2024 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/manage-custom-field-with-api/</guid><description>&lt;p>The ability to &lt;strong>customize process of Azure DevOps&lt;/strong> is one of the most powerful feature of the platform. Usually you &lt;strong>add custom fields to work items&lt;/strong> to allow tracking information related to your own process and for your organization. One of the most common question I got usually is:&lt;/p>
&lt;blockquote>
&lt;p>How can I create a field that allows for a series of values that is taken from a database of mine?&lt;/p></description></item><item><title>Azure Devops Api - Automatically Re-Queue Pull Request Checks</title><link>https://www.codewrecks.com/post/azdo/api/reschedule-pr-check-with-pipeline/</link><pubDate>Tue, 07 Mar 2023 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/reschedule-pr-check-with-pipeline/</guid><description>&lt;p>In previous post on this subject &lt;a href="https://www.codewrecks.com/post/azdo/api/reschedule-pr-check-with-api/">Reschedule PR Check with API&lt;/a> I&amp;rsquo;ve demonstrated &lt;strong>a simple PowerShell api script that can automatically re-queue all checks for Opened pull Requests where the check is expired&lt;/strong>. The problem is: you need to schedule this script to run.&lt;/p>
&lt;p>Actually the easiest way to schedule running a script that uses API is &lt;strong>using a standard pipeline. Give the ability to run whenever the target branch changes it is the best choice.&lt;/strong> Since develop is my usual target branch for Pull request I left a CI trigger for changes in develop branch as well as some scheduled run (to include other non usual target branches).&lt;/p></description></item><item><title>Azure Devops Api - Re-Queue Pull Request Checks</title><link>https://www.codewrecks.com/post/azdo/api/reschedule-pr-check-with-api/</link><pubDate>Tue, 21 Feb 2023 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/reschedule-pr-check-with-api/</guid><description>&lt;p>Pull Requests checks are a perfect gate to keep your code quality High. The easiest way to &lt;strong>perform a check is to do something inside a standard pipeline and then use that pipeline in branch policies&lt;/strong>. This will allow you to prevent people to push on the main develop branch (main/master/develop) and be forced to do a pull request against that branch and wait for the checks to complete.&lt;/p>
&lt;blockquote>
&lt;p>Remember that checks on a Pull Request actually runs on the result of the merge between source and target branch.&lt;/p></description></item><item><title>Azure Devops Api - Export Work Items</title><link>https://www.codewrecks.com/post/azdo/api/api-step-2-work-item-dump/</link><pubDate>Sat, 26 Nov 2022 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/api-step-2-work-item-dump/</guid><description>&lt;p>One of the most common scenario where Azure DevOps API shine is &lt;strong>exporting data into some other db/file&lt;/strong>. There can be lots of legitimate reason why you want to export data: Custom Reporting, Custom Analysis, put everything into a file/database to &lt;strong>perform offline query on your data outside Azure DevOps interface&lt;/strong>.&lt;/p>
&lt;p>In previous parts we already saw how to &lt;a href="https://www.codewrecks.com/post/azdo/api/api-step-1-connection/">connect to the server&lt;/a> and how to &lt;a href="https://www.codewrecks.com/post/azdo/api/api-step-1a-connection-check/">check if credentials are ok&lt;/a>; if we want to interact with the various part of the server you need to get an instance of &lt;strong>appropriate client class&lt;/strong>. In sample code, once connection is estabilished, &lt;strong>ConnectionManager class&lt;/strong> is used to obtain an instance of WorkItemTrackingHttpClient class, using &lt;a href="https://learn.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2013/dn228356%28v=vs.120%29">&lt;strong>GetClient&lt;T>()&lt;/strong> method of VssConnection&lt;/a>.&lt;/p></description></item><item><title>Azure Devops Api - Detect if credentials are ok</title><link>https://www.codewrecks.com/post/azdo/api/api-step-1a-connection-check/</link><pubDate>Sat, 19 Nov 2022 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/api-step-1a-connection-check/</guid><description>&lt;p>In previous article of the series I&amp;rsquo;ve &lt;a href="https://www.codewrecks.com/post/azdo/api/api-step-1-connection/">played with Azure DevOps api connection&lt;/a> showing how you can use a &lt;strong>.NET 4.8 full framework application that can login to Azure DevOps with a token or with an interactive login&lt;/strong>.&lt;/p>
&lt;p>When you use interactive login, usually Windows operating system will &lt;strong>retain credentials in credentials store&lt;/strong>, this will avoid asking for credential every time the application is run. The code that perform the check is really simple, it just check if _vssConnection.AuthorizedIdentity.DisplayName is not &amp;ldquo;anynymous&amp;rdquo;. This happens because &lt;strong>the real credential check is done usually when you perform some real query, and not only the connection&lt;/strong>.&lt;/p></description></item><item><title>Azure Devops Api - Connection</title><link>https://www.codewrecks.com/post/azdo/api/api-step-1-connection/</link><pubDate>Sat, 05 Nov 2022 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/api-step-1-connection/</guid><description>&lt;p>Quite often people asks me how to interact programmatically with Azure DevOps server, main purpose &lt;strong>is retrieving data for custom reporting&lt;/strong> but also interacting with Work Item store etc. Luckily enough, all Azure DevOps functionalities are exposed via API, so you can &lt;strong>write small programs to automate mundane tasks&lt;/strong> and obtain what you need.&lt;/p>
&lt;p>In this post I&amp;rsquo;ll show how to setup the project in .NET and how to connect to the server. The example can be found in &lt;a href="https://github.com/alkampfergit/AzureDevopsExportQuickAndDirty">GitHub&lt;/a>.&lt;/p></description></item><item><title>Clone a simple dashboard with API in Azure DevOps</title><link>https://www.codewrecks.com/post/azdo/api/api-clone-dashboard-azure-devops/</link><pubDate>Fri, 11 Feb 2022 07:12:42 +0200</pubDate><guid>https://www.codewrecks.com/post/azdo/api/api-clone-dashboard-azure-devops/</guid><description>&lt;p>If you work in Scrum, being able to visualize data on current and past Sprints is an invaluable way to keep track on team improvement. &lt;strong>Azure DevOps allows you to create Dashboards to visualize interesting metrics&lt;/strong>, but actually you do not have a way to create Dynamic Dashboards, I.E. a Dashboard that allows you to specify a parametric query so you can, for example, change the iteration and view how the data changes.&lt;/p></description></item><item><title>Retrieve Attachment in Azure DevOps with REST API</title><link>https://www.codewrecks.com/post/old/2019/07/retrieve-attachment-in-azure-devops-with-rest-api/</link><pubDate>Thu, 25 Jul 2019 20:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/07/retrieve-attachment-in-azure-devops-with-rest-api/</guid><description>&lt;p>In a previous post I’ve dealt on &lt;a href="http://www.codewrecks.com/blog/index.php/2019/07/10/retrieve-image-in-work-item-description-with-tfs-api/">how to retrieve image in Work Items&lt;/a> description or Comments with a simple WebClient request, using network credentials taken from  &lt;a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2013/ff732550%28v%3Dvs.120%29">TfsTeamProjectCollection&lt;/a> class.&lt;/p>
&lt;p>&lt;a href="http://www.codewrecks.com/blog/index.php/2019/07/10/retrieve-image-in-work-item-description-with-tfs-api/" title="http://www.codewrecks.com/blog/index.php/2019/07/10/retrieve-image-in-work-item-description-with-tfs-api/">The&lt;/a> solution presented in that article is not complete, because it does not works against Azure Devops, but only against a on-premise TFS or Azure DevOps Server &lt;strong>. If you connect to Azure DevOps you will find that the Credentials of the TfsTeamProjectCollection class are null&lt;/strong> , thus you cannot download the attachment because the web request is not authenticated.&lt;/p></description></item><item><title>Export Work Item Information to Word Document</title><link>https://www.codewrecks.com/post/old/2019/07/export-work-item-information-to-word-document/</link><pubDate>Thu, 25 Jul 2019 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/07/export-work-item-information-to-word-document/</guid><description>&lt;p>This is a series of posts on how to export data from Azure DevOps to a Word Document, composing word templates with Open XML Sdk.&lt;/p>
&lt;p>The project is open source and available Here: &lt;a href="https://github.com/alkampfergit/AzureDevopsWordPlayground" title="https://github.com/alkampfergit/AzureDevopsWordPlayground">https://github.com/alkampfergit/AzureDevopsWordPlayground&lt;/a>&lt;/p>
&lt;p>Post in the series:&lt;/p>
&lt;ol>
&lt;li>API &lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-connection/">Connection&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-retrieve-work-items-information/">Retrieve Work Items Information&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/31/azure-devops-api-embed-images-into-html/">Azure DevOps API, Embed images into  HTML&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/31/create-word-document-from-work-items/">Create Word Document For Work Items&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2019/07/10/retrieve-image-in-work-item-description-with-tfs-api/">Retrieve image in Work Item Description with TFS API&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2019/07/25/retrieve-attachment-in-azure-devops-with-rest-api/">Retrieve Attachment in Azure DevOps with REST API in C#&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Gian Maria&lt;/p></description></item><item><title>Retrieve image in Work Item Description with TFS API</title><link>https://www.codewrecks.com/post/old/2019/07/retrieve-image-in-work-item-description-with-tfs-api/</link><pubDate>Wed, 10 Jul 2019 20:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/07/retrieve-image-in-work-item-description-with-tfs-api/</guid><description>&lt;p>When you try to export content of Work Item from Azure DevOps (online or server) you need to deal with &lt;strong>external images that are referenced in HTML fields of Work Item.&lt;/strong> &lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/31/azure-devops-api-embed-images-into-html/">I’ve dealt in the past&lt;/a> on this subject, showing how you can retrieve images with Store and Attachment Work Item Property.&lt;/p>
&lt;p>Sadly enough, I’ve encountered situation with on-premise version of TFS where I found this type of image src inside HTML fields.&lt;/p></description></item><item><title>Create Word document from Work Items</title><link>https://www.codewrecks.com/post/old/2018/12/create-word-document-from-work-items/</link><pubDate>Mon, 31 Dec 2018 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/12/create-word-document-from-work-items/</guid><description>&lt;p>Post in the series:&lt;/p>
&lt;ol>
&lt;li>API &lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-connection/">Connection&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-retrieve-work-items-information/">Retrieve Work Items Information&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/31/azure-devops-api-embed-images-into-html/">Azure DevOps API, Embed images into  HTML&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Now we have all the prerequisites in place to connect to an Azure DevOps account, execute a query to grab all work items of a sprint and modifying HTML of Rich Edit fields to embed images. It is time to create a word document.&lt;/p>
&lt;p>To have a better look and feel of exported document, &lt;strong>the best approach is using the concept of Templates created by simple Word documents&lt;/strong>. With this technique we can use all the styles, formatting directly in Word, then use some placeholder to specify where you want to include fields of work Items.&lt;/p></description></item><item><title>Azure DevOps API Embed images into html</title><link>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-embed-images-into-html/</link><pubDate>Mon, 31 Dec 2018 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-embed-images-into-html/</guid><description>&lt;p>Post in the series:&lt;/p>
&lt;ol>
&lt;li>API &lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-connection/">Connection&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-retrieve-work-items-information/">Retrieve Work Items Information&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Before going to generate a Word File from Work Item Data we need to solve a little problem with HTML content in Work Item fields. As you know Azure DevOps has a rich web editor that allows you to create complex text in some fields, like Description, the problem is: &lt;strong>whenever you copy and paste images inside the Web Editor, those images were added as Work Item attachments and the real HTML content&lt;/strong> &lt;strong>is just a reference to the attachmen Url.&lt;/strong> If you want to generate a consistent Word or export to whatever destination you want, you should manipulate html to embed the image, or the html will be not consistent.&lt;/p></description></item><item><title>Azure DevOps API Retrieve Work Items Information</title><link>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-retrieve-work-items-information/</link><pubDate>Fri, 28 Dec 2018 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-retrieve-work-items-information/</guid><description>&lt;p>Post in the series:&lt;/p>
&lt;ol>
&lt;li>API &lt;a href="http://www.codewrecks.com/blog/index.php/2018/12/28/azure-devops-api-connection/">Connection&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Now that we know how to connect to Azure DevOps services, it is time to &lt;strong>understand how to retrieve information about Work Items&lt;/strong> to accomplish the requested task: export Work Items data inside a Word Document.&lt;/p>
&lt;p>Once you connected to Azure DevOps account you start retrieving helper classes to work with the different functions of the service, &lt;strong>if you need to interact with Work Items  you need a reference to the WorkItemStore class&lt;/strong>. Since this is the most common service I need to interact I simply get a reference in the connection class&lt;/p></description></item><item><title>Azure Devops API Connection</title><link>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-connection/</link><pubDate>Fri, 28 Dec 2018 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/12/azure-devops-api-connection/</guid><description>&lt;p>&lt;strong>One of the great benefit of using Azure DevOps is the ability to interact with the service through API calls,&lt;/strong> making it possible to extend the service with a few bunch of C#, or PowerShell or whatever language you want, because almost everything is exposed with REST API, and a simple HTTP call is enough.&lt;/p>
&lt;p>Since I’m mostly a C# and.NET guy, I’ll explain how to build a C# program that interact with an Azure DevOps account, because thanks to Nuget Packages offered by Microsoft, you can interact with your account with Strongly Typed C# classes, so you can have intellisense and compile type checking to verify that everything is good.&lt;/p></description></item><item><title>Nuget packages for TFS VSO Client Object Model</title><link>https://www.codewrecks.com/post/old/2015/08/nuget-packages-for-tfs-vso-client-object-model/</link><pubDate>Sat, 22 Aug 2015 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/08/nuget-packages-for-tfs-vso-client-object-model/</guid><description>&lt;p>Finally the Client Object Model for TFS / VSO &lt;strong>is finally distributed with Nuget Packages, as you can&lt;/strong> &lt;a href="https://www.visualstudio.com/integrate/get-started/client-libraries/dotnet">&lt;strong>read here&lt;/strong>&lt;/a>. This is a great news especially because the Dll are finally redistributable, and your tool does not need to require a previous installation of Visual Studio or Team Explorer, or Client Object Model Package.&lt;/p>
&lt;p>Another interesting fact, is that &lt;strong>REST API are now supported for TFS 2015 / VSO&lt;/strong> (previous version of TFS does not support REST API). If you have traditional application that uses Client Object Model, you can remove all the references to the old dll and directly reference the &lt;a href="https://www.nuget.org/packages/Microsoft.TeamFoundationServer.ExtendedClient/">ExtendedClient Package&lt;/a> and you are ready to go.&lt;/p></description></item><item><title>Use a WebBrowser to login into a site that use HttpOnly cookie</title><link>https://www.codewrecks.com/post/old/2011/04/use-a-webbrowser-to-login-into-a-site-that-use-httponly-cookie/</link><pubDate>Tue, 12 Apr 2011 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/04/use-a-webbrowser-to-login-into-a-site-that-use-httponly-cookie/</guid><description>&lt;p>Suppose you need to programmatically analyze some web pages that are protected by a login procedure and you have a valid login to the site. A simple solution is issuing a POST request to the login page with the correct credentials, then continue to use the same cookie container to issue subsequent downloads, but in some situation this is not enough. Suppose the site uses some strange login procedure that uses redirect&lt;/p></description></item></channel></rss>