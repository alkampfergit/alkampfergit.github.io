<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TfsAPI on Codewrecks</title><link>https://www.codewrecks.com/tags/tfsapi/</link><description>Recent content in TfsAPI on Codewrecks</description><generator>Hugo</generator><language>en</language><lastBuildDate>Tue, 08 Jul 2014 14:00:37 +0200</lastBuildDate><atom:link href="https://www.codewrecks.com/tags/tfsapi/index.xml" rel="self" type="application/rss+xml"/><item><title>Index TFVC Source Code to Solr</title><link>https://www.codewrecks.com/post/old/2014/07/index-tfvc-source-code-to-solr/</link><pubDate>Tue, 08 Jul 2014 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/07/index-tfvc-source-code-to-solr/</guid><description>&lt;p>If you use good comments in your code, sometimes you need to search inside those comment to find a certain part of code associated to a specific comment that contains specific word. The sad part is that you can do it only for the latest version of the code and not for the entire history of all files. Suppose you want to do a simple &lt;strong>Proof Of Concept to insert all content of all C# source code files in some search server (Es Solr, or Elastic Search) how it can be done with TFVC&lt;/strong> ?&lt;/p></description></item><item><title>Associate Work Items to Git commit in TF Service with API Calls</title><link>https://www.codewrecks.com/post/old/2013/06/associate-work-items-to-git-commit-in-tf-service-with-api-calls/</link><pubDate>Tue, 18 Jun 2013 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2013/06/associate-work-items-to-git-commit-in-tf-service-with-api-calls/</guid><description>&lt;p>I’ve already blogged how to &lt;a href="http://www.codewrecks.com/blog/index.php/2013/02/02/tfs-api-to-associate-work-item-with-check-in-using-comment-tags/">associate Work Items with TFS Check-ins using tags in comment and a bunch of Api Calls&lt;/a>. This feature is now available for any TF Service based on Git, but someone asked me how can you accomplish this task with API. A possible scenario would be supporting &lt;strong>different type of comment syntax&lt;/strong> and in general to understand how this task can be accomplished though API.&lt;/p>
&lt;p>The code is really similar to the one I’ve posted in the other article, the only differences is comments are taken from Git commit and not from changeset checkins. The prerequisite is having a local git repository cloned from a TF Service Git based project, than we can simply iterate through all commits to identify comments containing pattern #wid, where wid is the work item id. Once a commit is identified we can &lt;strong>create&lt;/strong> &lt;strong>the link between the corresponding Work Item with some API calls&lt;/strong>.&lt;/p></description></item><item><title>Copy TFS queries between iterations</title><link>https://www.codewrecks.com/post/old/2011/03/copy-tfs-queries-between-iteractions/</link><pubDate>Thu, 17 Mar 2011 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/03/copy-tfs-queries-between-iteractions/</guid><description>&lt;p>In an &lt;a href="http://www.codewrecks.com/blog/index.php/2011/03/07/duplicate-queries-in-tfs-between-iterations/">old post&lt;/a> I spoke about a simple routine to copy queries between iterations in TFS, now it is time to show the code, behind this simple command.&lt;/p>
&lt;p>Everything is really simple, the first step is creating a connection with the TFS server and retrieve a reference to &lt;a href="http://msdn.microsoft.com/en-us/library/microsoft.teamfoundation.workitemtracking.client.queryhierarchy.aspx">QueryHierarchy&lt;/a> object&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">string&lt;/span> userName = GetParameterValue&amp;lt;String&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;user&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">string&lt;/span> password = GetParameterValue&amp;lt;String&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;pwd&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>TfsTeamProjectCollection tfs =
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">new&lt;/span> TfsTeamProjectCollection(&lt;span style="color:#66d9ef">new&lt;/span> Uri(GetParameterValue&amp;lt;String&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;collection&amp;#34;&lt;/span>)),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">new&lt;/span> NetworkCredential(userName, password));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">string&lt;/span> projectName = GetParameterValue&amp;lt;String&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;teamproject&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>WorkItemStore store = (WorkItemStore) tfs.GetService&amp;lt;WorkItemStore&amp;gt;();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">string&lt;/span> iterationsource = GetParameterValue&amp;lt;String&amp;gt;(&lt;span style="color:#e6db74">&amp;#34;iterationsource&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>QueryHierarchy queryHierarchy = store.Projects[projectName].QueryHierarchy;&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>The code is really simple, just create a &lt;a href="http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&amp;amp;amp;l=EN-US&amp;amp;amp;k=k%28MICROSOFT.TEAMFOUNDATION.CLIENT.TFSTEAMPROJECTCOLLECTION%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&amp;amp;amp;rd=true">TfsTeamProjectCollection,&lt;/a> pass the url of the collection as well as network credential and the connection to the TFS is done. Now I recover projectName from the command line parameters, and grab a reference to a &lt;a href="http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&amp;amp;amp;l=EN-US&amp;amp;amp;k=k%28MICROSOFT.TEAMFOUNDATION.WORKITEMTRACKING.CLIENT.WORKITEMSTORE%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&amp;amp;amp;rd=true">WorkItemStore&lt;/a> object thanks to the well known &lt;a href="http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&amp;amp;amp;l=EN-US&amp;amp;amp;k=k%28%22MICROSOFT.TEAMFOUNDATION.CLIENT.TFSCONNECTION.GETSERVICE%60%601%22%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK%2cVERSION%3dV4.0%22%29;k%28DevLang-CSHARP%29&amp;amp;amp;rd=true">GetService&lt;/a>() method of the TfsTeamProjectCollection object.&lt;/p></description></item><item><title>How to get TFS server address from a local folder mapped to a workspace</title><link>https://www.codewrecks.com/post/old/2010/09/how-to-get-tfs-server-address-from-a-local-folder-mapped-to-a-workspace/</link><pubDate>Mon, 13 Sep 2010 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/09/how-to-get-tfs-server-address-from-a-local-folder-mapped-to-a-workspace/</guid><description>&lt;p>Sometimes you need to operate to a Tfs Version Control System with API starting from a local folder. There are a lot of API to work with workspaces, but the main problem is that you need to pass through a &lt;a href="http://msdn.microsoft.com/en-us/library/bb171724%28v=VS.100%29.aspx">VersionControlServer&lt;/a> object, and to obtain such an object you need to know the address of the Tfs server the workspace is mapped to?&lt;/p>
&lt;p>The exercise is the following one :) – Write a snippet of code, based on TFS API that, given a local path, retrieve ChangesetId that is currently mapped on the workspace.&lt;/p></description></item><item><title>Create a Work Item By code in TFS returns TF237124 Work Item is not ready to save</title><link>https://www.codewrecks.com/post/old/2010/05/create-a-work-item-by-code-in-tfs-returns-tf237124-work-item-is-not-ready-to-save/</link><pubDate>Mon, 10 May 2010 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/05/create-a-work-item-by-code-in-tfs-returns-tf237124-work-item-is-not-ready-to-save/</guid><description>&lt;p>Today my dear friend &lt;a href="http://blogs.ugidotnet.org/j3r/Default.aspx">Matteo&lt;/a> asked me some help with a snippet of code to insert a WIT into a TFS. The snippet was the following one.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>Dim tfs As New TeamFoundationServer(&lt;span style="color:#e6db74">&amp;#34;http://tfs2010test:8080/tfs/defaultcollection&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>New NetworkCredential(&lt;span style="color:#e6db74">&amp;#34;Administrator&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;xxxxxxxx&amp;#34;&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dim wis As WorkItemStore = DirectCast(tfs.GetService(GetType(WorkItemStore)), WorkItemStore)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dim teamProject As Project = wis.Projects(&lt;span style="color:#ae81ff">0&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dim witype As WorkItemType = teamProject.WorkItemTypes(&lt;span style="color:#e6db74">&amp;#34;Task&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>If witype IsNot Nothing Then
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Console.WriteLine(&lt;span style="color:#e6db74">&amp;#34;Adding new task to Team Project {0}&amp;#34;&lt;/span>, teamProject.Name)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Dim wi As New WorkItem(witype)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wi.Title = &lt;span style="color:#e6db74">&amp;#34;You have a Task! [Ding]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wi.State = &lt;span style="color:#e6db74">&amp;#34;Active&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>wi.Save()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Console.WriteLine(&lt;span style="color:#e6db74">&amp;#34;Added Work Item # {0} created by {1}&amp;#34;&lt;/span>, wi.Id, wi.CreatedBy)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>He is having problem because the Save throws exception.&lt;/p></description></item></channel></rss>