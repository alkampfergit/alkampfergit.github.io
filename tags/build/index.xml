<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Build on Codewrecks</title><link>https://www.codewrecks.com/tags/build/</link><description>Recent content in Build on Codewrecks</description><generator>Hugo</generator><language>en</language><lastBuildDate>Tue, 25 Feb 2020 17:00:37 +0200</lastBuildDate><atom:link href="https://www.codewrecks.com/tags/build/index.xml" rel="self" type="application/rss+xml"/><item><title>GitHub Actions plus Azure Docker Registry</title><link>https://www.codewrecks.com/post/old/2020/02/github-actions-plus-azure-docker-registry/</link><pubDate>Tue, 25 Feb 2020 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2020/02/github-actions-plus-azure-docker-registry/</guid><description>&lt;p>I have some projects that needs SqlServer and MongoDb or ElasticSearch to run some integration tests, these kind of requirements made difficult to use hosted agent for build (in Azure DevOps) or &lt;strong>whatever build system you are using where a provider gives you pre-configured machine to run your workflow.&lt;/strong> Usually each build engine made possible for you to run your own agent and GitHub actions makes no difference ( you can read here about self installed action runners &lt;a href="https://help.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners">https://help.github.com/en/actions/hosting-your-own-runners/about-self-hosted-runners&lt;/a>)&lt;/p></description></item><item><title>Consume Azure DevOps feed in TeamCity</title><link>https://www.codewrecks.com/post/old/2019/12/consume-azure-devops-feed-in-teamcity/</link><pubDate>Wed, 04 Dec 2019 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/12/consume-azure-devops-feed-in-teamcity/</guid><description>&lt;p>&lt;strong>Azure DevOps has an integrated feed management you can use for nuget, npm, etc; the feed is private and only authorized users can download / upload packages.&lt;/strong> Today I had a little problem setting up a build in Team City that uses a feed in Azure Devops, because it failed with 201 (unauthorized)&lt;/p>
&lt;blockquote>
&lt;p>The problem with Azure DevOps NuGet feeds, is how to authenticate other toolchain or build server.&lt;/p>&lt;/blockquote>
&lt;p>This project still have some old build in TeamCity, but when it starts consuming packages published in Azure Devops, TeamCity builds start failing due 401 (unauthorized) error. The question is: How can I consume an Azure DevOps nuget feed from agent or tools that are not related to Azure Devops site itself?&lt;/p></description></item><item><title>Quick Peek at Microsoft Security Code Analysis Credential Scanner</title><link>https://www.codewrecks.com/post/old/2019/11/quick-peek-at-microsoft-security-code-analysis-credential-scanner/</link><pubDate>Sat, 23 Nov 2019 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/11/quick-peek-at-microsoft-security-code-analysis-credential-scanner/</guid><description>&lt;p>&lt;a href="https://secdevtools.azurewebsites.net/">&lt;strong>Microsoft Security Code Analysis&lt;/strong>&lt;/a> &lt;strong>contains a set of Tasks for Azure DevOps pipeline to automate some security checks during building of your software.&lt;/strong> Automatic security scanning tools are not a substitute in any way for human security analysis, remember: if you develop code ignoring security, no tool can save you.&lt;/p>
&lt;p>&lt;strong>Despite this fact, there are situation where static analysis can really give you benefit,&lt;/strong> because it can avoid you some simple and silly errors, that can lead to troubles. All Tasks in Microsoft Security Code Analysis package are designed to solve a particular problem and to prevent some common mistake.&lt;/p></description></item><item><title>Multiline PowerShell on YAML pipeline</title><link>https://www.codewrecks.com/post/old/2019/11/multiline-powershell-on-yaml-pipeline/</link><pubDate>Tue, 19 Nov 2019 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/11/multiline-powershell-on-yaml-pipeline/</guid><description>&lt;p>Sometimes having a &lt;strong>few lines of PowerShell in your pipeline is the only thing you need to quickly customize a build without using a custom task or having a PowerShell file in source code&lt;/strong>. One of the typical situation is: write a file with some content that needs to be determined by a PowerShell script, in my situation I need to create a configuration file based on some build variable.&lt;/p></description></item><item><title>Release app with Azure DevOps Multi Stage Pipeline</title><link>https://www.codewrecks.com/post/old/2019/10/release-app-with-azure-devops-multi-stage-pipeline/</link><pubDate>Mon, 21 Oct 2019 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/10/release-app-with-azure-devops-multi-stage-pipeline/</guid><description>&lt;p>MultiStage pipelines are still in preview on Azure DevOps, but it is time to experiment with real build-release pipeline, to taste the news. The Biggest limit at this moment is that you can use Multi Stage to deploy in Kubernetes or in the cloud, but there is not support for agent in VM (like standard release engine). This support will be added in the upcoming months but &lt;strong>if you use azure or kubernetes as a target you can already use it.&lt;/strong> My sample solution is &lt;a href="https://github.com/alkampfergit/AzureDevopsReleaseSamples">in GitHub&lt;/a>, it contains a real basic Asp.NET core project that contains some basic REST API and a really simple angular application. On of the advantage of having everything in the repository is that you can simply fork my repository and make experiment.&lt;/p></description></item><item><title>Azure DevOps gems YAML Pipeline and Templates</title><link>https://www.codewrecks.com/post/old/2019/08/azure-devops-gems-yaml-pipeline-and-templates/</link><pubDate>Sun, 18 Aug 2019 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/08/azure-devops-gems-yaml-pipeline-and-templates/</guid><description>&lt;p>If you read my blog you already know that I’m a great fan of YAML Pipeline instead of using Graphic editor in the Web UI, there are lots of reasons why you should use YAML; one for &lt;strong>all the ability to branch Pipeline definition with code, but there is another really important feature:&lt;/strong> &lt;a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops">&lt;strong>templates&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>There is a really detailed documentation on &lt;a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops">MSDN&lt;/a> on how to use this feature, but I want to give you a complete walkthrough on how to start to effectively use templates. &lt;strong>Thanks to templates you can create a standard build definition with steps or jobs and steps in a template file, then reference that file from real build, just adding parameters.&lt;/strong> &amp;gt; &lt;strong>The ability to capture a sequence of steps in a common template file and reuse it over and over again in real pipeline is probably one of the top reason for moving to YAML template.&lt;/strong> One of the most common scenario for me is: account with lots of utilities projects (multitargeted for full framework and dotnetstandard), each one with its git repository and the need for a standard CI definition to:&lt;/p></description></item><item><title>Install latest node version in Azure Pipelines</title><link>https://www.codewrecks.com/post/old/2019/06/install-latest-node-version-in-azure-pipelines/</link><pubDate>Wed, 12 Jun 2019 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/06/install-latest-node-version-in-azure-pipelines/</guid><description>&lt;p>I have a build in Azure DevOps that suddenly starts failing on some agents during the build of an angular application. Looking at the log I found that error&lt;/p>
&lt;blockquote>
&lt;p>You are running version v8.9.4 of Node.js, which is not supported by Angular CLI 8.0+.&lt;/p>&lt;/blockquote>
&lt;p>Ok, the error is really clear, &lt;strong>some developer upgraded Angular version on the project and node version installed in some of the build servers is old.&lt;/strong> Now the obvious situation is logging in ALL build servers, upgrade node js installation and the build should run on every agent. This is not a perfect solution, especially because because someone can &lt;strong>add another build server with an outdated Node Js version and I’m stuck again.&lt;/strong> &amp;gt; Having some strong pre-requisite on build agent, like a specific version of NodeJs is annoying and needs to be addressed as soon as possible.&lt;/p></description></item><item><title>Another gem of Azure Devops multistage pipelines</title><link>https://www.codewrecks.com/post/old/2019/05/another-gem-of-azure-devops-multistage-pipelines/</link><pubDate>Sat, 18 May 2019 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/05/another-gem-of-azure-devops-multistage-pipelines/</guid><description>&lt;p>With deployment of Sprint 151 we have an exciting news for Azure DevOps called &lt;strong>multi stage pipelines.&lt;/strong> If you read my blog you should already know that I’m a huge fan of having YAML build definition, but until now, for the release part, you still had to have the standard graphical editor. &lt;strong>Thanks to Multi Stage Pipelines now you can have both build and release definition directly in a single YAML file&lt;/strong>.&lt;/p></description></item><item><title>Error publishing NET core app in Azure Devops YAML Build</title><link>https://www.codewrecks.com/post/old/2019/04/error-publishing-net-core-app-in-azure-devops-yaml-build/</link><pubDate>Tue, 30 Apr 2019 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/04/error-publishing-net-core-app-in-azure-devops-yaml-build/</guid><description>&lt;p>Short story, I’ve created a simple YAML build for a.NET core project where one of the task will publish a simple.NET core console application. After running the build I’ve a strange error in the output&lt;/p>
&lt;blockquote>
&lt;p>No web project was found in the repository. Web projects are identified by presence of either a web.config file or wwwroot folder in the directory.&lt;/p>&lt;/blockquote>
&lt;p>This is extremely strange, because the project is not a web project, it is a standard console application written for.NET core 2.2 so I do not understand why it is searching a web.config file.&lt;/p></description></item><item><title>Troubleshoot YAML Build first run</title><link>https://www.codewrecks.com/post/old/2019/04/troubleshoot-yaml-build-first-run/</link><pubDate>Sat, 13 Apr 2019 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/04/troubleshoot-yaml-build-first-run/</guid><description>&lt;p>&lt;strong>Scenario&lt;/strong> : You create a branch in your git repository to start with a new shiny YAML Build definition for Azure Devops, you create a yaml file, push the branch in Azure Devops and Create a new Build based on that YAML definition. Everything seems ok, but when you press the run button you got and error&lt;/p>
&lt;blockquote>
&lt;p>Could not find a pool with name Default. The pool does not exist or has not been authorized for use. For authorization details, refer to &lt;a href="https://aka.ms/yamlauthz">https://aka.ms/yamlauthz&lt;/a>.&lt;/p></description></item><item><title>Build and Deploy AspNet App with Azure DevOps</title><link>https://www.codewrecks.com/post/old/2019/03/build-and-deploy-asp-net-app-with-azure-devops/</link><pubDate>Thu, 28 Mar 2019 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/03/build-and-deploy-asp-net-app-with-azure-devops/</guid><description>&lt;p>I’ve blogged in the past about deploying ASP.NET application, but lots of new feature changed in Azure DevOps and it is time to do some refresh of basic concepts. &lt;strong>Especially in the field of web.config transform there is always lots of confusion and even if I’m an advocate of removing every configuration from files and source, it is indeed something that worth to be examined.&lt;/strong> &amp;gt; &lt;strong>The best approach for configuration is removing then from source control, use configuration services, etc and move away from web.config.&lt;/strong> But since most people still use web.config, lets start with a standard ASP.NET application with a Web.Config and a &lt;strong>couple of application settings that should be changed during deploy.&lt;/strong> &lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2019/03/image-8.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2019/03/image_thumb-8.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2019/03/image_thumb-8.png" alt="image" />&lt;/a>&lt;/a>&lt;/p></description></item><item><title>YAML Build in Azure DevOps</title><link>https://www.codewrecks.com/post/old/2019/03/yaml-build-in-azure-devops/</link><pubDate>Sat, 16 Mar 2019 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/03/yaml-build-in-azure-devops/</guid><description>&lt;p>I’ve blogged in the past about &lt;strong>YAML build in azure DevOps, but in that early days, that kind of build was a little bit rough&lt;/strong> and many people still preferred the old build based on visual editing in a browser. One of the main complaint was that the build was not easy to edit and there were some glitch, especially when it is time to access external services.&lt;/p>
&lt;p>&lt;strong>After months from the first version, the experience is really improved and I strongly suggest you to start trying to migrate existing build to this new system,&lt;/strong> to take advantage of having definition of build directly in the code, a practice that is more DevOps oriented and that allows you to have different build tasks for different branches.&lt;/p></description></item><item><title>Sonar Analysis of Python with Azure DevOps pipeline</title><link>https://www.codewrecks.com/post/old/2019/01/sonar-analysis-of-python-with-azure-devops-pipeline/</link><pubDate>Sat, 05 Jan 2019 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/01/sonar-analysis-of-python-with-azure-devops-pipeline/</guid><description>&lt;p>Once you have &lt;a href="http://www.codewrecks.com/blog/index.php/2018/11/20/run-code-coverage-for-python-project-with-azure-devops/">test and Code Coverage&lt;/a> for your build of Python code, &lt;strong>last step for a good build is adding support for Code Analysis with Sonar/SonarCloud.&lt;/strong> SonarCloud is the best option if your code is open source, because it is free and you should not install anything except the &lt;a href="https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarcloud">free addin in Azure Devops Marketplace&lt;/a>.&lt;/p>
&lt;p>From original build you need only to add two steps: PrepareAnalysis onSonarCloud and Run SonarCloud analysis, in the same way you do analysis for a.NET project.&lt;/p></description></item><item><title>Deploy click-once application on Azure Blob with Azure DevOps</title><link>https://www.codewrecks.com/post/old/2018/12/deploy-click-once-application-on-azure-blob-with-azure-devops/</link><pubDate>Fri, 07 Dec 2018 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/12/deploy-click-once-application-on-azure-blob-with-azure-devops/</guid><description>&lt;p>It was a long time ago I blogged on how to &lt;a href="http://www.codewrecks.com/blog/index.php/2015/12/30/rename-xmlrpc-php-on-your-wordpress-installation-2/">publish a click-once application&lt;/a> from a VSTS Build to Azure Blob, long time was passed, and lots of stuff changed. &lt;strong>The whole process is now simpler,&lt;/strong> thanks to many dedicated tasks that avoid doing any manual work.&lt;/p>
&lt;p>My new build always start with a  GitVersion custom tasks, that populates some environment variables with version numbers generated by GitVersion, this will allow me to simply add an MsBuild task in the build to publish click-once using automatic GitVersion versioning.&lt;/p></description></item><item><title>Run code coverage for Python project with Azure DevOps</title><link>https://www.codewrecks.com/post/old/2018/11/run-code-coverage-for-python-project-with-azure-devops/</link><pubDate>Tue, 20 Nov 2018 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/11/run-code-coverage-for-python-project-with-azure-devops/</guid><description>&lt;p>Creating a &lt;a href="http://www.codewrecks.com/blog/index.php/2018/11/12/run-python-test-with-azure-devops-pipeline/">simple build that runs Python tests written with PyTest&lt;/a> framework is really simple, but now &lt;strong>the next step is trying to have code coverage&lt;/strong>. Even if I’m pretty new to Python, having code coverage in a build is really simple, thanks to a specific task that comes out-of-the-box with Azure DevOps: Publish Code Coverage.&lt;/p>
&lt;blockquote>
&lt;p>In Azure DevOps you can create build with Web Editor or with simple YAML file, I prefer YAML but since I’ve demonstrated in the old post YAML build for Python, now I’m creating a simple build with standard Web Editor&lt;/p></description></item><item><title>Run Python test with Azure DevOps pipeline</title><link>https://www.codewrecks.com/post/old/2018/11/run-python-test-with-azure-devops-pipeline/</link><pubDate>Mon, 12 Nov 2018 22:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/11/run-python-test-with-azure-devops-pipeline/</guid><description>&lt;p>The beauty of Azure DevOps is it support to many technologies and all of major language.s I have a simple git repository where I’m experimenting Python code, in that repository I have several directories like 020_xxxx 010_yyy where I’m playing with Python code.&lt;/p>
&lt;p>Each folder contains some code and some unit tests written in Pytest, &lt;strong>my goal is creating an Azure Pipeline that can automatically run all pytest for me automatically each time I push some code to the repository.&lt;/strong> &amp;gt; Even if Phyton is a script languages, it has several Unit Testing frameworks that can be used to verify that the code you wrote works as expected&lt;/p></description></item><item><title>Analyze your GitHub project for free with Azure DevOps and SonarCloud</title><link>https://www.codewrecks.com/post/old/2018/11/analyze-your-github-project-for-free-with-azure-devops-and-sonarcloud/</link><pubDate>Sun, 04 Nov 2018 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/11/analyze-your-github-project-for-free-with-azure-devops-and-sonarcloud/</guid><description>&lt;p>I’ve blogged some weeks ago on how to &lt;a href="http://www.codewrecks.com/blog/index.php/2018/10/10/azure-devops-pipelines-and-sonar-cloud-gives-free-analysis-to-your-os-project/">analyze OS code with SonarCloud&lt;/a>, but it is time to update the post, because &lt;strong>if you want to use SonarCloud you have a dedicated extension in the marketplace&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2018/10/image-17.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2018/10/image_thumb-17.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2018/10/image_thumb-17.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Official SonarCloud extension in the marketplace.&lt;/em>&lt;/p>
&lt;p>One of the great feature of Azure DevOps is its extendibility, that allows people external to Microsoft to create extensions to expand the possibility of the tool. Once you’ve added the SonarCloud extension to your account, &lt;strong>you have a whole bunch new build templates you can use&lt;/strong> :&lt;/p></description></item><item><title>Azure DevOps pipelines and Sonar Cloud gives free analysis to your OS project</title><link>https://www.codewrecks.com/post/old/2018/10/azure-devops-pipelines-and-sonar-cloud-gives-free-analysis-to-your-os-project/</link><pubDate>Wed, 10 Oct 2018 21:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/10/azure-devops-pipelines-and-sonar-cloud-gives-free-analysis-to-your-os-project/</guid><description>&lt;p>In previous post I’ve shown how &lt;a href="http://www.codewrecks.com/blog/index.php/2018/10/09/code-in-github-build-in-azure-devops-and-for-free/">easy is to create a YAML definition&lt;/a> to create a build definition to build your GitHub Open Source project in Azure DevOps, without the need to spend any money nor installing anything on you server.&lt;/p>
&lt;p>Once you create a default build that compile and run tests, it would be super nice to create a free account in SonarCloud to have your project code to be analyzed automatically from the Azure Pipeline you’ve just created. I’ve &lt;a href="http://www.codewrecks.com/blog/index.php/2018/03/25/run-sonarcloud-analysis-in-vsts-tfs-build/">already blogged on how to setup SonarCloud analysis for OS project with VSTS build&lt;/a> and the very same technique can be used in YAML build.&lt;/p></description></item><item><title>Code in GitHub Build in Azure DevOps and for FREE</title><link>https://www.codewrecks.com/post/old/2018/10/code-in-github-build-in-azure-devops-and-for-free/</link><pubDate>Tue, 09 Oct 2018 21:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/10/code-in-github-build-in-azure-devops-and-for-free/</guid><description>&lt;p>When you create a new open source project in GitHub, one of the first step is to setup continuous integration; the usual question is: What CI engine should I use? &lt;strong>Thanks to Azure Dev Ops, you can use free build pipelines to build projects even if they are in GitHub&lt;/strong> (not hosted in Azure Dev Ops)&lt;/p>
&lt;blockquote>
&lt;p>Azure Dev Ops, formerly known as VSTS, allows to define free build pipelines to build projects in GitHub&lt;/p></description></item><item><title>VSTS Name change in Azure DevOps effects on Git repositories</title><link>https://www.codewrecks.com/post/old/2018/09/vsts-name-change-in-azure-devops-effects-on-git-repositories/</link><pubDate>Thu, 27 Sep 2018 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/09/vsts-name-change-in-azure-devops-effects-on-git-repositories/</guid><description>&lt;p>As I blogged in the past, it is super easy to build a VSTS Build (Now Azure DevOps Pipeline) to &lt;a href="http://www.codewrecks.com/blog/index.php/2016/10/22/keep-git-repository-in-sync-between-vsts-tfs-and-git/">keep two repositories in sync&lt;/a>. In that article one of the step is pushing the new code to the destination repositories with an url like: &lt;a href="https://$%28token%29@myaddress.visualstudio.com/DefaultCollection">https://$(token)@myaddress.visualstudio.com/DefaultCollection&lt;/a>, to automatically include a token to authenticate in the destination repository.&lt;/p>
&lt;p>&lt;strong>Now some of my build started to fail due to timeout&lt;/strong> and I immediately suspected the reason: &lt;strong>the name change from VSTS to Azure DevOps changed the base url from accountname.visualstudio.com to dev.azure.com/accountname, and this in some way broke the bulid&lt;/strong>.&lt;/p></description></item><item><title>Be sure to use latest version of Nuget Restore Task in VSTS Build</title><link>https://www.codewrecks.com/post/old/2018/08/be-sure-to-use-latest-version-of-nuget-restore-task-in-vsts-build/</link><pubDate>Mon, 27 Aug 2018 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/08/be-sure-to-use-latest-version-of-nuget-restore-task-in-vsts-build/</guid><description>&lt;p>If you have in VSTS some old build that uses Nuget restore task, it is time to check if you are using the new version, because if you still use the 0.x version you are missing some interesting features.&lt;/p>
&lt;blockquote>
&lt;p>With VSTS build it is always a good habit to periodically check if some of the tasks have new version.&lt;/p>&lt;/blockquote>
&lt;p>Here is as an example, how the version 0 is configured&lt;/p></description></item><item><title>Run SonarCloud analysis in VSTS TFS Build</title><link>https://www.codewrecks.com/post/old/2018/03/run-sonarcloud-analysis-in-vsts-tfs-build/</link><pubDate>Sun, 25 Mar 2018 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/03/run-sonarcloud-analysis-in-vsts-tfs-build/</guid><description>&lt;p>Running a SonarQube analysis for TFS or VSTS is really easy because we can use a pre-made build tasks that requires few parameters and the game is done. &lt;strong>If you have open source project it made lot of sense to use a public account in SonarCloud&lt;/strong> , so you do not need to maintain a sonar server on-premise and you can also share your public account with the community.&lt;/p>
&lt;blockquote>
&lt;p>For open source projects, SonarCloud is available for you with zero effort and thanks to VSTS and TFS you can automate the analysis with few steps.&lt;/p></description></item><item><title>VSTS TFS use Wildcards for continuous integration in Git</title><link>https://www.codewrecks.com/post/old/2018/02/vsts-tfs-use-wildcards-for-continuous-integration-in-git/</link><pubDate>Tue, 20 Feb 2018 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/02/vsts-tfs-use-wildcards-for-continuous-integration-in-git/</guid><description>&lt;p>If you setup a build in VSTS / TFS against a git repository, you can choose to trigger the build when some specific branch changed. &lt;strong>You can press plus button and a nice combobox appears to select the branch you want to monitor&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image-3.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-3.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2018/02/image_thumb-3.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Adding a branch as trigger in VSTS / TFS Build&lt;/em>&lt;/p>
&lt;p>This means that if you add feature/1312_languageSelector, each time a new commit will be pushed on that branch, a new build will trigger. Actually if you use GitFlow you are interested in building each feature branch, so you do not want to add every feature branch in the list of monitored branches.&lt;/p></description></item><item><title>New cool feature of VSTS to limit impact of erratic tests</title><link>https://www.codewrecks.com/post/old/2018/02/new-cool-feature-of-vsts-to-limit-impact-of-erratic-tests/</link><pubDate>Tue, 13 Feb 2018 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2018/02/new-cool-feature-of-vsts-to-limit-impact-of-erratic-tests/</guid><description>&lt;p>I’ve blogged some time ago about &lt;a href="http://www.codewrecks.com/blog/index.php/2017/08/17/running-uat-tests-in-a-vsts-tfs-release/">running UAT testing&lt;/a> with a mix of Build + Release in VSTS. &lt;strong>Actually, UAT testing are often hard to write, because they can be erratic&lt;/strong>. As an example, we have a software composed by 5 services that collaborates together, CQRS and Event Sourcing, so most of the tests are based on a typical pattern: Do something then wait for something to happen.&lt;/p>
&lt;blockquote>
&lt;p>Writing tests that interact with the UI or are based on several services interacting togheter can be difficult.&lt;/p></description></item><item><title>Converting regular build in YAML build</title><link>https://www.codewrecks.com/post/old/2017/12/converting-regular-build-in-yaml-build/</link><pubDate>Thu, 14 Dec 2017 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/12/converting-regular-build-in-yaml-build/</guid><description>&lt;p>&lt;strong>YAML build in VSTS / TFS is one of the most welcomed feature in the Continuous Integration engine&lt;/strong> , because it really opens many new possibilities. Two of the most important advantages you have with this approach are: build definitions will follow branches, so each branch can have a different definition, then, since the build is in the code, &lt;strong>everything is audited, you can pull request build modification and you can test different build in branches as you do with code&lt;/strong>.&lt;/p></description></item><item><title>YAML build in VSTS</title><link>https://www.codewrecks.com/post/old/2017/11/yaml-build-in-vsts/</link><pubDate>Sun, 26 Nov 2017 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/11/yaml-build-in-vsts/</guid><description>&lt;p>One of the most exciting feature that was recently introduced in VSTS is &lt;strong>the ability to create YAML Build&lt;/strong>. You need to enable this feature because it is still in preview and as usual you can enable for your account from the preview feature management&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image-4.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image_thumb-4.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image_thumb-4.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Enable YAML feature for the entire account&lt;/em>&lt;/p>
&lt;p>After you enable this feature, when you create a new build you can create a build based on YAML.&lt;/p></description></item><item><title>VSTS build failed test phase but 0 tests failed</title><link>https://www.codewrecks.com/post/old/2017/11/vsts-build-failed-test-but-0-test-failed/</link><pubDate>Sat, 18 Nov 2017 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/11/vsts-build-failed-test-but-0-test-failed/</guid><description>&lt;p>I had a strange situation where I have a build that suddenly starts &lt;strong>signal failing tests, but actually zero test failed&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/11/image_thumb.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>No test failed, but the test phase was marked as failed&lt;/em>&lt;/p>
&lt;p>As you can see in Figure 1, the Test step is marked failed, but actually I have not a single test failed, indeed a strange situation. To troubleshoot this problem, you need to select the failing step to verify the exact output of the task.&lt;/p></description></item><item><title>Multitarget NetStandard for Windows and Linux</title><link>https://www.codewrecks.com/post/old/2017/10/multitarget-netstandard-for-windows-and-linux/</link><pubDate>Sat, 28 Oct 2017 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/10/multitarget-netstandard-for-windows-and-linux/</guid><description>&lt;p>One of the most important features of &lt;strong>DotNetStandard is the ability to run on Linux and Mac,&lt;/strong> but if you need to use a DotNetStandard compiled library in a project that uses full.NET framework, sometimes you can have little problems. Actually you can reference a dll compiled for DotNetCore from a project that uses full Framework, but in a couple of project we experienced some trouble with some assemblies.&lt;/p>
&lt;p>&lt;strong>Thanks to multitargeting you can simply instruct DotNet compiler to produce libraries compiled against different versions of frameworks,&lt;/strong> so you can simply tell the compiler that you want both DotNetStandard 2.0 and full framework 4.6.1, you just need to modify the project file to use TargetFrameworks tag to request compilation for different framework.&lt;/p></description></item><item><title>Configure a VSTS Linux agent with docker in minutes</title><link>https://www.codewrecks.com/post/old/2017/10/configure-a-vsts-linux-agent-with-docker-in-minutes/</link><pubDate>Sat, 14 Oct 2017 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/10/configure-a-vsts-linux-agent-with-docker-in-minutes/</guid><description>&lt;p>It is really simple to create a build agent for VSTS that runs in Linux and is capable of building and packaging your DotNetCore project, I’ve explained everything in &lt;a href="http://www.codewrecks.com/blog/index.php/2017/09/30/dotnetcore-ci-linux-and-vsts/">a previous post&lt;/a>, but I want to remind you that, with docker, the whole process is really simple.&lt;/p>
&lt;p>&lt;strong>Anyone knows that setting up a build machine often takes time.&lt;/strong> VSTS makes it super simple to install the Agent , just download a zip, call a script to configure the agent and the game is done. But this is only one side of the story. Once the agent is up, if you fire a build, it will fail if you did not install all the tools to compile your project (.NET Framework) and often you need to install the whole Visual Studio environment because you have specific dependencies. I have also code that needs MongoDB and Sql Server to run tests against those two databases, this will usually require more manual work to setup everything.&lt;/p></description></item><item><title>Pause build and clear long build queue</title><link>https://www.codewrecks.com/post/old/2017/10/pause-build-and-clear-long-build-queue/</link><pubDate>Thu, 12 Oct 2017 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/10/pause-build-and-clear-long-build-queue/</guid><description>&lt;p>In VSTS / TFS Build system, you can change the status of the build, between three states: Enabled, Paused and Disabled. &lt;strong>The Paused state is really special, because all the build trigger are still active and builds are queued, but all these queued build does not starts&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image_thumb.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Paused build&lt;/em>&lt;/p>
&lt;p>Paused state should be used with great care, because if you forget a build in this state, you can end up with lots of queued build, as you can see in &lt;em>&lt;strong>Figure 2&lt;/strong>&lt;/em>: &lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image-1.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image_thumb-1.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/10/image_thumb-1.png" alt="image" />&lt;/a>&lt;/a>&lt;/p></description></item><item><title>Check Angular AoT with a TFS Build</title><link>https://www.codewrecks.com/post/old/2017/09/check-angular-aot-with-a-tfs-build/</link><pubDate>Sat, 23 Sep 2017 12:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/09/check-angular-aot-with-a-tfs-build/</guid><description>&lt;p>Developing with Angular is a real fun, but usually during development you serve the application without any optimization, mainly because you want to speedup the compilation and serving of your Angular application.&lt;/p>
&lt;p>&lt;strong>When it is time to release the software, usually you build with –prod switch and usually you also use the –aot switch&lt;/strong> (it seems to me that it is on by default on –prod in latest version of the ng compiler). The aot switch enable the Ahead of Time compiling, that is used to speedup your deployed application and also it find some more error than a normal compilation.&lt;/p></description></item><item><title>Choose agent at build queue time</title><link>https://www.codewrecks.com/post/old/2017/09/choose-agent-at-build-queue-time/</link><pubDate>Thu, 07 Sep 2017 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/09/choose-agent-at-build-queue-time/</guid><description>&lt;p>This is a simple feature that is not known very well and deserve a blog post. Sometimes you &lt;strong>want to queue a build to a specific agent in a queue and this can be simply done using agent.name as a demand&lt;/strong>.&lt;/p>
&lt;p>Demands are simple key/value pairs that allows the build engine to choose compatible agents and each agent automatically have a couple of capability to store computer name and agent name (they can be different)&lt;/p></description></item><item><title>VSTS agent on Ubuntu 1604 error in configuresh</title><link>https://www.codewrecks.com/post/old/2017/08/vsts-agent-on-ubuntu-16-04-error-in-configure-sh/</link><pubDate>Tue, 22 Aug 2017 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/08/vsts-agent-on-ubuntu-16-04-error-in-configure-sh/</guid><description>&lt;p>I’ve downloaded the build/release agent from VSTS page to install in my Ubuntu 16.04 system, but when I tried to run the configuration shell script I got the following error&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Failed to initialize CoreCLR, HRESULT: 0x80131500&lt;/strong> *&lt;/li>
&lt;/ul>
&lt;p>This happens because &lt;strong>I installed the version for Ubuntu 14.04 and not the one specifically compiled for Ubuntu 16.04&lt;/strong>. In my situation the error happened because the download page of my VSTS account does not list the version for Ubuntu 16.04, but only for Ubuntu 14.04 and this incorrectly lead me to the false belief that it works for both versions. The page from where you download the agent is &lt;a href="https://myaccount.visualstudio.com/_admin/_AgentQueue" title="https://prxm.visualstudio.com/_admin/_AgentQueue">https://myaccount.visualstudio.com/_admin/_AgentQueue&lt;/a> and should also list the version for 16.04.&lt;/p></description></item><item><title>New Nuget Task in VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/08/new-nuget-task-in-vsts-build/</link><pubDate>Tue, 22 Aug 2017 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/08/new-nuget-task-in-vsts-build/</guid><description>&lt;p>If you edit a build in VSTS where you configured Nuget Packaging and Publishing, you can notice that all the old tasks to pack and publish are marked as deprecated.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/08/image-18.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/08/image_thumb-18.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/08/image_thumb-18.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Old nuget tasks that are now deprecated.&lt;/em>&lt;/p>
&lt;p>&lt;strong>Deprecating a package is needed when the Author decide to completely replace the entire package, changing also the id&lt;/strong>. This is needed when the task will be completely redesigned and will work in a complete different way from the old version.&lt;/p></description></item><item><title>Mounting network share in Release Definition</title><link>https://www.codewrecks.com/post/old/2017/08/mounting-network-share-in-release-definition/</link><pubDate>Mon, 21 Aug 2017 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/08/mounting-network-share-in-release-definition/</guid><description>&lt;p>Using Deployment Groups with Release Management in VSTS is really nice, because you can use a pull release model, where the agent is running on machines that are deployment target, and all scripts are executed locally (instead of using PowerShell Remoting and WinRM).&lt;/p>
&lt;p>A typical release definition depends on artifacts produced by a build and with VSTS &lt;strong>sometimes it is convenient to store build artifacts in a network share instead that on VSTS.&lt;/strong> This is especially true if, like me, you have a internet connection with really slow upload bandwidth (256 Kbps). Storing artifacts in network share reduce the time needed from the build to upload artifact and the time needed by the release to download them to almost few seconds.&lt;/p></description></item><item><title>Running UAT and integration tests during a VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/08/running-uat-and-integration-tests-during-a-vsts-build/</link><pubDate>Sat, 05 Aug 2017 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/08/running-uat-and-integration-tests-during-a-vsts-build/</guid><description>&lt;p>There are a lots of small suggestions I’ve learned from experience when it is time to create a suite of integration / UAT test for your project. &lt;strong>A UAT or integration test is a test that exercise the entire application, sometimes composed by several services that are collaborating to create the final result.&lt;/strong> The difference from UAT tests and Integration test, in my personal terminology, is that the UAT uses direct automation of User Interface, while an integration tests can skip the UI and exercise the system directly from public API (REST, MSMQ Commands, etc).&lt;/p></description></item><item><title>Dump all environment variables during a TFS VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/08/dump-all-environment-variables-during-a-tfs-vsts-build/</link><pubDate>Fri, 04 Aug 2017 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/08/dump-all-environment-variables-during-a-tfs-vsts-build/</guid><description>&lt;p>Environment variables are really important during a build, especially because all Build variables are stored as environment variables, and this imply that &lt;strong>most of the build context is stored inside them&lt;/strong>. One of the feature I miss most, is the ability to easily visualize on the result of the build a nice list of all the values of Environment variables. We need also to be aware of the fact that tasks can change environment variables during the build, so we need to be able to decide the exact point of the build where we want variables to be dumped.&lt;/p></description></item><item><title>Writing a VSTS TFS task that uses 7zip</title><link>https://www.codewrecks.com/post/old/2017/07/writing-a-vsts-tfs-task-that-uses-7zip/</link><pubDate>Sat, 29 Jul 2017 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/07/writing-a-vsts-tfs-task-that-uses-7zip/</guid><description>&lt;p>Writing a Build / Release task for VSTS / TFS is really simple, but when you need third party software you need to be aware of license issue. &lt;strong>As an example I have a small task that uses 7zip under the hood to compress / extract with the fantastic 7zip format.&lt;/strong> 7zip is good because, even if it uses more processing power to compress files, the result is often really smaller than a standard zip, and this is especially good for build agent that are behind a standard ADSL (300 Kbs upload speed). To create a task that uses 7zip you could simply include 7zip executable in your task, but this can lead to problem for licensing.&lt;/p></description></item><item><title>Deploy test agent and run functional test tasks</title><link>https://www.codewrecks.com/post/old/2017/07/deploy-test-agent-and-run-functional-test-tasks/</link><pubDate>Fri, 14 Jul 2017 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/07/deploy-test-agent-and-run-functional-test-tasks/</guid><description>&lt;p>In VSTS / TFS Build there are a couple of tasks that are really useful to execute UAT or Functional tests during a build. &lt;strong>The first one deploy the test agent remotely on a target machine while the second one runs a set of tests on that machine using the agent.&lt;/strong> If you use multiple Run Functional Test task, please &lt;strong>be sure that before each task there is a corresponding Deploy test agent tasks or you will get an error.&lt;/strong> Actually I have a build that run some functional tests, then I’ve added another Run Functional Test task to run a second sets of functional tests. The result is that the first run does not have a problem, while the secondo one fails with a strange error&lt;/p></description></item><item><title>Publish a website available only in some branches with VSTS build</title><link>https://www.codewrecks.com/post/old/2017/07/publish-a-website-available-only-in-some-branches-with-vsts-build/</link><pubDate>Mon, 03 Jul 2017 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/07/publish-a-website-available-only-in-some-branches-with-vsts-build/</guid><description>&lt;p>I have several builds that publish some web projects using standard msbuild task. Here is a sample configuration.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/07/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/07/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/07/image_thumb.png" alt="Simple image that shows the configuration of a Msbuild Task used to publish a web project." />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Publishing a web site with msbuild task.&lt;/em>&lt;/p>
&lt;p>This is super simple thanks to MsBuild task and a bit of MSBuild arguments, but quite often I face an annoying problem: &lt;strong>what about a new project that lives only on certain branches, but I need to publish in the build only if exists?&lt;/strong> &amp;gt; &lt;strong>Sometimes you need to execute some task in a build only if a file exists on disk (ex: a csproj file)&lt;/strong> Suppose this new Jarvis.Catalog.Web project exists today in a feature called feature/xyz, then the feature will be closed to develop in the future then will be merged to a release branch and finally on master branch. This poses a problem, &lt;strong>the MsBuild task to publish the web project will fail for every branch where that specific web project still does not exists.&lt;/strong> This is super annoying because you can set the build not to fail if this specific task failed, but this will mistakenly mark all build as partially succeeded only because that project still is not on that branch.&lt;/p></description></item><item><title>Use conditional task in VSTS TFS Build</title><link>https://www.codewrecks.com/post/old/2017/06/use-conditional-task-in-vsts-tfs-build/</link><pubDate>Sat, 17 Jun 2017 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/06/use-conditional-task-in-vsts-tfs-build/</guid><description>&lt;p>When you start using Continuous Integration extensively, &lt;strong>some builds become complex and sometimes a simple sequence of task is not what you want.&lt;/strong> Previous build system, based on XAML and Workflow Foundation allows you to specify really complex path of execution, but the side effect is that builds become really complex, they are painful to edit and also, you need to use Visual Studio to edit. Final drawback is that writing and maintaining custom build activities was not so easy, because you need to keep the compiled version in line with build engine version.&lt;/p></description></item><item><title>Running powershell before Get Sources in VSTS TFS Build</title><link>https://www.codewrecks.com/post/old/2017/06/running-powershell-before-get-sources-in-vsts-tfs-build/</link><pubDate>Sat, 10 Jun 2017 13:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/06/running-powershell-before-get-sources-in-vsts-tfs-build/</guid><description>&lt;p>I have a VSTS build where I need to &lt;strong>run a PowerShell scripts at the very beginning of the build, before the agent starts downloading the sources&lt;/strong> , and it seems that this cannot be done with a simple task, because there is no way to place a task before the Get Sources default task of VSTS Build.&lt;/p>
&lt;p>Luckily enough there is a way to solve this problem, because &lt;strong>each task can define a specific script that should be run when the build starts and before each task runs&lt;/strong> , here is how. First of all create a new task with the usual TFX-Cli interface:&lt;/p></description></item><item><title>Troubleshoot a failing build a Winrm story</title><link>https://www.codewrecks.com/post/old/2017/06/troubleshoot-a-failing-build-a-winrm-story/</link><pubDate>Sat, 03 Jun 2017 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/06/troubleshoot-a-failing-build-a-winrm-story/</guid><description>&lt;p>&lt;strong>Many VSTS build and deploy tasks are based on Winrm to operate on a remote machine&lt;/strong> , one of the most common is the “Deploy Test Agent on” that will install a test agent on a remote machine.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image-14.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb-14.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb-14.png" alt="This image shows the deploy test agent task on a standard build" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Task to install a TestAgent on a different machine&lt;/em>&lt;/p>
&lt;p>If you are not in a domain &lt;a href="https://msdn.microsoft.com/en-us/library/aa384426%28v=vs.85%29.aspx">Winrm&lt;/a> can be a really thought opponent, especially because the target machine is not part of the same domain and is not trusted. Usually you configure the build, insert all password but when you run the build you incurr in an error like this one.&lt;/p></description></item><item><title>Publish nuget package during build NET Standard</title><link>https://www.codewrecks.com/post/old/2017/05/publish-nuget-package-during-build-net-standard/</link><pubDate>Mon, 29 May 2017 20:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/publish-nuget-package-during-build-net-standard/</guid><description>&lt;p>In a previous post I dealt with how to build a &lt;a href="http://www.codewrecks.com/blog/index.php/2017/05/24/build-net-standard-multitargeted-solution-in-vsts/">Multitargeted dotnetcore solution in VSTS&lt;/a>, but the build is not really complete unless you are publishing the result somewhere. Since my example was a simple library, the obvious solution is publishing everything to a nuget feed.&lt;/p>
&lt;p>&lt;strong>Publishing with nuget is really really simple with VSTS build system&lt;/strong> , because you should simply use another.NET Core task instance plus a NuGet publisher.&lt;/p></description></item><item><title>Run Pester in VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/05/run-pester-in-vsts-build/</link><pubDate>Sun, 28 May 2017 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/run-pester-in-vsts-build/</guid><description>&lt;p>I’m not a great expert of PowerShell, but during last years I’ve written some custom utilities I’m using for various projects. The main problem is that I’ve scattered all these scripts on multiple projects and usually I need time to find the latest version of a script that does X.&lt;/p>
&lt;blockquote>
&lt;p>Scattering PowerShell scripts all around your projects lead to error and a maintenance nightmare&lt;/p>&lt;/blockquote>
&lt;p>To avoid this problem, &lt;strong>the obvious solution is starting a consolidation of PowerShell scripts and the obvious location is a Git repository hosted in VSTS&lt;/strong>. Now that I’m starting script consolidation, I want also to create some Unit Test With Pester to helps me developing and obviously I want Pester Unit Tests to run inside a VSTS Build.&lt;/p></description></item><item><title>Error during dotnet restore in a VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/05/error-during-dotnet-restore-in-a-vsts-build/</link><pubDate>Sat, 27 May 2017 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/error-during-dotnet-restore-in-a-vsts-build/</guid><description>&lt;p>I’ve a build that runs perfectly on some agents, but fails in others, and the error is in the &lt;strong>dotnet restore&lt;/strong> action. Here is the log of the failure:&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>2017-05-27T10:07:39.3285800Z C:&lt;span style="color:#ae81ff">\P&lt;/span>rogram Files&lt;span style="color:#ae81ff">\d&lt;/span>otnet&lt;span style="color:#ae81ff">\s&lt;/span>dk&lt;span style="color:#ae81ff">\1&lt;/span>.0.4&lt;span style="color:#ae81ff">\N&lt;/span>uGet.targets&lt;span style="color:#f92672">(&lt;/span>97,5&lt;span style="color:#f92672">)&lt;/span>: error : The content at &lt;span style="color:#e6db74">&amp;#39;http://nuget.syncfusion.com/javascript&amp;#39;&lt;/span> is not a valid JSON object. &lt;span style="color:#f92672">[&lt;/span>C:&lt;span style="color:#ae81ff">\v&lt;/span>so&lt;span style="color:#ae81ff">\_&lt;/span>work&lt;span style="color:#ae81ff">\1&lt;/span>4&lt;span style="color:#ae81ff">\s\s&lt;/span>rc&lt;span style="color:#ae81ff">\N&lt;/span>Bus.sln&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2017-05-27T10:07:39.3285800Z C:&lt;span style="color:#ae81ff">\P&lt;/span>rogram Files&lt;span style="color:#ae81ff">\d&lt;/span>otnet&lt;span style="color:#ae81ff">\s&lt;/span>dk&lt;span style="color:#ae81ff">\1&lt;/span>.0.4&lt;span style="color:#ae81ff">\N&lt;/span>uGet.targets&lt;span style="color:#f92672">(&lt;/span>97,5&lt;span style="color:#f92672">)&lt;/span>: error : Unexpected character encountered &lt;span style="color:#66d9ef">while&lt;/span> parsing value: &amp;amp;lt;. Path &amp;amp;&lt;span style="color:#75715e">#039;&amp;amp;#039;, line 0, position 0. [C:\vso\_work\14\s\src\NBus.sln]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2017-05-27T10:07:39.5535786Z &lt;span style="color:#75715e">##[error]Error: C:\Program Files\dotnet\dotnet.exe failed with return code: 1&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>2017-05-27T10:07:39.5545769Z &lt;span style="color:#75715e">##[error]Dotnet command failed with non-zero exit code on the following projects : C:\vso\_work\14\s\src\NBus.sln&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>It turns out that &lt;strong>those specifics agent machines have a global nuget configuration file that adds syncfusion nuget package source to the list of available nuget sources&lt;/strong>. That nuget source probably is not valid for dotnet restore command and the result is that the build is failing because dotnet restore throws errors.&lt;/p></description></item><item><title>Build NET standard multitargeted solution in VSTS</title><link>https://www.codewrecks.com/post/old/2017/05/build-net-standard-multitargeted-solution-in-vsts/</link><pubDate>Wed, 24 May 2017 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/build-net-standard-multitargeted-solution-in-vsts/</guid><description>&lt;p>I have a solution with multitargeting enabled to compile for full framework 4.5.2 and.NetStandard 1.6; it works quite well in Visual Studio, but when it is time to create a VSTS / TFS Build, if you using the standard Visual Studio template you got lots of errors.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Z:&lt;span style="color:#ae81ff">\a\g\_&lt;/span>work&lt;span style="color:#ae81ff">\_&lt;/span>temp&lt;span style="color:#ae81ff">\.&lt;/span>NETStandard,Version&lt;span style="color:#f92672">=&lt;/span>v1.6.AssemblyAttributes.cs &lt;span style="color:#f92672">(&lt;/span>4, 20&lt;span style="color:#f92672">)&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Z:&lt;span style="color:#ae81ff">\a\g\_&lt;/span>work&lt;span style="color:#ae81ff">\_&lt;/span>temp&lt;span style="color:#ae81ff">\.&lt;/span>NETStandard,Version&lt;span style="color:#f92672">=&lt;/span>v1.6.AssemblyAttributes.cs&lt;span style="color:#f92672">(&lt;/span>4,20&lt;span style="color:#f92672">)&lt;/span>: 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Error CS0400: The type or namespace name &lt;span style="color:#e6db74">&amp;#39;System&amp;#39;&lt;/span> could not be found in the global namespace 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">(&lt;/span>are you missing an assembly reference?&lt;span style="color:#f92672">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>This happens because.NET Standard uses NuGet for package management, but the standard Task of NuGet restore does not work with a.NET Standard solution. The fix is simple, &lt;strong>just add a.NET Core Task and ask to issue a dotnet restore command before the standard Visual Studio build&lt;/strong>.&lt;/p></description></item><item><title>Check pull request with build without enforcing pull request</title><link>https://www.codewrecks.com/post/old/2017/05/build-pull-requests-without-policies/</link><pubDate>Sat, 20 May 2017 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/build-pull-requests-without-policies/</guid><description>&lt;p>With TFS / VSTS Build system it is possible to configure Git to require that a &lt;strong>specific branch is protected, and you need to use Pull Requests to push code into it, and the pull request can be accepted only if a specific build is green&lt;/strong>. Here is the typical configuration you can do in admin page for your Git repositories.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image-3.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb-3.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb-3.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Branch policies in VSTS/TFS&lt;/em>&lt;/p>
&lt;p>In &lt;strong>Figure 1&lt;/strong> it is represented the configuration for branch policies; in this specific configuration I require a specific build to run whenever a member create a pull request against develop branch. The effect is: &lt;strong>if a developer try to directly push to develop branch, the push is rejected&lt;/strong>.&lt;/p></description></item><item><title>Using special agent pool for special builds</title><link>https://www.codewrecks.com/post/old/2017/05/using-special-agent-pool-for-special-builds/</link><pubDate>Wed, 10 May 2017 20:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/using-special-agent-pool-for-special-builds/</guid><description>&lt;p>When you use Build to generate artifact for installation or whenever you need a build to validate code with tasks that are not easily runnable on client machine you &lt;strong>can have delay to install patches to your production system&lt;/strong>.&lt;/p>
&lt;p>Lets examine this situation: You have a build that produces artifacts for installation and upload artifacts to VSTS. Then with Release Management you have release plan that deploy in production. &lt;strong>What happens when you need to deploy an hotfix in production?&lt;/strong> &amp;gt; If your deploy is fully automated and you cannot take manual shortcut, you need to have fast build-deploy track for hotfix&lt;/p></description></item><item><title>Maintenance for build agent in TFS Build</title><link>https://www.codewrecks.com/post/old/2017/05/maintenance-for-build-agent-in-tfs-build/</link><pubDate>Sat, 06 May 2017 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/05/maintenance-for-build-agent-in-tfs-build/</guid><description>&lt;p>Each TFS Build agent uses a local directory to download source, do build, prepare artifacts and if you have really high number of builds, you could run out of space in agent disks.&lt;/p>
&lt;p>To minimize this problem VSTS contains a Settings tab in pool configuration that allows scheduling of Agent Maintenance job as you can see in &lt;strong>Figure 1&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2017/05/image_thumb.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Enabling agent schedule mainteinance&lt;/em>&lt;/p>
&lt;p>When an agent perform maintenance basically it deletes all working directory that were not used for more than a certain number of days (default 30). This will allow disk cleanup and you will not waste space for old builds or builds that were migrated to other pools.&lt;/p></description></item><item><title>Update GitVersion for large repositories</title><link>https://www.codewrecks.com/post/old/2017/04/update-gitversion-for-large-repositories/</link><pubDate>Sat, 22 Apr 2017 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/04/update-gitversion-for-large-repositories/</guid><description>&lt;p>As you know I’m a fanatic user of &lt;a href="http://www.codewrecks.com/blog/index.php/2015/10/17/integrating-gitversion-and-gitflow-in-your-vnext-build/">GitVersion&lt;/a> in builds, and &lt;strong>I’ve&lt;/strong> &lt;a href="http://www.codewrecks.com/blog/index.php/2016/03/17/writing-a-custom-task-for-build-vnext/">&lt;strong>written a simple task&lt;/strong>&lt;/a> &lt;strong>to use it in a TFS Build automatically&lt;/strong>. This is the typical task that you write and forget, because it just works and you usually not have the need to upgrade it. But there is a build where I start to see really high execution timing for the task, as an example GitVersion needs 2 minutes to run.&lt;/p></description></item><item><title>Task versioning for TFS VSTS Build</title><link>https://www.codewrecks.com/post/old/2017/02/task-versioning-for-tfs-vsts-build/</link><pubDate>Sat, 04 Feb 2017 13:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/02/task-versioning-for-tfs-vsts-build/</guid><description>&lt;p>The build system of TFS / VSTS, introduced with TFS 2015, is evolving quite fast and release after release is always full of interesting new features. One of my favorites is the &lt;strong>simple extention point to write a custom task to perform custom operation&lt;/strong>. The whole process is really simple and is &lt;a href="http://www.codewrecks.com/blog/index.php/2016/03/17/writing-a-custom-task-for-build-vnext/">described in this post.&lt;/a>&lt;/p>
&lt;p>One of the major problem when you manage a task is versioning, because you can have lots of builds using that task and &lt;strong>if an update require to break the compatibility with the past, releasing a new version can really be a nightmare of many broken build&lt;/strong>.&lt;/p></description></item><item><title>Building with agent without Visual Studio installed</title><link>https://www.codewrecks.com/post/old/2017/01/building-with-agent-without-visual-studio-installed/</link><pubDate>Mon, 16 Jan 2017 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/01/building-with-agent-without-visual-studio-installed/</guid><description>&lt;p>I had a build that runs fine on some agents, then I try running the build on a different agent but the build failed with the error.&lt;/p>
&lt;blockquote>
&lt;p>Error MSB4019: The imported project “C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v14.0\WebApplications\Microsoft.WebApplication.targets” was not found&lt;/p>&lt;/blockquote>
&lt;p>The problem originated by the fact that &lt;strong>the build was configured to compile with VS2015 and use VS2015 test runner, but in build machine the only version of Visual Studio installed is VS2013&lt;/strong>.&lt;/p></description></item><item><title>Manage Environment Variables during a TFS VSTS Build</title><link>https://www.codewrecks.com/post/old/2016/08/manage-environment-variables-during-a-tfs-vsts-build/</link><pubDate>Sat, 06 Aug 2016 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/08/manage-environment-variables-during-a-tfs-vsts-build/</guid><description>&lt;p>To avoid creating unnecessary build definition, it is &lt;strong>a best practice to allow for parameter overriding in every task that can be executed from a build&lt;/strong>. I’ve dealt on how to &lt;a href="http://www.codewrecks.com/blog/index.php/2016/06/25/create-parametrized-test-to-allow-for-simpler-builds/">parametrize tests&lt;/a> to use a different connection string when tests are executed during the build and I’ve used Environment variables for a lot of reasons.&lt;/p>
&lt;p>Environment variables are not source controlled, this allows every developer to override settings in own machine without disturbing other developers. If I do not have a MongoDb in my machine I can simply choose to use some other instance in my network.&lt;/p></description></item><item><title>Create Parametrized test to allow for simpler Builds</title><link>https://www.codewrecks.com/post/old/2016/06/create-parametrized-test-to-allow-for-simpler-builds/</link><pubDate>Sat, 25 Jun 2016 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/06/create-parametrized-test-to-allow-for-simpler-builds/</guid><description>&lt;p>When it is time of running unit test in a TFS or TeamCity Build, often you face the problem to &lt;strong>run tests with options different from those one used in Developer Machine&lt;/strong>. As an example we have tons of tests that requires a MongoDb and and ElasticSearch or Solr integration.&lt;/p>
&lt;p>While it is quite normal for developers to have everything installed in local dev box, &lt;strong>it could be annoying to provide MongoDb and ElasticSearch installed on all agent machines.&lt;/strong> This approach complicates the setup of a build servers and create a situation that is less manageable.&lt;/p></description></item><item><title>No agent could be found with the following capabilities</title><link>https://www.codewrecks.com/post/old/2016/05/no-agent-could-be-found-with-the-following-capabilities/</link><pubDate>Sat, 07 May 2016 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/05/no-agent-could-be-found-with-the-following-capabilities/</guid><description>&lt;p>In TFS 2015 / VSTS new build system &lt;strong>each task contains a series of requirements that needs to be matched by agents capabilities for the task to run&lt;/strong>. Usually you install Visual Studio in the machine with the build agent and you can schedule standard.NET builds without problem, but what happens when the build starts to evolve?&lt;/p>
&lt;p>When you start creating more complex build, you can find that your agent does not meets requirements because it miss some of the required capabilities. As an example, &lt;strong>in TFS 2015 Build I’ve added task to run Sonar Qube Analysis on my code&lt;/strong>.&lt;/p></description></item><item><title>Uploading custom Build Task to TFS 2015</title><link>https://www.codewrecks.com/post/old/2016/04/uploading-custom-build-task-to-tfs-2015/</link><pubDate>Wed, 27 Apr 2016 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/04/uploading-custom-build-task-to-tfs-2015/</guid><description>&lt;p>In a previous article I wrote on &lt;a href="http://www.codewrecks.com/blog/index.php/2016/03/17/writing-a-custom-task-for-build-vnext/">how to write a custom Task For Visual Studio Team Services&lt;/a>, but a usual question is: &lt;strong>can I use the same technique to write a task to TFS 2015 on-premise?&lt;/strong> The answer is yes, and it is really simple, thanks to this fantastic article by Jesse, &lt;strong>that&lt;/strong> &lt;a href="http://blog.jessehouwing.nl/2016/01/publish-build-tasks-to-tfs-2015-without.html">&lt;strong>explain how to use Fiddler to being able to authenticate to on-premise TFS without the hassle of enabling basic authentication&lt;/strong>&lt;/a>. Thanks to that article and Fiddler, you can simply login from tfx-cli to your TFS 2015 without any problem.&lt;/p></description></item><item><title>Adding more than one build agent in VSTS</title><link>https://www.codewrecks.com/post/old/2016/03/adding-more-than-one-build-agent-in-vsts/</link><pubDate>Wed, 30 Mar 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/03/adding-more-than-one-build-agent-in-vsts/</guid><description>&lt;p>Pricing for Build Agents in Visual Studio Team Services states that the &lt;strong>first agent is free, subsequent on-premise agent will cost 15$/month&lt;/strong>. If you, like me, have a demo account, or you want to use &lt;strong>more than one agent not simultaneously&lt;/strong> , you can register more than one agents, and then, from the administration panel, you can disable all agents except one.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2016/03/image-1.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2016/03/image_thumb-1.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2016/03/image_thumb-1.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Leave only one agent enabled at a time to be license compliant&lt;/em>&lt;/p></description></item><item><title>Installing a linux Agent for VSTS build was never so easy</title><link>https://www.codewrecks.com/post/old/2016/03/installing-a-linux-agent-for-vsts-build-was-never-so-easy/</link><pubDate>Wed, 30 Mar 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/03/installing-a-linux-agent-for-vsts-build-was-never-so-easy/</guid><description>&lt;p>If you installed Linux Agents for VSTS vNext build in the past, you already know that it was a simple experience, especially because &lt;strong>the agent was installed with npm&lt;/strong> , so it is a matter of a couple of commands.&lt;/p>
&lt;p>The agent is undergoing a substantial change, and in GitHub there is a project about &lt;a href="https://github.com/Microsoft/vsts-agent/blob/master/README.md">VSTS Cross Platform Agent (CoreCLR)&lt;/a>, &lt;strong>a new version of the agent, entirely written in CoreCLR that will substitute the closed source Windows agent and the actual XPlat agent&lt;/strong>. This version of the agent is still work-in-progress, and we can expect a preview for OSX and Linux in the next month. Until now, to run vNext build on linux, you should use the &lt;a href="https://github.com/Microsoft/vso-agent/blob/master/docs/vsts.md">XPlat Agent&lt;/a>.&lt;/p></description></item><item><title>Writing a custom task for Build vNext</title><link>https://www.codewrecks.com/post/old/2016/03/writing-a-custom-task-for-build-vnext/</link><pubDate>Wed, 16 Mar 2016 23:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/03/writing-a-custom-task-for-build-vnext/</guid><description>&lt;p>I wrote on how to integrate &lt;a href="http://www.codewrecks.com/blog/index.php/2015/10/17/integrating-gitversion-and-gitflow-in-your-vnext-build/">GitFlow and Semantic Versioning for my nuget packages&lt;/a> thanks to GitVersion.exe and a simple powershell script, but still the solution is not perfect. The worst drawback is that you need to remember to include all needed PowerShell scripts and GitVersion.exe executable in project source code. This approach does not give best experience and clutter source code with build related executables.&lt;/p>
&lt;p>Since the script is valid for any project, it would be &lt;strong>a better solution to wrap it in a build task for the new vNext build system&lt;/strong>. Even in this area, the new build system shines, because writing a task is really a breeze.&lt;/p></description></item><item><title>Versioning With Powershell in TFS Build Again</title><link>https://www.codewrecks.com/post/old/2016/02/versioning-with-powershell-in-tfs-build-again/</link><pubDate>Thu, 18 Feb 2016 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/02/versioning-with-powershell-in-tfs-build-again/</guid><description>&lt;p>I just want to link an interesting script to handle versioning in an Assembly Build created by Brad Foster. It does lots of stuff and it is an interesting example on how to interact with TFS with powershell.&lt;/p>
&lt;p>You can find the script &lt;a href="https://github.com/voice4net/build-scripts/blob/master/ApplyVersionFromSourceControl.ps1">here in GitHub&lt;/a>.&lt;/p>
&lt;p>Gian Maria.&lt;/p></description></item><item><title>Package manager in VSTS</title><link>https://www.codewrecks.com/post/old/2016/02/package-manager-in-vsts/</link><pubDate>Fri, 12 Feb 2016 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/02/package-manager-in-vsts/</guid><description>&lt;p>One of the cool feature of Visual Studio Team Services is extendibility, you can also find lots of addin in official &lt;a href="https://marketplace.visualstudio.com/">Marketplace&lt;/a>. One of the coolest addin you can find there is an official addin by Microsoft and allows you to &lt;strong>host a private Nuget Packages inside your VSTS account&lt;/strong>. You can find the Addin here: &lt;a href="https://marketplace.visualstudio.com/items?itemName=ms.feed" title="https://marketplace.visualstudio.com/items?itemName=ms.feed">https://marketplace.visualstudio.com/items?itemName=ms.feed&lt;/a> it is free and can be installed with a couple of simple clicks.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image_thumb.png" alt="image" />&lt;/a>&lt;/a>&lt;/p></description></item><item><title>View results of deleted builds in VSTS</title><link>https://www.codewrecks.com/post/old/2016/02/view-results-of-deleted-builds-in-vsts/</link><pubDate>Sat, 06 Feb 2016 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/02/view-results-of-deleted-builds-in-vsts/</guid><description>&lt;p>One of the nice new feature of the new build system (vNext) introduced in VSTS is the &lt;strong>ability to view result summary for deleted builds&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image6.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image_thumb6.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2016/02/image_thumb6.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>View Deleted builds from VSTS&lt;/em>&lt;/p>
&lt;p>Clearly not all data is maintained, &lt;strong>you cannot retrieve artifacts or logs&lt;/strong> , so you cannot troubleshoot a failed build, but at least you are able to view build outcome, who triggered it and some global data such as test result summary.&lt;/p></description></item><item><title>Different approaches for publishing Artifacts in build vNext</title><link>https://www.codewrecks.com/post/old/2016/01/different-approaches-for-publishing-artifacts-in-build-vnext/</link><pubDate>Sat, 30 Jan 2016 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/01/different-approaches-for-publishing-artifacts-in-build-vnext/</guid><description>&lt;p>I’ve wrote an old post that explain how you can &lt;a href="http://www.codewrecks.com/blog/index.php/2015/06/30/manage-artifacts-with-tfs-build-vnext/">manage your artifacts with Build vNext&lt;/a>, in that post I suggested to use a custom PowerShell script that identify all of your files that needs to be published as artifacts, and move everything inside the Staging Directory.&lt;/p>
&lt;p>I believe that &lt;strong>this is the perfect approach for complex application, where we have some logic to be applied before publishing an artifact&lt;/strong> , also it is super easy to compress everything with 7Zip to reduce the usage of your Upload Bandwidth if you have on-premises agent that needs to publish on VSTS (or simply because you want to save space in your shared folder used as a drop folder).&lt;/p></description></item><item><title>Versioning assembly with powershell and build vNext</title><link>https://www.codewrecks.com/post/old/2016/01/versioning-assembly-with-powershell-and-build-vnext/</link><pubDate>Fri, 29 Jan 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/01/versioning-assembly-with-powershell-and-build-vnext/</guid><description>&lt;p>In an old blog post I explained how to &lt;a href="http://www.codewrecks.com/blog/index.php/2014/01/11/customize-tfs-2013-build-with-powershell-scripts/">version  assembly  during TFS 2013 build with Powershell Scripts&lt;/a>. The goal is &lt;strong>modifying assemblyinfo.cs and assemblyinfo.vb with PowerShell in a TFS 2013 build&lt;/strong> for a project based on TFVC. If you are interested in Git I’ve &lt;a href="http://www.codewrecks.com/blog/index.php/2015/10/17/integrating-gitversion-and-gitflow-in-your-vnext-build/">other post on the subject&lt;/a>.&lt;/p>
&lt;p>Now that the build system is changed in Visual Studio Team Services and in TFS 2015, people asked me to &lt;strong>update that scripts to work with the new build system&lt;/strong>. It turns out that the work needed to update the scripts is only one line of code, because an environment variable is changed between the two build system, but all the rest remains equal.&lt;/p></description></item><item><title>Troubleshoot Error TF14044 in build vNext for TFS2015</title><link>https://www.codewrecks.com/post/old/2016/01/troubleshoot-error-tf14044-in-build-vnext-for-tfs2015/</link><pubDate>Fri, 15 Jan 2016 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/01/troubleshoot-error-tf14044-in-build-vnext-for-tfs2015/</guid><description>&lt;p>I upgraded a TFS2012 to TFS2015 Update 1 at a customer site and &lt;strong>one of the reason why the customer want to upgrade is the new build system introduced in TFS 2015&lt;/strong>. Sadly enough, after the upgrade we created a simple build but it failed returning a permission error.&lt;/p>
&lt;blockquote>
&lt;p>TF14044: Access Denied: User Project Collection Build Service (TEAM FOUNDATION) needs the CreateWorkspace global permission(s).&lt;/p>&lt;/blockquote>
&lt;p>We were really puzzled, because the user used to run the build (TFSBuild) was correctly set into the Project Collection Build Service account, and that group has all the permissions to create a workspace. We double check permissions for TFSBuild and Project Collection Build Service account and everything is ok, still the error was there.&lt;/p></description></item><item><title>Deploying a click-once application with build vNext in Azure Blob Storage</title><link>https://www.codewrecks.com/post/old/2015/12/rename-xmlrpc-php-on-your-wordpress-installation-2/</link><pubDate>Wed, 30 Dec 2015 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/12/rename-xmlrpc-php-on-your-wordpress-installation-2/</guid><description>&lt;p>Thanks to the new build system in TFS / VSTS, publishing an application with Click-once during a build is really simple.&lt;/p>
&lt;h2 id="versioning-the-click-once-app">Versioning the click-once app&lt;/h2>
&lt;h2>&lt;/h2>
&lt;p>The project is using Git and GitFlow, thus it comes natural &lt;strong>to use GitVersion (as described in a&lt;/strong> &lt;a href="http://www.codewrecks.com/blog/index.php/2015/10/17/integrating-gitversion-and-gitflow-in-your-vnext-build/">&lt;strong>previous post&lt;/strong>&lt;/a> &lt;strong>) to automatically add Semantic Versioning&lt;/strong>. In previous post I’ve demonstrated how to use this technique to publish Nuget Packages and nothing changes for Click Once applications.&lt;/p></description></item><item><title>Use the right Azure Service Endpoint in build vNext</title><link>https://www.codewrecks.com/post/old/2015/12/use-the-right-azure-service-endpoint-in-build-vnext/</link><pubDate>Tue, 29 Dec 2015 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/12/use-the-right-azure-service-endpoint-in-build-vnext/</guid><description>&lt;p>Build vNext has a &lt;strong>task dedicated to uploading files in azure blob&lt;/strong> , as you can see from &lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image2.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image_thumb2.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image_thumb2.png" alt="Sample build vNext that has an Azure File Copy task configured." />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Azure File Copy task configured in a vNext build&lt;/em>&lt;/p>
&lt;p>The nice parte is the Azure Subscription setting, that allows to choose one of the Azure endpoint configured for the project. Using service endpoint, you can ask to the person that has password/keys for Azure Account to configure an endpoint. Once it is configured &lt;strong>it can be used by team members with sufficient right to access it, without requiring them to know password or token or whatever else&lt;/strong>.&lt;/p></description></item><item><title>Save a build as a Draft</title><link>https://www.codewrecks.com/post/old/2015/12/save-a-build-as-a-draft/</link><pubDate>Tue, 01 Dec 2015 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/12/save-a-build-as-a-draft/</guid><description>&lt;p>There are a lots of interesting new features in TFS / VSTS Build vNext, but surely, one of the coolest one is the &lt;strong>ability to edit a build and save as a draft&lt;/strong>. Actually available only in the online version (Visual Studio Team Services)&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image_thumb.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2015/12/image_thumb.png" alt="Saving build as a draft" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Saving a build as a Draft&lt;/em>&lt;/p>
&lt;p>Actually, saving build as a draft allows you to &lt;strong>edit a build, try a new configuration / task / personalization, without distrupt the old build that works&lt;/strong>. Customizing a build can be a difficult task, and the greatest risk with older build System is having an unusable build until the new personalization is done.&lt;/p></description></item><item><title>Integrating GitVersion and Gitflow in your vNext Build</title><link>https://www.codewrecks.com/post/old/2015/10/integrating-gitversion-and-gitflow-in-your-vnext-build/</link><pubDate>Sat, 17 Oct 2015 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/10/integrating-gitversion-and-gitflow-in-your-vnext-build/</guid><description>&lt;p>In previous article I’ve showed how to create a VSO build vNext to automatically publish a nuget package to Myget (or nuget) during a build. &lt;a href="http://www.codewrecks.com/blog/index.php/2015/09/26/publishing-a-nuget-package-to-nugetmyget-with-vso-build-vnext/">[Publishing a Nuget package to Nuget/Myget with VSO Build vNext]&lt;/a>. Now it is time to create a &lt;strong>more interesting build that automatically version your assemblies and nuget packages based on&lt;/strong> &lt;a href="http://nvie.com/posts/a-successful-git-branching-model/">&lt;strong>GitFlow&lt;/strong>&lt;/a>.&lt;/p>
&lt;h2 id="gitflow-and-gitversion">GitFlow and GitVersion&lt;/h2>
&lt;p>&lt;strong>GitFlow is a simple convention to manage your branches&lt;/strong> in your Git repository to support a production branch, a developement branch and Feature/Support/Release/hotfix branches. If you are completely new on the subject you can find information at the following locations:&lt;/p></description></item><item><title>Publishing a Nuget package to NugetMyget with VSO Build vNext</title><link>https://www.codewrecks.com/post/old/2015/09/publishing-a-nuget-package-to-nugetmyget-with-vso-build-vnext/</link><pubDate>Sat, 26 Sep 2015 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/09/publishing-a-nuget-package-to-nugetmyget-with-vso-build-vnext/</guid><description>&lt;p>Publishing a package to myget or nuget with a TFS/VSO vNext build is a breeze. First of all you should &lt;strong>create a&lt;/strong> &lt;a href="https://docs.nuget.org/create/nuspec-reference">&lt;strong>.nuspec file&lt;/strong>&lt;/a> &lt;strong>that specify everything about your package and include it in your source control&lt;/strong>. Then Add a variable to the build called NugetVersion as shown in &lt;strong>Figure 1.&lt;/strong> &lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image6.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb6.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2015/09/image_thumb6.png" alt="Adding NugetVersion variable to the list of variables for this build." />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Added NugetVersion variable to build definition.&lt;/em>&lt;/p>
&lt;p>In this build I disabled continuous integration, because I want to publish my package only when I decided that the code is good enough to be published. Publishing to a feed for each build is usually a waste of resources and a nice way to make the history of your package a pain. Since I want to do manual publishing I’ve checked the &lt;strong>“Allow at Queue Time” checkbox, to be able to change Nuget Version Number at queue time.&lt;/strong> &lt;strong>Build vNext has a dedicated step called NugetPackager that takes care of creating your package from nuspec file&lt;/strong> , so you do not need to include nuget.exe in your repository or in the server. If you are curious where is nuget.exe stored, you can check installation folder of your build agent, and browse the Task Directory where all the tasks are contained. There you should find the NugetPackager folder where all the script used by the tasks are stored.&lt;/p></description></item><item><title>Manage Artifacts with TFS Build vNext</title><link>https://www.codewrecks.com/post/old/2015/06/manage-artifacts-with-tfs-build-vnext/</link><pubDate>Tue, 30 Jun 2015 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/06/manage-artifacts-with-tfs-build-vnext/</guid><description>&lt;h2 id="artifacts-and-build-vnext">Artifacts and Build vNext&lt;/h2>
&lt;p>Another big improvement of Build vNext in TFS and VSO is the ability to **explicitly manage the content of &lt;em>artifacts&lt;/em>during a build **. With the term Artifacts in Continuous Integration we are referring to every result of of the build that is worth publishing together with build result, to be further consumed by consumers of the build. Generally speaking think to artifacts as build binary outputs.&lt;/p></description></item><item><title>Build vNext and continuous integration on GitHub</title><link>https://www.codewrecks.com/post/old/2015/06/build-vnext-and-continuous-integration-on-github/</link><pubDate>Mon, 08 Jun 2015 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/06/build-vnext-and-continuous-integration-on-github/</guid><description>&lt;p>One of the great &lt;strong>news of build vNext is the ability to create a build that targets source on GitHub project&lt;/strong> , not only on Git or TFVC repositories that are in current TFS or VSO instance. Given this, plus the fact that VSO has a 5 basic user license for Free, and you can use VSO as Continuous integration Engine for your GitHub projects.&lt;/p>
&lt;p>To create a build that targets GitHub source code, you should simply login into your GitHub account, then navigate in your personal settings and finally choose “Personal Access tokens”&lt;/p></description></item><item><title>Build vNext distributing load to different agents</title><link>https://www.codewrecks.com/post/old/2015/06/build-vnext-distributing-load-to-different-agents/</link><pubDate>Sat, 06 Jun 2015 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/06/build-vnext-distributing-load-to-different-agents/</guid><description>&lt;p>One of the major benefit of the new build infrastructure of TFS and Visual Studio Online is the &lt;strong>easy deployment of build agents&lt;/strong>. The downside of this approach is that your infrastructure become full of agents, and you should have some way to &lt;strong>determine which agent(s) to use for a specific build.&lt;/strong> The problem is:&lt;/p>
&lt;blockquote>
&lt;p>avoid running builds in machines that are “not appropriate” for that build.&lt;/p>&lt;/blockquote>
&lt;h2 id="running-on-a-specific-agent">Running on a specific agent&lt;/h2>
&lt;p>If you are customizing a build, or if you are interested in running the build on a specific agent in a specific machine (ex: local agent), the solution is super easy, Just edit build definition and in General tab add a * &lt;strong>demand&lt;/strong> *named Agent.Name with the value of the name of the specified Agent.&lt;/p></description></item><item><title>TFS New Build System vNext agents</title><link>https://www.codewrecks.com/post/old/2015/06/tfs-new-build-system-vnext-agents/</link><pubDate>Wed, 03 Jun 2015 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/06/tfs-new-build-system-vnext-agents/</guid><description>&lt;p>&lt;strong>With the latest Visual Studio Online update, the new build system is now online for all users&lt;/strong>. As I said in old post, it is completely rewritten and covering all new features really requires lots of time. Since I’m a great fan of Continuous Integration and Continuous Deploy procedures I’d like to do some post to introduce you this new build system, along with the reason why it is really superior to the old one.&lt;/p></description></item><item><title>VSO vNext build error You cannot run the vsoAgentexe interactively</title><link>https://www.codewrecks.com/post/old/2015/05/vso-vnext-build-error-you-cannot-run-the-vsoagent-exe-interactively/</link><pubDate>Sat, 23 May 2015 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/05/vso-vnext-build-error-you-cannot-run-the-vsoagent-exe-interactively/</guid><description>&lt;ul>
&lt;li>&lt;strong>Error Symptom&lt;/strong> *: &lt;em>You installed and configured an Agent for the new Visual Studio Online Build System, and you decided not to run as a service, but interactively. When you double click the VsoAgent.exe executable you got this error.&lt;/em>&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>You cannot run the vsoAgent.exe interactively from within the Agent folder. Try running it from the parent folder&lt;/p>&lt;/blockquote>
&lt;p>I’ve encountered this error on my main workstation machine, and I’m not sure why I got this error. Actually I’ve configured agent for TFS 2015 RC without this problem and &lt;strong>in the same machine I got three distinct agents, but only the one targeting my VSO primary account is having this problem&lt;/strong>.&lt;/p></description></item><item><title>Tfs2015 Build agent error Access denied xxxxxyyyyy needs Listen permissions for pool zzzzz to perform the action</title><link>https://www.codewrecks.com/post/old/2015/05/tfs2015-build-agent-error-access-denied-xxxxxyyyyy-needs-listen-permissions-for-pool-zzzzz-to-perform-the-action/</link><pubDate>Sat, 09 May 2015 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/05/tfs2015-build-agent-error-access-denied-xxxxxyyyyy-needs-listen-permissions-for-pool-zzzzz-to-perform-the-action/</guid><description>&lt;p>Tfs 2015 introduces a completely new and redesigned build system and one of the most important change is &lt;strong>new lightweight agent system&lt;/strong>. Instead of installing TFS and then configure Build, &lt;strong>to create a new agent you only need to download a zip file, uncompress and launch a PowerShell script.&lt;/strong> Another great advantage is the ability to run the agent as a service, or running it interactively in a simple console application.&lt;/p></description></item></channel></rss>