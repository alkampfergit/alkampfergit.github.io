<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NoSql on Codewrecks</title><link>https://www.codewrecks.com/categories/nosql/</link><description>Recent content in NoSql on Codewrecks</description><generator>Hugo</generator><language>en</language><lastBuildDate>Thu, 27 May 2021 20:00:00 +0200</lastBuildDate><atom:link href="https://www.codewrecks.com/categories/nosql/index.xml" rel="self" type="application/rss+xml"/><item><title>Keep MongoDb logfile size at bay</title><link>https://www.codewrecks.com/post/general/mongo-db-logfiles/</link><pubDate>Thu, 27 May 2021 20:00:00 +0200</pubDate><guid>https://www.codewrecks.com/post/general/mongo-db-logfiles/</guid><description>&lt;p>MongoDb is a great option for NoSql but sometimes it is installed in production forgetting some basic maintenance tasks, like managing log files. You should remember that &lt;a href="https://docs.mongodb.com/manual/tutorial/rotate-log-files/">MongoDb does not automatically rotate log files&lt;/a> as for official documentation.&lt;/p>
&lt;p>This lead to logfiles of Gigabyte size and sometimes they can even be a space problem in your installation. If a &lt;strong>logfile is gone out of control, you cannot delete because it is in use by mongod process, so you need to ask for a manual rotate&lt;/strong>. Just connect to mongodb instance and from mongo.exe command line or any other tool you use issue this command.&lt;/p></description></item><item><title>How to fix 'No matching creator found' mongodb error after upgrade</title><link>https://www.codewrecks.com/post/nosql/replace-immutable-serializer-in-mongodb/</link><pubDate>Sat, 15 Aug 2020 08:00:00 +0200</pubDate><guid>https://www.codewrecks.com/post/nosql/replace-immutable-serializer-in-mongodb/</guid><description>&lt;p>Even if Release changes seems to have no breaking changes in MongodDb Driver latest upgrade, it is possible that your code could be affected by a change in the driver and you &lt;strong>starts having strange exception with code that works perfectly with an older version of the driver&lt;/strong>.&lt;/p>
&lt;blockquote>
&lt;p>I&amp;rsquo;ve a big project where after updating from 2.7.3 driver to 2.11.0 MongoDb driver I&amp;rsquo;ve started having all sort of weird errors that disappear restoring 2.7.3 of the driver.&lt;/p></description></item><item><title>Error in mapping MongoDb classes after updating to 2.10 driver</title><link>https://www.codewrecks.com/post/general/error-in-mongodb-serializer/</link><pubDate>Thu, 02 Jul 2020 10:17:25 +0200</pubDate><guid>https://www.codewrecks.com/post/general/error-in-mongodb-serializer/</guid><description>&lt;p>After updating a big project from MongoDb C# driver 2.7 to latest 2.10 version I started having lots of error on Integration tests.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>MongoDB.Bson.BsonSerializationException
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> HResult=&lt;span style="color:#ae81ff">0x80131500&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Message=Creator map &lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">TestMongoBug&lt;/span>.TestArray has &lt;span style="color:#ae81ff">2&lt;/span> arguments, but none are configured.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Source=MongoDB.Bson
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> StackTrace:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at MongoDB.Bson.Serialization.BsonCreatorMap.Freeze()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at MongoDB.Bson.Serialization.BsonClassMap.Freeze()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at MongoDB.Bson.Serialization.BsonClassMap.LookupClassMap(Type classType)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at MongoDB.Bson.Serialization.BsonClassMapSerializationProvider.GetSerializer(Type type, IBsonSerializerRegistry serializerRegistry)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at MongoDB.Bson.Serialization.BsonSerializerRegistry.CreateSerializer(Type type)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> at System.Collections.Concurrent.ConcurrentDictionary&lt;span style="color:#960050;background-color:#1e0010">`&lt;/span>&lt;span style="color:#ae81ff">2.&lt;/span>GetOrAdd(TKey key, Func&lt;span style="color:#960050;background-color:#1e0010">`&lt;/span>&lt;span style="color:#ae81ff">2&lt;/span> valueFactory)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;p>The stack trace is especially strange, because it &lt;strong>reveals that the error happens when the BsonClkassMap is trying to create mapping for the object&lt;/strong>. The error message is also really strange&lt;/p></description></item><item><title>Store a function to delete all db in MongoDb</title><link>https://www.codewrecks.com/post/old/2017/06/store-a-function-to-delete-all-db-in-mongodb/</link><pubDate>Wed, 28 Jun 2017 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/06/store-a-function-to-delete-all-db-in-mongodb/</guid><description>&lt;p>Deleting everything in a test MongoDb is a common operation for test and dev machine and it is a relative simple operation that &lt;a href="http://www.codewrecks.com/blog/index.php/2017/06/24/delete-all-mongo-db-except-admin-and-local/">I described here&lt;/a>. After a little while &lt;strong>I got really tired every time to search my gist or into my hd the little script that deletes everything&lt;/strong> , thus I decided to store it inside the admin db.&lt;/p>
&lt;p>The solution is really really simple, &lt;strong>just connect to the admin database and register a server side function to delete all databases&lt;/strong>.&lt;/p></description></item><item><title>Delete all mongo db except admin and local</title><link>https://www.codewrecks.com/post/old/2017/06/delete-all-mongo-db-except-admin-and-local/</link><pubDate>Sat, 24 Jun 2017 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2017/06/delete-all-mongo-db-except-admin-and-local/</guid><description>&lt;p>When you develop with mongo, sometimes &lt;strong>you simply need to delete all database quickly because you need to start from scratch&lt;/strong>. Using shell is really simple, because &lt;a href="https://gist.github.com/alkampfergit/f9fe4f38c85e04f899fe4e4c20f6979a">this gist&lt;/a>  does exactly what you need.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">dbs&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">getMongo&lt;/span>().&lt;span style="color:#a6e22e">getDBNames&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">for&lt;/span>(&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#66d9ef">in&lt;/span> &lt;span style="color:#a6e22e">dbs&lt;/span>){
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">db&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">getMongo&lt;/span>().&lt;span style="color:#a6e22e">getDB&lt;/span>( &lt;span style="color:#a6e22e">dbs&lt;/span>[&lt;span style="color:#a6e22e">i&lt;/span>] );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">getName&lt;/span>() &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;admin&amp;#39;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">getName&lt;/span>() &lt;span style="color:#f92672">!==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;local&amp;#39;&lt;/span>) 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">print&lt;/span>( &lt;span style="color:#e6db74">&amp;#34;dropping db &amp;#34;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">getName&lt;/span>() ); 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">dropDatabase&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>This snippet is a little bit smarter than deleting everything, because &lt;strong>it keeps safe Local and Admin database&lt;/strong> , and this will preserve users of the database. I always suggest people to develop &lt;a href="http://www.codewrecks.com/blog/index.php/2016/05/19/secure-your-mongodb-installation/">with authentication enabled&lt;/a>, it is a good way to avoid forgetting to secure your production mongo installation and exposing your data at risk.&lt;/p></description></item><item><title>Bulk insert in MongoDb with C driver</title><link>https://www.codewrecks.com/post/old/2016/11/bulk-insert-in-mongodb-with-c-driver/</link><pubDate>Wed, 02 Nov 2016 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/11/bulk-insert-in-mongodb-with-c-driver/</guid><description>&lt;p>There are situation where you need to &lt;strong>save a lot of documents inside a collection in MongoDb&lt;/strong>. My scenario is a migration of documents from a collection to another database, with in-memory manipulation of the documents.&lt;/p>
&lt;p>The most common error in these situation is to read the documents from the original collection, then execute a function that modify the document in-memory, and finally issuing an insert in destination collection. This is wrong because you have a roundrip against MongoDb for each document you are saving.&lt;/p></description></item><item><title>Long numbers are truncated in MongoDb shell</title><link>https://www.codewrecks.com/post/old/2016/06/long-numbers-are-truncated-in-mongodb-shell/</link><pubDate>Thu, 02 Jun 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/06/long-numbers-are-truncated-in-mongodb-shell/</guid><description>&lt;p>Let’s try this simple code in a mongo shell:&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">TestCollection&lt;/span>.&lt;span style="color:#a6e22e">insert&lt;/span>({&lt;span style="color:#e6db74">&amp;#34;_id&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Value&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">NumberLong&lt;/span>(&lt;span style="color:#ae81ff">636002954392732556&lt;/span>) })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">TestCollection&lt;/span>.&lt;span style="color:#a6e22e">find&lt;/span>()&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>What you expect is that mongo inserted one record and then that record is returned. Actually a record is inserted, but &lt;strong>the return value can surprise you&lt;/strong>. Here is the output I got from RoboMongo&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;_id&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1.0&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;Value&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#a6e22e">NumberLong&lt;/span>(&lt;span style="color:#ae81ff">636002954392732544&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>&lt;strong>Property “Value” has not the number you inserted, the number seems to be rounded and some precision is lost&lt;/strong> , even if it is a NumberLong and 636002954392732556 is a perfectly valid Int64 number. This behavior surprised me, because I’m expecting rounding to happen only with double, not with an Int64.&lt;/p></description></item><item><title>Grant right to use eval on Mongodb 32</title><link>https://www.codewrecks.com/post/old/2016/05/grant-right-to-use-eval-on-mongodb-3-2/</link><pubDate>Sat, 21 May 2016 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/05/grant-right-to-use-eval-on-mongodb-3-2/</guid><description>&lt;p>One of the side effect of enabling authorization on MongDb is that, &lt;strong>even if you create a user with “root” right, this account is not able to execute the $eval command&lt;/strong>. The simpthom is, when you try to execute $eval you got this error&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>mongodb Command &lt;span style="color:#e6db74">&amp;#39;$eval&amp;#39;&lt;/span> failed: not authorized on jarvis-framework-saga-test to execute command&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>This happens because $eval is somewhat deprecated, and it should not be used. Since it is a dangerous command, a user should have access to all action on all resources, and you need to create a role that has anyAction on anyResource.&lt;/p></description></item><item><title>Secure your MongoDb installation</title><link>https://www.codewrecks.com/post/old/2016/05/secure-your-mongodb-installation/</link><pubDate>Thu, 19 May 2016 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/05/secure-your-mongodb-installation/</guid><description>&lt;p>In last months a lots of rumor spreads about &lt;a href="http://thehackernews.com/2015/07/MongoDB-Database-hacking-tool.html">MongoDb and Data Leak&lt;/a> because &lt;strong>people found lots of MongoDb exposed on the internet&lt;/strong> &lt;a href="http://thehackernews.com/2015/02/mongodb-database-hacking.html">&lt;strong>without any protection&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>The root of the problem is probably a bad default for MongoDb that actually starts without any autentication by default. Developers usually download mongodb, configure without authentication and access MongoDb instance without any knowledge of MongoDb security model. This simplicity of usage can lead to unsecure installation in production.&lt;/p></description></item><item><title>'Unsupported filter' using ContainsAny in Mongo 2x driver</title><link>https://www.codewrecks.com/post/old/2016/04/unsupported-filter-using-containsany-in-mongo-2-x-driver/</link><pubDate>Tue, 26 Apr 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/04/unsupported-filter-using-containsany-in-mongo-2-x-driver/</guid><description>&lt;p>Porting code from Legacy driver to new driver syntax is quite annoying for.NET MongoDb driver. In the new Drivers almost everything is changed, and unless you want to still use old legacy syntax creating a mess of new and old syntax, you should convert all the code to the new syntax.&lt;/p>
&lt;p>One of the annoying problem is ContainsAny in LINQ compatibility driver. In old drivers, if you have an object that contains an array of strings, and you want to filter for objects that have at least one of the value contained in a list of allowed values you had to resort to this syntax.&lt;/p></description></item><item><title>Change how MongoDb C Driver serialize Guid in new driver version</title><link>https://www.codewrecks.com/post/old/2016/04/change-how-mongodb-c-driver-serialize-guid-in-new-driver-version/</link><pubDate>Fri, 15 Apr 2016 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2016/04/change-how-mongodb-c-driver-serialize-guid-in-new-driver-version/</guid><description>&lt;p>We have code based on the old legacy mongo driver that uses MemberSerializationOptionsConvention class to serialize all Guid as plain strings. This option is really useful because &lt;strong>saving Guid in Bson format is often source of confusion (CSUUID, … ) for.NET users.&lt;/strong> On the contrary, having saving Guid as plain string solves some pain and made your Bson really more readable.&lt;/p>
&lt;p>Here is the old code that runs with the old legacy driver.&lt;/p></description></item><item><title>Why Irsquom not a great fan of LINQ query for MongoDb</title><link>https://www.codewrecks.com/post/old/2015/09/why-im-not-a-great-fan-of-linq-query-for-mongodb/</link><pubDate>Sat, 26 Sep 2015 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/09/why-im-not-a-great-fan-of-linq-query-for-mongodb/</guid><description>&lt;p>I’m not a great fan of LINQ provider in Mongo, because I think that &lt;strong>developers that start using only LINQ misses the best part of working with a Document Database&lt;/strong>. The usual risk is: developer always resort to LINQ queries to load-modify-save a document instead of using all &lt;a href="https://docs.mongodb.org/manual/reference/operator/update/">powerful update operators available in Mongo&lt;/a>.&lt;/p>
&lt;p>Despite this consideration, if you need to retrieve full document content, sometimes writing a LINQ query is the simplest approach, but, as always, not every valid LINQ statement you can write can be translated to MongoQuery. This is the situation of this query.&lt;/p></description></item><item><title>Start ElasticSearch in windows with a different configuration file</title><link>https://www.codewrecks.com/post/old/2015/09/start-elasticsearch-in-windows-with-a-different-configuration-file/</link><pubDate>Thu, 24 Sep 2015 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/09/start-elasticsearch-in-windows-with-a-different-configuration-file/</guid><description>&lt;p>When you start elasticsearch double clicking on Elasticsearch.bat in windows, it uses the standard config/elasticsearch.yml files that is contained in the installation directory. Especially for development, &lt;strong>it is really useful to be able to start ES with different configuration file&lt;/strong>.&lt;/p>
&lt;p>Probably my googleFu is not perfect, but each time that I need to find the correct option to pass to Elasticsearch.bat batch file I’m not able to find with the first search and I always loose some time, and this means that probably this information is not indexed perfectly.&lt;/p></description></item><item><title>Mongo compression with Wired Tiger Engine</title><link>https://www.codewrecks.com/post/old/2015/09/mongo-compression-with-wired-tiger-engine/</link><pubDate>Tue, 08 Sep 2015 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/09/mongo-compression-with-wired-tiger-engine/</guid><description>&lt;p>With 3.0 version of Mongo database the most welcomed feature was the introduction of &lt;strong>pluggable storage engine&lt;/strong>. This imply that we are not forced to use standard NMAPv1 storage system, but we can use other way of storing data on our filesystem. &lt;strong>The first &lt;em>and official&lt;/em> alternative storage system is &lt;a href="http://www.wiredtiger.com/">Wired Tiger&lt;/a>&lt;/strong>.&lt;/p>
&lt;p>One of the most interesting aspect of Wired Tiger is &lt;a href="https://www.mongodb.com/blog/post/new-compression-options-mongodb-30">&lt;em>Data Compression&lt;/em>&lt;/a>, a feature that can reduce the space of your database on disk, and that is especially effective since Mongo stores document as BSON, where most of the data is text. &lt;strong>Wired Tiger has three options for compression: &lt;em>none, snappy and zlib&lt;/em>&lt;/strong>*,*bug even with none compression, the space occupied by your database on disk is usually lower than NMAPv1. Here is a simple and quick test done on a customer database.&lt;/p></description></item><item><title>Mixing native query and LINQ in Mongo Query</title><link>https://www.codewrecks.com/post/old/2015/04/mixing-native-query-and-linq-in-mongo-query/</link><pubDate>Tue, 21 Apr 2015 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/04/mixing-native-query-and-linq-in-mongo-query/</guid><description>&lt;p>Lets look at the following query issued to a standard MongoCollection&amp;lt;T&amp;gt; instance object:&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-csharp" data-lang="csharp">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">return&lt;/span> _bufferCollection.Find(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> GetNextBlockQuery(lastTick, lastRevisionId))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .OrderBy(d =&amp;gt; d.LastUpdated)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .ThenBy(d =&amp;gt; d.RevisionIdNumeric);&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>The method GetNextBlockQuery simply return a Query&amp;lt;T&amp;gt; query object expressed with C# mongo query syntax. In this query &lt;strong>the result of Find() method is simply sorted using standard LINQ syntax&lt;/strong>.&lt;/p></description></item><item><title>Upgrading ReplicaSet with MMS</title><link>https://www.codewrecks.com/post/old/2015/02/upgrading-replicaset-with-mms/</link><pubDate>Sat, 07 Feb 2015 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2015/02/upgrading-replicaset-with-mms/</guid><description>&lt;p>My RS of three mongo instances is running mongo 2.6.6 and now I want to upgrade to the latest version. Thanks to &lt;a href="https://mms.mongodb.com">mms&lt;/a>  &lt;strong>I can simply start the upgrade process directly from a web page, without needing to have an access to my real servers&lt;/strong>. The real good stuff is that the upgrade process is completely managed by mms for me, and the upgrade is done without stopping my Replica Set.&lt;/p></description></item><item><title>Upgrade your agents and instances with Mms</title><link>https://www.codewrecks.com/post/old/2014/11/upgrade-your-agents-and-instances-with-mms/</link><pubDate>Fri, 21 Nov 2014 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/11/upgrade-your-agents-and-instances-with-mms/</guid><description>&lt;p>Another big advantages of using MMS to manage your mongo deployments is the ability to &lt;strong>automatic upgrade agents and instances&lt;/strong>. For agents you can simply open the deployment area of a group and select edit mode. If some agent is outdated, the interface will immediately warn you with an alert on the top of the page as you can see in &lt;strong>Figure 1&lt;/strong>.&lt;/p>
&lt;p>&lt;a href="https://www.codewrecks.com/blog/wp-content/uploads/2014/11/image8.png">&lt;a target="_blank" href="https://www.codewrecks.com/blog/wp-content/uploads/2014/11/image_thumb8.png"> &lt;img src="https://www.codewrecks.com/blog/wp-content/uploads/2014/11/image_thumb8.png" alt="image" />&lt;/a>&lt;/a>&lt;/p>
&lt;p>&lt;em>&lt;strong>Figure 1&lt;/strong>&lt;/em>: &lt;em>Mms is telling you that agents are out of date&lt;/em>&lt;/p></description></item><item><title>Manage authentication with Mongo MMS</title><link>https://www.codewrecks.com/post/old/2014/11/manage-authentication-with-mongo-mms/</link><pubDate>Thu, 20 Nov 2014 18:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/11/manage-authentication-with-mongo-mms/</guid><description>&lt;p>In an &lt;a href="http://www.codewrecks.com/blog/index.php/2014/11/01/deploy-mongo-easily-with-mms/">old post&lt;/a> I’ve shown how to easily deploy mongo thanks to &lt;a href="https://mms.mongodb.com">MMS online services&lt;/a>. &lt;strong>Mms is not only useful to deploy mongo instances, but it is exceptional also for monitoring and configuring&lt;/strong>. One of the most interesting features is managing users easily from mms web interface. Suppose you had installed mongo on an Azure Virtual Machine and you do not want everyone being able to access your instance. A possible solution is enabling authentication.&lt;/p></description></item><item><title>Deploy mongo easily with mms</title><link>https://www.codewrecks.com/post/old/2014/11/deploy-mongo-easily-with-mms/</link><pubDate>Sat, 01 Nov 2014 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/11/deploy-mongo-easily-with-mms/</guid><description>&lt;p>One of the reason why &lt;a href="http://www.mongodb.org/">Mongo&lt;/a> is gaining a lot of momentum in the industry is the easy of use. Just download the package, start mongod and you are donw. &lt;strong>When you are in production, you cannot surely simply install your mongo as a service, start it and then forget it without any kind of monitoring, because this will surely lead to problems&lt;/strong>. When is time to create more complex topologies, like sharding or replica set you can commit some mistakes and you have some tedious work to do. I strongly suggest you to have a look at &lt;a href="https://mms.mongodb.com">Mongo Mms&lt;/a>, because the online version offers a lot of functionalities for free, and every developer can use it to simplify even deployment of dev servers.&lt;/p></description></item><item><title>Aggregate in Mongo using only Date Part of a DateTime property</title><link>https://www.codewrecks.com/post/old/2014/10/aggregate-in-mongo-using-only-date-part-of-a-datetime-property/</link><pubDate>Mon, 13 Oct 2014 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/10/aggregate-in-mongo-using-only-date-part-of-a-datetime-property/</guid><description>&lt;p>If you need to do an &lt;em>aggregation in MongoDb on a DateTime property and you want to aggregate only by Date part&lt;/em>, you can use a simple trick and use a filter to compose the date part before the grouping. Here is the code&lt;/p>
&lt;div class="highlight">&lt;div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">db&lt;/span>.&lt;span style="color:#a6e22e">mycollection&lt;/span>.&lt;span style="color:#a6e22e">aggregate&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;$project&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">_id&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;datePartDay&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> {&lt;span style="color:#e6db74">&amp;#34;$concat&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#e6db74">&amp;#34;$substr&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> [{&lt;span style="color:#e6db74">&amp;#34;$dayOfMonth&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;$LastUpdate&amp;#34;&lt;/span>}, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span>]}, &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#e6db74">&amp;#34;$substr&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> [{&lt;span style="color:#e6db74">&amp;#34;$month&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;$LastUpdate&amp;#34;&lt;/span>}, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">2&lt;/span>]}, &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#e6db74">&amp;#34;$substr&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> [{&lt;span style="color:#e6db74">&amp;#34;$year&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;$LastUpdate&amp;#34;&lt;/span>}, &lt;span style="color:#ae81ff">0&lt;/span>, &lt;span style="color:#ae81ff">4&lt;/span>]}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ] }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>},
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{ &lt;span style="color:#e6db74">&amp;#34;$group&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { &lt;span style="color:#e6db74">&amp;#34;_id&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#e6db74">&amp;#34;$datePartDay&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;Count&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> { &lt;span style="color:#e6db74">&amp;#34;$sum&amp;#34;&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> } } 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>
&lt;p>Thanks to the power of &lt;a href="http://docs.mongodb.org/manual/applications/aggregation/">aggregation framework&lt;/a>, we can construct a pipeline where the first stage create a document with a new property that is composed only by the day-month-year. &lt;strong>That new document can have id equal to zero if we only need a count based on that date field, or you can assign original id of the document or whatever else&lt;/strong>. The subsequent stage of the pipeline is a simple count where the id is the new field that contains only date part of the original DateTime property.&lt;/p></description></item><item><title>Insenstive search with Mongo with C and LINQ provider</title><link>https://www.codewrecks.com/post/old/2013/12/insenstive-search-with-mongo-with-c-and-linq-provider/</link><pubDate>Wed, 11 Dec 2013 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2013/12/insenstive-search-with-mongo-with-c-and-linq-provider/</guid><description>&lt;p>Searching for a &lt;strong>case insensitive match in mongo&lt;/strong> is really simple, because it has full support for regular expression. As an example if you want to find all properties that is equal to a certain text with case insensitive search you can issue this query&lt;/p>
&lt;p>&lt;code>db.xxxx.find( { myProperty: /^text$/i } );&lt;/code>&lt;/p>
&lt;p>This query uses a regular expression and the final i is specification for an insensitive search. The other characters are&lt;/p></description></item><item><title>Query untyped object inside a Mongo Db log4net mongoappender</title><link>https://www.codewrecks.com/post/old/2012/05/query-untyped-object-inside-a-mongo-db-log4net-mongoappender/</link><pubDate>Fri, 25 May 2012 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/05/query-untyped-object-inside-a-mongo-db-log4net-mongoappender/</guid><description>&lt;p>I’ve blogged about &lt;strong>using MongoDb to store log4net logs&lt;/strong> , but the original appender has a little problem, it stores a BsonDocument inside the MongoCollection, and does not use any C# object and when it is time to query data you cannot use the new LINQ Mongo provider that is included in &lt;a href="http://www.mongodb.org/display/DOCS/CSharp&amp;#43;Language&amp;#43;Center">newest C# drivers (1.4&lt;/a>), because data is completely untyped.&lt;/p>
&lt;p>This is usually not a big problem, because you can query a collection using &lt;strong>simple JSON-like query&lt;/strong> , but if you are used to standard LINQ provider, probably you will get a little bit lost on how to create the JSON query to retrieve the data you need. &lt;em>This is the scenario I need to solve&lt;/em>: I have a stupid Winform that is able to show some information from a standard Log4Net Sql database (using the adonetappender) and I want to be able to use the very same interface to load data from mongo database. First of all I need to &lt;em>load&lt;/em> *all distinct value for the property &lt;strong>level&lt;/strong> and &lt;strong>loggerName&lt;/strong> *, because I have a combo where the user can filter for Severity (ERROR, WARN, INFO, Etc.) and a list of checkboxes used to filter for loggerName. Luckily enough, mongo offer such a functionality out of the box.&lt;/p></description></item><item><title>Use Capped collection on MongoAppender for Log4Net</title><link>https://www.codewrecks.com/post/old/2012/05/use-capped-collection-on-mongoappender-for-log4net/</link><pubDate>Tue, 22 May 2012 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/05/use-capped-collection-on-mongoappender-for-log4net/</guid><description>&lt;p>One of the coolest feature of Mongo is the concept of &lt;a href="http://www.mongodb.org/display/DOCS/Capped&amp;#43;Collections">&lt;strong>Capped Collection&lt;/strong>&lt;/a> &lt;strong>,&lt;/strong> or “fixed size” collection. They are based on a FIFO queue where the first record to be discharded is the first inserted, and this is exceptional to create a log-collection that automatically purge all old logs &lt;strong>without any user intervention&lt;/strong>.&lt;/p>
&lt;p>To be able to automatically enable this feature on the Log4Net &lt;a href="http://www.codewrecks.com/blog/index.php/2012/03/19/using-mongo-database-to-store-log4net-logs/">Mongo appender&lt;/a> you need to do a little modification to the code, this is because the original code simply gets a reference to the collection with this code.&lt;/p></description></item><item><title>Logging object with circular reference with Mongo Appender chrashes your process</title><link>https://www.codewrecks.com/post/old/2012/04/logging-object-with-circular-reference-with-mongo-appender-chrashes-your-process/</link><pubDate>Tue, 03 Apr 2012 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/04/logging-object-with-circular-reference-with-mongo-appender-chrashes-your-process/</guid><description>&lt;p>I’ve blogged some days ago on the possibility to save &lt;a href="http://www.codewrecks.com/blog/index.php/2012/03/19/using-mongo-database-to-store-log4net-logs/">log4net logs inside a Mongo database&lt;/a>, but you should be aware that this technique can be &lt;strong>dangerous if your objects have circular references.&lt;/strong> A &lt;em>circular reference happens when object A reference object B and object B directly or indirectly reference object A again&lt;/em>and this is a &lt;strong>high risk&lt;/strong> when you work with Mongo Serializer.&lt;/p>
&lt;p>Mongo Serializer does not likes circular references (it is perfectly acceptable, because documents with circular references cannot be saved into a document database), but the problem is: &lt;strong>if you try to serialize an object that has a circular reference you will get a StackOverflowException&lt;/strong> and your process will crash, as stated in official documentation from MSDN&lt;/p></description></item><item><title>Keep your Mongo log database small deleting old logs</title><link>https://www.codewrecks.com/post/old/2012/03/mongo-cleanup-older-log/</link><pubDate>Mon, 26 Mar 2012 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/03/mongo-cleanup-older-log/</guid><description>&lt;p>As I showed in an old post, &lt;a href="http://www.codewrecks.com/blog/index.php/2012/03/19/using-mongo-database-to-store-log4net-logs/">Mongo Db is perfect to store logs&lt;/a>, but as everyone knows, log databases tend to become really big, especially if the verbosity level is high, so I usually schedule a process that deletes all log older than a certain date to &lt;strong>free space in log databases&lt;/strong>. To cleanup record in a Mongo Db I decided to create a little &lt;strong>Powershell script&lt;/strong> to &lt;em>delete all entry in a collection that are older than a certain value&lt;/em>. The whole scritp is reported here.&lt;/p></description></item><item><title>Using Mongo Database to store Log4Net logs</title><link>https://www.codewrecks.com/post/old/2012/03/using-mongo-database-to-store-log4net-logs/</link><pubDate>Mon, 19 Mar 2012 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/03/using-mongo-database-to-store-log4net-logs/</guid><description>&lt;p>One of the most simple and useful way to introduce a &lt;strong>Documents Database&lt;/strong> like &lt;strong>Mongo&lt;/strong> in your organization is to use as Log Storage. If you use &lt;a href="http://logging.apache.org/log4net/">&lt;strong>log4Net&lt;/strong>&lt;/a> you can download a &lt;a href="http://maddemcode.com/net/log4net-mongodb-appender/">Mongo appender&lt;/a> capable of storing logs inside mongo with few lines of code and you are ready to go.&lt;/p>
&lt;p>The original appender is really good but I’ve done a little modification to make it capable of storing complex item in extended properties, just locate the function LogginEventToBSON and modify the section that stores Composite Properties with following code&lt;/p></description></item><item><title>MongoDB and concept of identity in NoSql db</title><link>https://www.codewrecks.com/post/old/2012/02/mongodb-and-concept-of-index-in-nosql-db/</link><pubDate>Mon, 27 Feb 2012 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/mongodb-and-concept-of-index-in-nosql-db/</guid><description>&lt;p>Previous posts on the &lt;a href="http://www.codewrecks.com/blog/index.php/tag/nosql/">NoSql&lt;/a> and Raven Series&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/04/nosql-and-a-life-without-schema/">NoSql and a life without Schema&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/06/nosql-and-a-life-without-schema-continued/">NoSql and a life without schema continued&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/08/rename-a-property-in-ravendb">Rename a property in RavenDb&lt;/a>&lt;/li>
&lt;li>First &lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/13/first-touch-of-ravendb-http-api/">Touch of RavenDb HTTP API&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/20/renaming-a-property-in-ravendb-with-http-api/">Renaming property in RavenDb with HTTP API&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Other posts by Mauro on &lt;a href="http://ravendb.net/">RavenDb&lt;/a> Subject.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/01/ravendb-start-your-engines.html">RavenDb: Start your engines&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-first-contact.html">RavenDb: First Contact&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-storing-data.html">RavenDB: Storing Data&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>In this article I deal with a different NoSql database called &lt;a href="http://www.mongodb.org/">MongoDb&lt;/a> a mature NoSql engine born outside the.NET world to clarify the concept of Id in a typical No Sql database. &lt;a href="http://www.mongodb.org/display/DOCS/Windows&amp;#43;Service">Installation&lt;/a> of Mongo is really simple, just download, uncompress, locate the &lt;strong>bin&lt;/strong> folder, and type this from an Administrator Console Prompt to install Mongo as service&lt;/p></description></item><item><title>Renaming a property in RavenDb with HTTP API</title><link>https://www.codewrecks.com/post/old/2012/02/renaming-a-property-in-ravendb-with-http-api/</link><pubDate>Mon, 20 Feb 2012 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/renaming-a-property-in-ravendb-with-http-api/</guid><description>&lt;p>Previous posts on the &lt;a href="http://www.codewrecks.com/blog/index.php/tag/nosql/">NoSql&lt;/a> and Raven Series&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/04/nosql-and-a-life-without-schema/">NoSql and a life without Schema&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/06/nosql-and-a-life-without-schema-continued/">NoSql and a life without schema continued&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/08/rename-a-property-in-ravendb">Rename a property in RavenDb&lt;/a>&lt;/li>
&lt;li>First &lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/13/first-touch-of-ravendb-http-api/">Touch of RavenDb HTTP API&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Other posts by Mauro on &lt;a href="http://ravendb.net/">RavenDb&lt;/a> Subject.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/01/ravendb-start-your-engines.html">RavenDb: Start your engines&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-first-contact.html">RavenDb: First Contact&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-storing-data.html">RavenDB: Storing Data&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>In third post of the series, I dealt with renaming of properties in an entity that has already some instances saved in RavenDB. The solution proposed was based on &lt;a href="http://old.ravendb.net/documentation/docs-http-api-patch">PATCH&lt;/a> commands issued by C# code based on an Index created with RavenStudio, but now that I showed you how to issue HTTP API request, it is time to understand how to issue &lt;a href="http://old.ravendb.net/documentation/set-based">set-based PATCH&lt;/a> commands to modify multiple documents with simple HTTP call.&lt;/p></description></item><item><title>First touch of RavenDb HTTP API</title><link>https://www.codewrecks.com/post/old/2012/02/first-touch-of-ravendb-http-api/</link><pubDate>Mon, 13 Feb 2012 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/first-touch-of-ravendb-http-api/</guid><description>&lt;p>Previous posts on the NoSql and Raven Series&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/04/nosql-and-a-life-without-schema/">NoSql and a life without Schema&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/06/nosql-and-a-life-without-schema-continued/">NoSql and a life without schema continued&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/08/rename-a-property-in-ravendb">Rename a property in RavenDb&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Other posts by Mauro on RavenDb Subject.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/01/ravendb-start-your-engines.html">RavenDb: Start your engines&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-first-contact.html">RavenDb: First Contact&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>RavenDb is not accessible only from.NET Code, but it fully support an &lt;a href="http://old.ravendb.net/documentation/docs-http-api-index">API based on HTTP&lt;/a> that basically permits to interact with database engine with simple HTTP requests, thus you can access a RavenDb instance from every technology that is capable of issuing Web Requests.&lt;/p></description></item><item><title>Rename a property in RavenDb</title><link>https://www.codewrecks.com/post/old/2012/02/rename-a-property-in-ravendb/</link><pubDate>Wed, 08 Feb 2012 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/rename-a-property-in-ravendb/</guid><description>&lt;p>Previous posts on the NoSql and Raven Series&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/04/nosql-and-a-life-without-schema/">NoSql and a life without Schema&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.codewrecks.com/blog/index.php/2012/02/06/nosql-and-a-life-without-schema-continued/">NoSql and a life without schema continued&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Other posts by Mauro on RavenDb Subject.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/01/ravendb-start-your-engines.html">RavenDb: Start your engines&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://mauroservienti.blogspot.com/2012/02/ravendb-first-contact.html">RavenDb: First Contact&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>In previous articles I showed how simple is to store objects inside a NO SQL database because the data storage has no schema and does not require you to specify the format of your data. I decided to use RavenDb as a NoSql storage to show some basic concepts of NoSql and I showed also how simple is to add a new property to a document, because RavenDb takes care of everything, just save and load objects and the new property is just there.&lt;/p></description></item><item><title>NoSql and a life without Schema continued</title><link>https://www.codewrecks.com/post/old/2012/02/nosql-and-a-life-without-schema-continued/</link><pubDate>Mon, 06 Feb 2012 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/nosql-and-a-life-without-schema-continued/</guid><description>&lt;p>In the first part I showed how simple is to store object inside a NoSql database like RavenDb, today I want to point out how cool is having no schema when it is time to add properties to your documents.&lt;/p>
&lt;p>Suppose that your Player entity changed and you add a new property called Description and you already saved some Players on RavenDb. The question is: what happens when you try to save a new Player now that the class has another property? What happens when you load an old entity, that was saved when that property did not exist?&lt;/p></description></item><item><title>NoSql and a life without Schema</title><link>https://www.codewrecks.com/post/old/2012/02/nosql-and-a-life-without-schema/</link><pubDate>Sat, 04 Feb 2012 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/02/nosql-and-a-life-without-schema/</guid><description>&lt;p>NoSql is not a replacemente for SQL databases, but it is a valid alternative for a lot of situations where standard SQL is not the best approach to store your data. Since we were taught that whenever you need to store data on a “data store” and you need to query that data for retrieval, SQL is the best solution, you have only to decide what Sql Engine to use and the game is done.&lt;/p></description></item></channel></rss>