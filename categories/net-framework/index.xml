<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NET Framework on Codewrecks</title><link>https://www.codewrecks.com/categories/net-framework/</link><description>Recent content in NET Framework on Codewrecks</description><generator>Hugo</generator><language>en</language><lastBuildDate>Fri, 19 Jul 2019 16:00:37 +0200</lastBuildDate><atom:link href="https://www.codewrecks.com/categories/net-framework/index.xml" rel="self" type="application/rss+xml"/><item><title>Error when NET461 full framework references NETStandard nuget packages</title><link>https://www.codewrecks.com/post/old/2019/07/error-when-net461-full-framework-references-netstandard-nuget-packages/</link><pubDate>Fri, 19 Jul 2019 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2019/07/error-when-net461-full-framework-references-netstandard-nuget-packages/</guid><description>After updating MongoDb driver in a C# big project I start having a problem in a Web Project where we have this error after a deploy in test server (but we have no error in local machine of developers) &amp;gt; An assembly with the same identity ‘System.Runtime, Version=4.1.2.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a’ has already been imported. Try removing one of the duplicate references.
This happens because MongoDB driver &amp;gt; 2.8 reference in the chain System.</description></item><item><title>Publishing web project on disk during build</title><link>https://www.codewrecks.com/post/old/2014/09/publishing-web-project-on-disk-during-build/</link><pubDate>Tue, 23 Sep 2014 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/09/publishing-web-project-on-disk-during-build/</guid><description>During a build you can ask MsBuild to deploy on build using the switch /p:DeployOnBuild=true as I described in previous posts. This is mainly used to deploy the site on IIS thanks to WebDeploy, but you can also use WebDeploy to deploy on a disk path. The problem is that the path is stored in publication settings file, but what about changing that path during a Build ?
The answer is simple, you can use the /p:publishUrl=xxx to override what is specified inside the publication file and choose a different directory for deploy.</description></item><item><title>Error publishing Click-once moving from NET 35 to 45</title><link>https://www.codewrecks.com/post/old/2014/05/error-publishing-click-once-moving-from-net-3-5-to-4-5/</link><pubDate>Tue, 20 May 2014 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2014/05/error-publishing-click-once-moving-from-net-3-5-to-4-5/</guid><description>I’ve a customer where we set up a TFS Build that automatically compile, obfuscates assembly and finally publish with click-once on an internal server. As a part of the process, a tool is used to move the published packages from the internal server to public server, to make it available to final customers. This tool uses mage.exe to change some properties of the package and then repack to publish to final server.</description></item><item><title>Avoid WCF to test validity of HTTPS certificates</title><link>https://www.codewrecks.com/post/old/2012/12/avoid-wcf-to-test-validity-of-https-certificates/</link><pubDate>Wed, 19 Dec 2012 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/12/avoid-wcf-to-test-validity-of-https-certificates/</guid><description>In a previous article I deal on How To test ssl based wcf service and part of the solution is to create a self issued certificate and make it valid inserting generated certificate in Trusted Root Certification Authority.
This operation makes that CA trusted and is an operation that is not so good if you really care on the security of your machine. There is also situation where you want to temporarily disable the check of the validity of the certificate, ES: you need to revoke certificate and issue another one with a new certification trusted authority , or basically you want your application to use a self issued https certificate in your intranet but you do not want to install that CA in everyone computer Trusted Root Certification Authority.</description></item><item><title>The username is not provided Specify username in ClientCredentials when use CreateChannel at Runtime</title><link>https://www.codewrecks.com/post/old/2012/10/the-username-is-not-provided-specify-username-in-clientcredentials-when-use-createchannel-at-runtime/</link><pubDate>Fri, 19 Oct 2012 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/10/the-username-is-not-provided-specify-username-in-clientcredentials-when-use-createchannel-at-runtime/</guid><description>I’ve encountered a strange problem with WCF today, I have a custom Castle facility that is able to automatically create Wcf proxies with code , and it worked perfectly until I need to add a simple functionality: I want to be able to change at runtime some of the options of bindings that are configured in app.config. The solution was really simple, just write a method to retrieve the BindingConfiguration from the configuration file and the game is almost done.</description></item><item><title>Little Trick to generate ILogger with MEF based on type</title><link>https://www.codewrecks.com/post/old/2012/07/little-trick-to-generate-ilogger-with-mef-based-on-type/</link><pubDate>Tue, 03 Jul 2012 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/07/little-trick-to-generate-ilogger-with-mef-based-on-type/</guid><description>I’ve a little application that uses MEF to manage plugins, today I faced this problem, I have classes like this one.
1 2 3 4 public class TestExport { [Import] public ILog Logger { get; set; } This is a standard class that declares an import on log4net.ILog interface and since this little program uses MEF to do all composition I’d like to avoid using Castle or other IoC libraries, but I wish to use MEF to resolve ILog with the constraint that each class should have its own logger , a condition verified by this test.</description></item><item><title>Advanced queries with LuceneNET</title><link>https://www.codewrecks.com/post/old/2012/07/advanced-queries-with-lucene-net/</link><pubDate>Tue, 03 Jul 2012 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/07/advanced-queries-with-lucene-net/</guid><description>Previous part of the series
Getting Started With Lucene.NET Searching and more detail on Documents Fields In the previous parts I created a lucene.NET index that contains information about StackOverflow posts content and I showed some basic searches. Suppose I create a new index where documents were created with these options
1 2 luceneDocument.Add(new Field(&amp;#34;Id&amp;#34;, reader.GetAttribute(&amp;#34;Id&amp;#34;), Field.Store.YES, Field.Index.NOT_ANALYZED)); luceneDocument.Add(new Field(&amp;#34;content&amp;#34;, reader.GetAttribute(&amp;#34;Body&amp;#34;), Field.Store.COMPRESS, Field.Index.ANALYZED)); With this document I’m able to retrieve the original content because I’ve specified lucene.</description></item><item><title>The C project xxx is targeting NET FrameworkhellipProfileFull which is not installed on this machine error</title><link>https://www.codewrecks.com/post/old/2012/04/the-c-project-xxx-is-targeting-net-frameworkprofilefull-which-is-not-installed-on-this-machine-error/</link><pubDate>Fri, 27 Apr 2012 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/04/the-c-project-xxx-is-targeting-net-frameworkprofilefull-which-is-not-installed-on-this-machine-error/</guid><description>This morning I need to work on an old Visual Studio 2008 project, and since I do not have VS2008 in my machine I decided to convert to VS2010, all projects converts well, but one of them have this error during conversion
Figure 1: The strange error during project conversion
I never had such a problem in this installation, moreover the project was a WPF 3.5 project, and there also another WPF 3.</description></item><item><title>Troubleshoot WCF exception</title><link>https://www.codewrecks.com/post/old/2012/04/troubleshoot-wcf-exception/</link><pubDate>Mon, 23 Apr 2012 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2012/04/troubleshoot-wcf-exception/</guid><description>WCF is an exceptional library but sometimes it is hard to troubleshoot problems, especially when you start to encounter intermittent communication errors and you feel lost because you have no clue on where the error is. As an example I have a service that worked for a lot of time, then sometimes the client started to receive this error
The server did not provide a meaningful reply; this might be caused by a contract mismatch, a premature session shutdown or an internal server error The easiest way to troubleshoot this kind of error is to enable logging for WCF in the system.</description></item><item><title>Wcf IXmlSerializable and The XmlReader state should be EndOfFile after this operation</title><link>https://www.codewrecks.com/post/old/2011/08/wcf-ixmlserializable-and-the-xmlreader-state-should-be-endoffile-after-this-operation/</link><pubDate>Tue, 23 Aug 2011 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/08/wcf-ixmlserializable-and-the-xmlreader-state-should-be-endoffile-after-this-operation/</guid><description>I&amp;rsquo;ve a simple class that contains Properties metadata and I need to pass instances of that class with WCF. Since it contains Dictionary of objects I decided to implement IXmlSerializable to decide the exact format of serialization and make it usable with WCF. Since I really hate reading XML stream with XmlReader, I decided to implement the ReadXml method using an XElement, thanks to the fact that I can create an XElement from a XmlReader thanks to the Load method.</description></item><item><title>Weak reference to delegate never do it</title><link>https://www.codewrecks.com/post/old/2011/06/weak-reference-to-delegate-never-do-it/</link><pubDate>Thu, 30 Jun 2011 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/06/weak-reference-to-delegate-never-do-it/</guid><description>In previous post I explained how I modified the Broker class to store WeakReference to Action&amp;lt;Message&amp;lt;T&amp;gt;&amp;gt; delegate to avoid the broker preventing garbage collection of the subscribers. This is a strong requirement, an object register an handler to the broker, but it does not want to share the same lifecycle of the broker because it is singleton. After this modification I have a strange bug, the program works, but after some minutes messages stops flowing, I scratched my head and then understand that this is normal, because my code that uses a WeakReference to an even is flawed.</description></item><item><title>Pass cookie from Web Request to WebBrowser</title><link>https://www.codewrecks.com/post/old/2011/06/pass-cookie-from-web-request-to-webbrowser/</link><pubDate>Wed, 29 Jun 2011 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/06/pass-cookie-from-web-request-to-webbrowser/</guid><description>Suppose you have some domain where you are navigating with a WebRequest object and you need to be able to browser that domain in a standard WebBrowser control, using the same cookies of the WebRequest.
The solution is really simple, you need to use the InternetSetCookieEx Windows API. First of all the import statement
1 2 3 4 5 6 7 [DllImport(&amp;#34;wininet.dll&amp;#34;, SetLastError = true)] public static extern bool InternetSetCookieEx( string url, string cookieName, StringBuilder cookieData, Int32 dwFlags, IntPtr lpReserved); Now you can use in a simple helper function.</description></item><item><title>WeakReference to delegate are you sure it is a good idea</title><link>https://www.codewrecks.com/post/old/2011/04/o-reference-from-singleton-why-thou-are-so-subtle/</link><pubDate>Fri, 15 Apr 2011 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/04/o-reference-from-singleton-why-thou-are-so-subtle/</guid><description>When an object references another object, he prevent garbage collector to reclaim referenced objects, this fact is known by every developer and we need to pay specific attention when dealing with singleton objects.
One of the most common risk is having a Singleton reference other objects and thus keeping them alive until the application consumes all available memory; I have a primitive IBroker interface implemented by a ConcreteBroker class that have a singleton lifecycle; since all ViewModels register themselves into the broker to receive messages, we can end with all ViewModels not being released from memory because referenced from the Broker singleton instance.</description></item><item><title>Mshtml and Click-Once the saga continues</title><link>https://www.codewrecks.com/post/old/2011/04/mshtml-and-click-once-the-saga-continues/</link><pubDate>Thu, 14 Apr 2011 19:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/04/mshtml-and-click-once-the-saga-continues/</guid><description>I must admit that I really do not like deploying Click-Once application that uses MSHTML.dll, because I had several problem in the past and another one rigth now. Today I have to deploy (click once) a new version of an application that was migrated from VS 2008 to Visual Studio 2010, and I found a really strange problem. When I checked the ApplicationFiles to be sure that MSHTML.dll is included in the Click-once package, I did not see it listed from the available assemblies to be included in the deploy.</description></item><item><title>Winform hell-running programs with low resolution</title><link>https://www.codewrecks.com/post/old/2011/03/winform-hellrunning-programs-with-low-resolution/</link><pubDate>Wed, 30 Mar 2011 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/03/winform-hellrunning-programs-with-low-resolution/</guid><description>I&amp;rsquo;ve a problem, we developed a winform program that has a really big startup form. The height of the form is 880 pixel and is designed to work on big monitors. Clearly everything is resizable, so if you resize the form you can still work with it, with no problem.
Figure 1: the form resized
as you can see the form is divided in: blue part (filters), yellow part (result of the query), and finally red part (detail of selected element).</description></item><item><title>Hosting a WPF control in Winform with a scrollable Panel</title><link>https://www.codewrecks.com/post/old/2011/03/hosting-a-wpf-control-in-winform-with-a-scrollable-panel/</link><pubDate>Fri, 18 Mar 2011 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/03/hosting-a-wpf-control-in-winform-with-a-scrollable-panel/</guid><description>I have a winform project that uses a WPF control for reports. Everything went good, until we need to add more report to a form, and requirements told us to create a scrollbar to show all reports. I simply put a panel with autoscroll = true, and inside it I put a TableLayoutPanel and everything seems to works, excepts that ElementHost used to wrap the WPF controls when scrolled shows a messy interface.</description></item><item><title>Changing appconfig value at runtime</title><link>https://www.codewrecks.com/post/old/2011/02/changing-app-config-value-at-runtime/</link><pubDate>Fri, 11 Feb 2011 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/02/changing-app-config-value-at-runtime/</guid><description>Sometimes there is the need to modify the value of some part of the configuration file of a.NET application at runtime, this is an example: I have a software that read some content from xml files, and have several paths listed in the AppSettings section of application configuration file.
During the very first run the software should extract xml data from a zip file to a directory chosen by the user, then the software should update all these settings to reflect this changes.</description></item><item><title>Performance of Lists</title><link>https://www.codewrecks.com/post/old/2011/01/performance-of-lists/</link><pubDate>Wed, 19 Jan 2011 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2011/01/performance-of-lists/</guid><description>In a previous post I explained how to create a simple LINQ extension method to use the Distinct() method with a lambda and not an IEqualityComparer. That solution uses a simple List&amp;lt;T&amp;gt; as temporary storage to implement the concept of distinct elements. To verify if an object was already returned I simply searched into the temp List&amp;lt;T&amp;gt; looking if an element that satisfy the Predicate, this will permit me to return only distinct elements.</description></item><item><title>Ndepend to the resque</title><link>https://www.codewrecks.com/post/old/2010/11/ndepend-to-the-resque/</link><pubDate>Wed, 03 Nov 2010 15:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/11/ndepend-to-the-resque/</guid><description>I&amp;rsquo;ve blogged about this supersimple but amazing feature of NDepend some time ago, but I want to emphasize another time how NDepend is a tool that you must have in your toolset.
I&amp;rsquo;ve deployed an application with click-once, but when I try to install it &amp;hellip; I got this error
Figure 1: The error during the installation
the error is strange, the application requires an assembly with a wrong version, because the system.</description></item><item><title>Desiging a authentication layer with cryptoagility</title><link>https://www.codewrecks.com/post/old/2010/08/desiging-a-authentication-layer-with-cryptoagility/</link><pubDate>Mon, 30 Aug 2010 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/08/desiging-a-authentication-layer-with-cryptoagility/</guid><description>Today I was working a little bit on Dexter, and I&amp;rsquo;m trying to update the security system, the actual login system is based on a membership provider quite old, but I&amp;rsquo;d like to update it to be CryptoAgile. First of all here is the class UserDto (the name Dto should be changed because it is really a domain class but we are in the middle of a reorganization so do not mind the name ) that has some methods to manage authentication.</description></item><item><title>Error during clickonce deploy with mshtml 8211 Strong name signature not valid for this assembly</title><link>https://www.codewrecks.com/post/old/2010/07/error-during-clickonce-deploy-with-mshtml-strong-name-signature-not-valid-for-this-assembly/</link><pubDate>Tue, 13 Jul 2010 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/07/error-during-clickonce-deploy-with-mshtml-strong-name-signature-not-valid-for-this-assembly/</guid><description>To deploy application that use mshtml with clickonce, you need to be sure that microsoft.mshtml.dll is included in the setup of click once, or the application will not install if mshtml.dll is not present on the machine at the time of deploy. But if you include it sometimes clients are not able to install application due to the following error
Strong name signature not valid for this assembly Microsoft.mshtml.dll
this is due to the fact that you reference a partially signed version in your project.</description></item><item><title>Blame on me for old vb code net 10 completely not CLS</title><link>https://www.codewrecks.com/post/old/2010/05/blame-on-me-for-old-vb-code-net-1-0-completely-not-cls/</link><pubDate>Thu, 20 May 2010 14:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/05/blame-on-me-for-old-vb-code-net-1-0-completely-not-cls/</guid><description>Today I&amp;rsquo;m converting a project written in VB to C#, since it is composed by simple classes that manages reporting in RTF, I supposed that this will be a simple process. This project uses a RTF library I wrote in Visual Basic in 2002, that was simply compiled for.NET 2.0 some times ago.
The problem is that the library is really not CLS compliant and when I converted this project, (that contains 54 classes) I got ~ 2000 compilation errors.</description></item><item><title>Force databinding update in Winform without waiting for lose focus</title><link>https://www.codewrecks.com/post/old/2010/01/force-databinding-update-in-winform-without-waiting-for-lose-focus/</link><pubDate>Thu, 14 Jan 2010 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2010/01/force-databinding-update-in-winform-without-waiting-for-lose-focus/</guid><description>I have a winform application where the user can select an element into a grid, edit its properties, and then decide if the modification should be saved or rejected. Thanks to binding, IEditableObject and INotifyPropertyChanged, writing such feature is a breeze, but the user signaled me that something was wrong. He told me: *suppose you choose an element, then change a value in the combo, nothing happens. When I press tab or move the Save and Cancel button become visible, but I wanto them to be visible as soon as I press a char into textbox or change a value in the combo.</description></item><item><title>Wcf over https authentication with aspnet membership</title><link>https://www.codewrecks.com/post/old/2009/11/wcf-over-https-authentication-with-asp-net-membership/</link><pubDate>Thu, 26 Nov 2009 16:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/11/wcf-over-https-authentication-with-asp-net-membership/</guid><description>In last article I explained how to configure WCF to secure a service with https, with no authentication, now I want to show you the configuration needed to enable role and user membership using a standard asp.net provider.
Here is the service definition on the server
1 2 3 4 5 6 7 8 9 10 11 12 13 &amp;lt;service behaviorConfiguration=&amp;#34;WsHttpWithAuthBehavior&amp;#34; name=&amp;#34;MyProject.DoSomethingService&amp;#34;&amp;gt; &amp;lt;endpoint address=&amp;#34;https://mydomain.it/DoSomethingService.svc&amp;#34; binding=&amp;#34;wsHttpBinding&amp;#34; name=&amp;#34;MyService&amp;#34; bindingConfiguration=&amp;#34;wsHttps&amp;#34; contract=&amp;#34;MyProject.IDoSomethingService&amp;#34;&amp;gt; &amp;lt;identity&amp;gt; &amp;lt;dns value=&amp;#34;mydomain.</description></item><item><title>Wcf over secure transport</title><link>https://www.codewrecks.com/post/old/2009/11/wcf-over-secure-transport/</link><pubDate>Wed, 25 Nov 2009 13:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/11/wcf-over-secure-transport/</guid><description>In some older posts, I dealt with wcf configuration to manage authentication of a service with the asp.net membership provider.
Now I need to modify configuration, because in another project, all the site is forced over https, and the configuration I used in the other project cannot be used anymore. In older post in fact, I explained how to send credentials over http with message security, using self issued certificates. Now I have transport security, so I can avoid the need to distribute certificates to people that will use the service.</description></item><item><title>Open Xml Project</title><link>https://www.codewrecks.com/post/old/2009/11/open-xml-project/</link><pubDate>Wed, 18 Nov 2009 17:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/11/open-xml-project/</guid><description>I&amp;rsquo;ve received some comments in an old post, regarding the manipulation of docx documents, with the purpose of substitute parts of the original document with images or pieces of text. I&amp;rsquo;ve blogged also how to use Excel to create reports, and populate data programmatically with OpenXml standard.
The original code was developed for an Italian company named ActValue I collaborate with, and some people asked me to publish the full code.</description></item><item><title>Pass a serialized object in querystring with less chars</title><link>https://www.codewrecks.com/post/old/2009/11/pass-a-serialized-object-in-querystring-with-less-chars/</link><pubDate>Wed, 11 Nov 2009 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/11/pass-a-serialized-object-in-querystring-with-less-chars/</guid><description>I&amp;rsquo;ve some legacy code where stuff have to be passed with querystring, because we need to issue Get request to the server, and I need to pass various set of parameters for some reporting functions, but those parameters have 20 field, and are somewhat used as a tree. I decided to serialize everything and pass the result with querystring using HttpUtility.UrlEncoding&amp;hellip; the result was frustrating because the url are simply too long.</description></item><item><title>Regular expression and performances</title><link>https://www.codewrecks.com/post/old/2009/10/regular-expression-and-performances/</link><pubDate>Mon, 26 Oct 2009 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/10/regular-expression-and-performances/</guid><description>Regular expressions are really powerful, but sometimes they can be quite slow, especially when you have to deal with large amount of data.
I have a lot of string in database that have this format &amp;hellip;text&amp;hellip;||&amp;hellip;anothertext&amp;hellip;||..anothertext&amp;hellip; and we need to split using || as separator. Since string.split accepts only a char, we used a simple regular expression to parse text.
1 @&amp;#34;(&amp;gt;|\||^|(\.\.\.))(?&amp;lt;prev&amp;gt;.+?)(&amp;lt;|\||$|(\.\.\.,))&amp;#34; This regular expression was a leftover by some old code, it splits string with tag like &amp;lt;xxx&amp;gt;&amp;hellip;text&amp;lt;/xxx&amp;gt; and was left here even if now the string format is really simplier.</description></item><item><title>Implement a simple undoable editing with a winform GridView</title><link>https://www.codewrecks.com/post/old/2009/10/implement-a-simple-undoable-editing-with-a-winform-gridview/</link><pubDate>Thu, 22 Oct 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/10/implement-a-simple-undoable-editing-with-a-winform-gridview/</guid><description>I need to implement a very simple interface, the user loads from a service a certain amount of objects displayed into a gridview. Then selecting an object in the gridview the user can edit object properties in a detail panel situated under the grid. Specification ask me to
avoid that the user update some property of the object, then forget to press Save button and move to another object forgetting to update data calling the service update function.</description></item><item><title>Subtle differences from VB and C</title><link>https://www.codewrecks.com/post/old/2009/10/subtle-differences-from-vb-and-c/</link><pubDate>Thu, 15 Oct 2009 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/10/subtle-differences-from-vb-and-c/</guid><description>For those who works like me with both languages, sometimes we can encounter some subtle differences between VB and C#. Take this code in VB
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 Module Module1 Private Function NormalizeRank(ByVal userRank As Integer) As Integer Return CType(Math.Ceiling(Math.Min(userRank / 20, 5.0)), Integer) End Function Sub Main() For value As Integer = 0 To 101 Console.WriteLine(&amp;#34;{0} normalized is {1}&amp;#34;, value, NormalizeRank(value)) Next End Sub End Module Is a very stupid piece of code that is supposed to take a value in the range 0.</description></item><item><title>Generate a certificate for Wcf service with windows server 2003</title><link>https://www.codewrecks.com/post/old/2009/09/generate-a-certificate-for-wcf-service-with-windows-server-2003/</link><pubDate>Wed, 09 Sep 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/09/generate-a-certificate-for-wcf-service-with-windows-server-2003/</guid><description>In the previous post, I showed how to setup authentication with asp.net membership in wsHttpBinding for a Wcf server, and in that post I showed how to use the utility makecert.exe to generate temporary certificates. In production environment you should generate certificates with a Certification Authority.
If you search in the internet how to generate a certificate with windows server 2003 CA, you find very little information, here is how I did it.</description></item><item><title>Use AspNet Membership provider with a WCF svc service</title><link>https://www.codewrecks.com/post/old/2009/09/use-aspnet-membership-provider-with-a-wcf-svc-service/</link><pubDate>Tue, 08 Sep 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/09/use-aspnet-membership-provider-with-a-wcf-svc-service/</guid><description>Yesterday I literally lost 4 hours trying to do the following thing: Exposing a wcf service with wsHttpBinding, and using the same asp.net membership database used by the site. I encountered many problems, and I decided to write this post to explain the steps that makes everything work for me. First of all you need to know that fact: if you want to use asp.net membership in a wcf service exposed with wsHttpBinding you need to use certificates , and this causes most of the problems.</description></item><item><title>Test database with Nunit make easy with Visual Studio Team System For Database Edition</title><link>https://www.codewrecks.com/post/old/2009/08/test-database-with-nunit-make-easy-with-visual-studio-team-system-for-database-edition/</link><pubDate>Thu, 06 Aug 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/08/test-database-with-nunit-make-easy-with-visual-studio-team-system-for-database-edition/</guid><description>I have a project born without VSTS database edition, all tests to database are done using custom preload scripts that run.sql scripts to regenerate a sandbox database to use for unit testing. This turns to be a quite good system, but it requires manteniance, since every time you change the database you also need to change sql file to recreate the new structure to run tests.
My goal is to fully automate this process, avoiding manual intervention and running everything in a standard NUNIT project, and make test runnable even from programmer that does not have visual studio database edition installed.</description></item><item><title>Installing Visual Studio Team System 2008 Database Edition GDR R2</title><link>https://www.codewrecks.com/post/old/2009/08/installing-visual-studio-team-system-2008-database-edition-gdr-r2/</link><pubDate>Thu, 06 Aug 2009 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/08/installing-visual-studio-team-system-2008-database-edition-gdr-r2/</guid><description>Today I need to install VSDB edition GDR into a older virtual machine, I just fired the installer and got this error.
Visual Studio Team System 2008 Database Edition GRD Does Not Apply or is blocked by another condition on your system. Please click the link below for more details.
If you click the link you will be redirect to the download page, but if you look carefully you can find detailed installation instructions scrolling down the page</description></item><item><title>Writing extension for Msbuild</title><link>https://www.codewrecks.com/post/old/2009/08/writing-extension-for-msbuild/</link><pubDate>Sat, 01 Aug 2009 00:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/08/writing-extension-for-msbuild/</guid><description>Msbuild is microsoft build engine, and I showed some time ago how you can write a custom task to post in twitter the outcome of a build result. Now it is time to give a greater focus on how to write a good task.
Creating a Task is a simple matter of inheriting from the Task class but there are some key points you should keep in mind, first of all you should never throw an exception when executing the task, except for some specific system exception like OutOfMemoryException or StackOverflowException, then you should provide good logs to make simple for the user of your task to understand causes of failures.</description></item><item><title>Expression tree to the rescue</title><link>https://www.codewrecks.com/post/old/2009/07/expression-tree-to-the-rescue/</link><pubDate>Mon, 27 Jul 2009 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/07/expression-tree-to-the-rescue/</guid><description>I have a little validation library that must support localized error messages, it uses a simple techniques, when you set an error message for a specific validator, if you do not want localization you can simply pass a single string, but if you want message to be localized, you specified two strings, one is the name of the resource that contains the message and the other is the key of the message.</description></item><item><title>What makes a poor programmer happy</title><link>https://www.codewrecks.com/post/old/2009/07/what-makes-a-poor-programmer-happy/</link><pubDate>Fri, 10 Jul 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/07/what-makes-a-poor-programmer-happy/</guid><description>I must create a duplicate of a database in another server, I need to duplicate only the structure of actual production database to use with a test web application to check how the webapp works with an empty database. I simply fired a command prompt, went to output directory of my database project, and typed
1 vsdbcmd /a:Deploy /ConnectionString:&amp;#34;Data Source=10.8.x.x\sql2008;user=sa;pwd=xxxxxxxx&amp;#34; /dsp:SQL /manifest:MyProject.deploymanifest /p:TargetDatabase=MyProjectEmptyDb And after a couple of minutes the empty db is ready, with its 9 physical files, 5 filegroups, all the indexes, all fulltext defined etc etc :D Thanks to Visual Studio Database Edition.</description></item><item><title>Comparison between nant and msbuild</title><link>https://www.codewrecks.com/post/old/2009/07/comparison-between-nant-and-msbuild/</link><pubDate>Fri, 10 Jul 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/07/comparison-between-nant-and-msbuild/</guid><description>You can find at this link, a table that compare nant tasks with msbuild tasks. If you look at this table it seems that msbuild lacks a lot of things, but actually there are specific visual studio tasks that have no equivalent in nant, like those one for tfs (open issue etc), publishing with clickonce, run a data generation plan and many more.
In the end msbuild is a great product, but probably it lacks a little on some basic tasks like XML manipulation with xmlpeek and xmlpoke.</description></item><item><title>Resolve reference warning to object of master database in database projects</title><link>https://www.codewrecks.com/post/old/2009/07/resolve-reference-warning-to-object-of-master-database-in-database-projects/</link><pubDate>Wed, 08 Jul 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/07/resolve-reference-warning-to-object-of-master-database-in-database-projects/</guid><description>If you use some stored procedure or objects that reside into master database, when you compile your database project you will end with warning like this.
1 C:\DEVELOP\myproject\TRUNK\SRC\COMMON\SQLSERVER\REPMANAGEMENT.DATABASE\SCHEMA OBJECTS\PROGRAMMABILITY\STORED PROCEDURES\LOG.GETFEEDER.PROC.SQL(45,6)Warning TSD04151: Procedure: [Log].[GetFeeder] contains an unresolved reference to an object. Either the object does not exist or the reference is ambiguous because it could refer to any of the following objects: [dbo].[sp_executesql] or [Log].[sp_executesql]. This happens because I used the sp_executesql in my stored procedures, and sp_executesql is one of the stored that resides into Master database.</description></item><item><title>A better version of dtofactory</title><link>https://www.codewrecks.com/post/old/2009/07/a-better-version-of-dtofactory/</link><pubDate>Tue, 07 Jul 2009 00:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/07/a-better-version-of-dtofactory/</guid><description>In this post I dealt with a primitive version of a T4 template to generate dto starting from domain objects. In these days I had little time to improve it a little bit, and I created a simple test project to verify some of the basic functionality.
Usage of the T4 template is really simple, I&amp;rsquo;ve created in the test project an Entity Factory model to the ubiquitous northwind database, then I added a OrderDto.</description></item><item><title>Import log and filegroup file sizes option for Vs Db edition</title><link>https://www.codewrecks.com/post/old/2009/06/import-log-and-filegroup-file-sizes-option-for-vs-db-edition/</link><pubDate>Fri, 26 Jun 2009 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/import-log-and-filegroup-file-sizes-option-for-vs-db-edition/</guid><description>In previous post I deal with file size in VS DB edition. To avoid this problem, (as my friend Lorenzo pointed me out), when you import the database structure, with the Database Project wizard, you must not select the Import log and filegroup file size.
If you deselect this option the import wizard does not check the actual file size of the database that is being imported.
alk.
Tags: Visual Studio Database Edition</description></item><item><title>VS Database Edition pay attention to file size when you import db</title><link>https://www.codewrecks.com/post/old/2009/06/vs-database-edition-pay-attention-to-file-size-when-you-import-db/</link><pubDate>Fri, 26 Jun 2009 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/vs-database-edition-pay-attention-to-file-size-when-you-import-db/</guid><description>I use Database Edition on a legacy database that is very big, when I created the database project I simply ask to VS database edition to import the structure and everything is ok. Then I noticed that deploy operation when database does not exists on the server is really slow. I use in the past some custom test infrastructure to preload the db, I have a lot of test that works in this way and I do not want to delete them.</description></item><item><title>Introspection vs reflection</title><link>https://www.codewrecks.com/post/old/2009/06/introspection-vs-reflection/</link><pubDate>Wed, 24 Jun 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/introspection-vs-reflection/</guid><description>As every.Net programmer know, reflection is the standard way to analyze an assembly finding types, interfaces etc. This approach cannot be used in all situations, as an example when you generate code with T4 engine in visual studio 2008.
As Oleg states here, if you need to analyze assemblies during code generation, you should use fxcop introspection vs standard reflection. Using introspection is really simple, first of all you need to locate a couple of dll in the fxcop installation folder, and references them in the solution.</description></item><item><title>Visual Studio Database edition How to find objects that reference other objects</title><link>https://www.codewrecks.com/post/old/2009/06/visual-studio-database-edition-how-to-find-objects-that-reference-other-objects/</link><pubDate>Tue, 23 Jun 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/visual-studio-database-edition-how-to-find-objects-that-reference-other-objects/</guid><description>Another feature of Visual Studio Database Edition I cannot live without, is the possibility to find all objects that references a specific table or stored procedure etc. To see a dependency for an object simply click on the SchemaView and then you can right click on a table, and choose View Dependencies
This command will open a menu that shows all objects that references this specific object, as well as all database objects that are referenced by this object.</description></item><item><title>Creating a build with Tfs</title><link>https://www.codewrecks.com/post/old/2009/06/creating-a-build-with-tfs/</link><pubDate>Mon, 22 Jun 2009 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/creating-a-build-with-tfs/</guid><description>I worked for long time with NANT + CC.net as continuous integration tools. I used subversion as Source Control System and use Mantis or Redmine for issue tracking.
The main disadvantage of using such a configuration is the need to make each tool communicate with others, the good part is that these tools are open source. Team Foundation Server on the other side is a Commercial tool, so you have to pay it, but it gives you a lot of features in a single unified tool, and this is Great.</description></item><item><title>Publish a project with ClickOnce via NANT and CCNet</title><link>https://www.codewrecks.com/post/old/2009/06/publish-a-project-with-clickonce-via-nant-and-ccnet/</link><pubDate>Thu, 18 Jun 2009 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/publish-a-project-with-clickonce-via-nant-and-ccnet/</guid><description>I have a project that needs to be published automatically through IIS directory, clickonce and CC.net machine. The easiest way to make this happens is to follow these simple instructions.
First of all goes into the machine where the CC.Net runs, prepare the IIS directory where the clickonce generated setup will be copied, open the solution into visual studio, goes to the project you want to publish and set everything needed for clickonce, set version to 1.</description></item><item><title>Cannot create project in a newly installed TFS</title><link>https://www.codewrecks.com/post/old/2009/06/cannot-create-project-in-a-newly-installed-tfs/</link><pubDate>Mon, 15 Jun 2009 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/cannot-create-project-in-a-newly-installed-tfs/</guid><description>I&amp;rsquo;ve just installed Tfs For Workgroup in a small virtual machine to make some experiments. After setting up the machine (Windows 2008) I installed TFS SErvice pack 1 then tfs power toys and finally I opened up visual studio in my desktop machine. I simply connect to the team foundation server and tried to create a new Team Project, inserted some values for my test project and then tried to create the project, but here is the result</description></item><item><title>Do not forget Array</title><link>https://www.codewrecks.com/post/old/2009/06/do-not-forget-array/</link><pubDate>Thu, 11 Jun 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/06/do-not-forget-array/</guid><description>I wrote a stupid util that does this operation: it scans a folder with 500.000 + files (in various subfolder), all files have name that contains an integer that is an id of a row in a database. I need to find orphan files, so I simply take file name, es: myfile_1002.txt, extracts the number 1002 and then verify if in a specific table of the database there is a row with index 1002.</description></item><item><title>XElement and hexadecimal value 0x0C is an invalid character</title><link>https://www.codewrecks.com/post/old/2009/05/xelement-and-hexadecimal-value-0x0c-is-an-invalid-character/</link><pubDate>Wed, 27 May 2009 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/05/xelement-and-hexadecimal-value-0x0c-is-an-invalid-character/</guid><description>I&amp;rsquo;ve a little library that build excel files in openXml format. It is based on LINQ to XML, and permits you to open an excel file with open xml sdk, then manipulate the content and showing it to the user.
Today for a particular set of data I got
hexadecimal value 0x0C, is an invalid character
This is a standard error of Xml, due to the fact that there are some character in ASCII set that cannot be included in XML content.</description></item><item><title>Castle Wcf facility integration on windows service or console</title><link>https://www.codewrecks.com/post/old/2009/04/castle-wcf-facility-integration-on-windows-service-or-console/</link><pubDate>Mon, 27 Apr 2009 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/04/castle-wcf-facility-integration-on-windows-service-or-console/</guid><description>Castle has a great facility to resolve Wcf services with castle windsor. This is really useful because it helps you when your concrete service classes have dependency to be resolved. There are a lot of tutorials or blog posts on how to configure it when you want to host service in IIS, but little bit about how to do self hosting, for example in a console application or in a windows service.</description></item><item><title>The importance of overriding ToString for tests</title><link>https://www.codewrecks.com/post/old/2009/04/the-importance-of-overriding-tostring-for-tests/</link><pubDate>Fri, 24 Apr 2009 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/04/the-importance-of-overriding-tostring-for-tests/</guid><description>Standard behavior of ToString is to print class or structure name. Sometimes if you never need to call tostring for class in application you will avoid to override this basic behavior. Suppose you have this simple structure.
1 2 3 4 public struct Range { public Int32 Left; public Int32 Rigth; This is a simple structure with two field, now I have this test.
1 2 MultiRange res = wcbe.FindHit(&amp;#34;thi*&amp;#34;, baseText); Assert.</description></item><item><title>Optimizing Regular expression</title><link>https://www.codewrecks.com/post/old/2009/04/optimizing-regular-expression/</link><pubDate>Fri, 24 Apr 2009 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/04/optimizing-regular-expression/</guid><description>I have an application where I do a lot of search for pattern in text and I use a lot of regular expression. The program runs well, until the amount of text it has to search into is grown tremendously. It reaches a point where the standard daily task that was completed in a couple of hours now span for more than one day, and I need to run it each day, so I need to optimize.</description></item><item><title>Cannot obtain Metadata from when trying to create references with serviceutilexe</title><link>https://www.codewrecks.com/post/old/2009/04/cannot-obtain-metadata-from-when-trying-to-create-references-with-serviceutilexe/</link><pubDate>Wed, 15 Apr 2009 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/04/cannot-obtain-metadata-from-when-trying-to-create-references-with-serviceutilexe/</guid><description>I have a simple wcf service hosted in IIS6, when I launch serviceutil.exe ( svcutil.exe http://10.8.50.1:7507/FileReceiver.svc?wsdl ) to create a proxy I get a complex and long error, but the first part of the error tells me
Error: Cannot obtain Metadata from http://10.8.50.1:7507/FileReceiver.svc?wsdl
I lost about half an hour triying to figure out what is wrong. First of all I tried to expose metadata, but this is not possible in IIS6 or at least I got some errors, and nothing works.</description></item><item><title>Adapting a model to make binding simpler</title><link>https://www.codewrecks.com/post/old/2009/03/adapting-a-model-to-make-binding-simpler/</link><pubDate>Tue, 17 Mar 2009 10:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/03/adapting-a-model-to-make-binding-simpler/</guid><description>I have a domain model composed by Clients, each client has a series of associated Typology objects and each Typology object has a certain number of associated Target. Now I need to bind this model to a series of three combo in WPF, but I have this little problem
The model is not directly accessible, I have already a service that has functions like GetAllCustomer, GetTyplogyForCustomer(Int32 customerId) and GetTargetForTyplogy(Int32 typologyId). Each method returns a list of the corresponding object, but they are DTO and not real object, so the Customer, Typology and Target returned from the service have no relation between them.</description></item><item><title>Hosting a WCF service based on MSMQ in IIS7</title><link>https://www.codewrecks.com/post/old/2009/03/hosting-a-wcf-service-based-on-msmq-in-iis7/</link><pubDate>Tue, 17 Mar 2009 07:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/03/hosting-a-wcf-service-based-on-msmq-in-iis7/</guid><description>Today I had a strange problem, I needed to host a MSMQ service in IIS7, I followed the instruction on this post. Everything worked ok, I pumped some messages on the queue and the service received them with no problem&amp;hellip;at least initially. After a bit of time of inactivity, the server stopped to read message from the queue and I have no clue of what is happening. Messages are stored in the queue, but they never got processed.</description></item><item><title>Assembly generation failed Referenced assembly 8216xxx8217 does not have a strong name</title><link>https://www.codewrecks.com/post/old/2009/03/assembly-generation-failed-referenced-assembly-xxx-does-not-have-a-strong-name/</link><pubDate>Fri, 13 Mar 2009 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/03/assembly-generation-failed-referenced-assembly-xxx-does-not-have-a-strong-name/</guid><description>I have a solution where projects are not signed, now I need to sign them, but clearly when I begin to insert signing I end with some errors like
Assembly generation failed Referenced assembly ‘xxx’ does not have a strong name
These errors are caused because your projects are referencing dll that are not strongly signed. For those dll that are open source you can simply recompile everything with a strong name, for those one that comes in compiled form only you need to disassemble and reassemble again with a strong name.</description></item><item><title>Hilite words in webbrowser now for WPF control</title><link>https://www.codewrecks.com/post/old/2009/03/hilite-words-in-webbrowser-now-for-wpf-control/</link><pubDate>Wed, 11 Mar 2009 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/03/hilite-words-in-webbrowser-now-for-wpf-control/</guid><description>Some days ago, I blogged about how to hilite words in a webBrowser control for windows forms. Now I need to do the same thing on WPF WebBrowser control, but instead of doing direct modification of DOM, a friend suggested me a Javascript script to hilite words in document. My original technique, discussed in old post, is not so good because it replaces text in the whole content of the document, and sometimes it breaks script etc.</description></item><item><title>Entity Framework relations and entityKey</title><link>https://www.codewrecks.com/post/old/2009/02/entity-framework-relations-and-entitykey/</link><pubDate>Wed, 18 Feb 2009 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/02/entity-framework-relations-and-entitykey/</guid><description>Suppose you generate an Entity Framework model on standard northwind database, you have a customer id and you want to generate an order for that customer. A possible solution is
1 2 3 4 5 6 7 8 9 10 using (ModelTestBase context = new ModelTestBase()) { Orders order = new Orders(); order.Freight = 1.0M; order.RequiredDate = order.OrderDate = DateTime.Now; order.Customers = context.Customers.Where(c =&amp;gt; c.CustomerID == &amp;#34;ALFKI&amp;#34;).First(); context.AddToOrders(order); context.SaveChanges(); } This code is perfectly valid, but is not the smartest thing to do, if you analyze traffic with profiler you can verify that this code executes a select to retrieve the customer, and then inserts the order into orders table.</description></item><item><title>Highlight words in webbrowser control</title><link>https://www.codewrecks.com/post/old/2009/02/highlight-words-in-webbrowser-control/</link><pubDate>Fri, 13 Feb 2009 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/02/highlight-words-in-webbrowser-control/</guid><description>In windows forms the WebBrowser control permits to include a fully funcional browser into your application. The interesting things is that you can interact with the html of the site with no problem. As an example you can load a page and highlight some words into the text, here is the result of loading www.nablasoft.com and I want to highlight &amp;ldquo;laureati&amp;rdquo; and &amp;ldquo;passione&amp;rdquo;.
As you can see I’ve highlighted the two words, the code is really simple.</description></item><item><title>Unity and AOP in enterprise library</title><link>https://www.codewrecks.com/post/old/2009/01/unity-and-aop-in-enterprise-library/</link><pubDate>Sat, 31 Jan 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/01/unity-and-aop-in-enterprise-library/</guid><description>Part 1 – Basic of IoC unity container
Part 2 – Basic of resolving dependencies and configure objects.
Part 3 – AOP with Policy Injection Application Block
Part 4 – Custom Handler to use with Policy Injection Application Block
Part 5 – Combine policy Injection Application Block with Unity
In last post I showed how Policy Injection Application Block is now only a tiny wrapper around Unity. So Unity is the enterprise library section that does both AOP and Dependency Injection, this make me a little bit confused :) so I decided to forget about PIAB, just to avoid confusion.</description></item><item><title>Combine Policy Injection Application Block with Unity</title><link>https://www.codewrecks.com/post/old/2009/01/combine-policy-injection-application-block-with-unity/</link><pubDate>Mon, 26 Jan 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/01/combine-policy-injection-application-block-with-unity/</guid><description>Part 1 – Basic of IoC unity container
Part 2 – Basic of resolving dependencies and configure objects.
Part 3 – AOP with Policy Injection Application Block
Part 4 – Custom Handler to use with Policy Injection Application Block
In previous parts I showed how to configure unity container and how to create a custom handler for policy injection application block, now it is time to speak about integration between PIAB and Unity container.</description></item><item><title>Custom Handler to use with Policy Injection Application Block</title><link>https://www.codewrecks.com/post/old/2009/01/custom-handler-to-use-with-policy-injection-application-block/</link><pubDate>Sun, 18 Jan 2009 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/01/custom-handler-to-use-with-policy-injection-application-block/</guid><description>Previous Posts:
Part 1 – Basic of IoC unity container
Part 2 – Basic of resolving dependencies and configure objects.
Part 3 – AOP with Policy Injection Application Block
In this fourth part I’ll examine how to build a simple custom handler that will be used with Policy Injection Application Block. The purpose of the handler is simply dumping to console the name of the called method as well all the parameters with theirs values.</description></item><item><title>Unity policy injection application block and AOP</title><link>https://www.codewrecks.com/post/old/2009/01/unity-policy-injection-application-block-and-aop/</link><pubDate>Sat, 17 Jan 2009 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/01/unity-policy-injection-application-block-and-aop/</guid><description>This is the third on a series of post I’m doing while exploring the Unity IoC container.
Part 1 – Basic of IoC unity container
Part 2 – Basic of resolving dependencies and configure objects.
Now it is time of AOP and using Policy Injection Application Block. AOP it is a very interesting technique, used to inject behavior on a class at runtime. To use AOP with Unity and policy injection application block you should wrap the instances returned by the Unity container as shown in this snippet.</description></item><item><title>Other experiments with Unity</title><link>https://www.codewrecks.com/post/old/2009/01/other-experiments-with-unity/</link><pubDate>Sat, 17 Jan 2009 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2009/01/other-experiments-with-unity/</guid><description>Yesterday I give a look at unity, an Inversion Of Control container made by Microsoft, today I’m experimenting a little more to have more confidence with it.
An IoC container not only permits to resolve a concrete entity, but it also permits you to configure it. Here is how you can set a simple property on an object.
1 2 3 4 5 6 7 8 9 &amp;lt;type type=&amp;#34;ITest&amp;#34; mapTo=&amp;#34;TestB&amp;#34; name=&amp;#34;OtherTest&amp;#34;&amp;gt; &amp;lt;typeConfig extensionType=&amp;#34;Microsoft.</description></item><item><title>Always check for objects thread safety when you are doing multi thread programs</title><link>https://www.codewrecks.com/post/old/2008/12/always-check-for-objects-thread-safety-when-you-are-doing-multi-thread-programs/</link><pubDate>Thu, 04 Dec 2008 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/12/always-check-for-objects-thread-safety-when-you-are-doing-multi-thread-programs/</guid><description>Yesterday I fight with a strange bug, I have a simple class that calculate Sha256 of a string, It was used in a old part of a project where a single thread does a series of operations. Some months later the program is heavily evolved, and there is a new part that uses async pattern to do some operations, since I need to have a Sha256 value I reused the old function called Utils.</description></item><item><title>Impedence between domain objects and Ui Layer</title><link>https://www.codewrecks.com/post/old/2008/11/impedence-between-domain-objects-and-ui-layer/</link><pubDate>Thu, 20 Nov 2008 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/impedence-between-domain-objects-and-ui-layer/</guid><description>When you work with domain model your domain objects become more complex than a simple containers for table values. This makes somewhat problematic using these object directly with the UI, especially when you use native binding. Let&amp;rsquo;s make an example, I have this object called Domain As you can see the Domain class has a property called ContentBlackList that is a List of String. The setter is private and in the getter the list is created lazily, then I have a User Type to map this property into a single field of a table in a list of string separated by the charachter #.</description></item><item><title>Missing RemovedItem from BindingList and BindingSource</title><link>https://www.codewrecks.com/post/old/2008/11/missing-removeditem-from-bindinglist-and-bindingsource/</link><pubDate>Tue, 18 Nov 2008 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/missing-removeditem-from-bindinglist-and-bindingsource/</guid><description>If you work with Windows Forms you cannot live without binding :D, but something is missing from the base structure. I want to create a simple form with a BindingSource, then bind a list of object to a grid and some textboxes to create a master detail form, moreover I set up a simple navigator to make simple for the user navigating the structure, the navigator has the addnew and remove button and the user likes them.</description></item><item><title>Visual studio 2010</title><link>https://www.codewrecks.com/post/old/2008/11/visual-studio-2010/</link><pubDate>Fri, 07 Nov 2008 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/visual-studio-2010/</guid><description>Well, in this period I have a little time to spent on this, but I could not resist,
With my new 500GB usb disk now I have enough space to work with the virtual machine of the Visual Studio 2010 CTP :D
alk.</description></item><item><title>Performance of logging system</title><link>https://www.codewrecks.com/post/old/2008/11/performance-of-logging-system/</link><pubDate>Fri, 07 Nov 2008 06:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/performance-of-logging-system/</guid><description>When you insert a logging system into your application you should do some preliminary test for performance issue. The most important thing is that logging infrastructure should not introduce too much overhead when the log is disabled. With log4net you have different way to handle the log, suppose you have a logger and the DEBUG level is disabled; you can use one of these three form
1 2 3 4 5 log1.</description></item><item><title>Improving the WCF logger</title><link>https://www.codewrecks.com/post/old/2008/11/improving-the-wcf-logger/</link><pubDate>Thu, 06 Nov 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/improving-the-wcf-logger/</guid><description>One of the first improvement to the WCF logger is the ability to choose the list of logger to monitor during registration. A real application can generate tons of logs, suppose you are interested only in looking at the NHibernate generated query. The solution is to add another registration method and internally use an object that keeps care of the registration and senting log progress. Here is the new interface</description></item><item><title>Live logging with log4net and WCF part 2</title><link>https://www.codewrecks.com/post/old/2008/11/live-logging-with-log4net-and-wcf-part-2/</link><pubDate>Wed, 05 Nov 2008 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/live-logging-with-log4net-and-wcf-part-2/</guid><description>In previous post I showed how to create a publish/subscribe logger with WCF and log4net, now I show you my first use of this particular appender.
When you work with nhibernate you can use show-sql configuration parameter to instruct nhibernate to show generated sql, but how can you see this output in a running windows application? You should know that NHibernate has various log4Net logger, and you can instruct the session to dump all sql code to a logger, here it is a possible configuration</description></item><item><title>Again about differences about Binary versus Xml Serialization</title><link>https://www.codewrecks.com/post/old/2008/11/again-about-differences-about-binary-versus-xml-serialization/</link><pubDate>Sat, 01 Nov 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/11/again-about-differences-about-binary-versus-xml-serialization/</guid><description>In previous post I deal with the size of binary serialization vs Xml Serialization, but as my friend Marco commented, those two techniques are really different and should not be compared directly.
Binary serialization is a technique used to obtain a binary representation of an object, and then rebuild that object from it back to a real instance in memory.
Serialization is a process that permits to convert the state of an object into a form that can be stored into some durable medium (file, DB) to rebuild original object in the future or to send the object to another process or computer through network channels.</description></item><item><title>Binary versus Xml Serialization size</title><link>https://www.codewrecks.com/post/old/2008/10/binary-versus-xml-serialization-size/</link><pubDate>Fri, 31 Oct 2008 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/10/binary-versus-xml-serialization-size/</guid><description>Yesterday a friend of DotNetMarche asked me this question: I have the need to store serialized objects into database , I can choose between binary or xml format, which is smaller in size?
My first answer was Binary should occupy less space because it is more compact but he told me that DBA checked that xml entities actually uses less space than binary ones.
This morning I did some test with a simple class</description></item><item><title>Again on Expression Tree vs Reflection</title><link>https://www.codewrecks.com/post/old/2008/10/again-on-expression-tree-vs-reflection/</link><pubDate>Thu, 09 Oct 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/10/again-on-expression-tree-vs-reflection/</guid><description>In last post Expression Tree vs Reflection I showed how to use Expression Tree to dynamically build a function object at runtime that you can use to invoke methods of unknown objects. This is a peculiar use of Expression Tree, but you can obtain the same result with Lightweight Code Generation (as some people commented in the post). Moreover the LCG approach is probably faster because the expression tree uses LCG in the Compile method, so if you directly generate your code in IL, there is no need of intermediate Expression Tree object.</description></item><item><title>Faster invoke method of unknown objects with Expression tree part2</title><link>https://www.codewrecks.com/post/old/2008/10/faster-invoke-method-of-unknown-objects-with-expression-tree-part2/</link><pubDate>Mon, 06 Oct 2008 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/10/faster-invoke-method-of-unknown-objects-with-expression-tree-part2/</guid><description>In the last post I described a technique that uses Expression Tree to invoke dynamically methods of objects of types unknown at compile time. You can use this technique to build the ExpressionTreeReflection class.
You can now write code like this
1 2 3 4 5 6 7 8 private static readonly Type suType = Type.GetType(&amp;#34;DotNetMarche.Common.Test.AuxClasses.SimpleUnknown, DotNetMarche.Common.Test&amp;#34;); private static readonly Object suInstance = Activator.CreateInstance(Type.GetType(&amp;#34;DotNetMarche.Common.Test.AuxClasses.SimpleUnknown, DotNetMarche.Common.Test&amp;#34;)); [Test] public void TestFuncNoArgInt32() { Func&amp;lt;Object, Int32&amp;gt; func = ExpressionTreeReflection.</description></item><item><title>Some thoughts on security books</title><link>https://www.codewrecks.com/post/old/2008/09/some-thoughts-on-security-books/</link><pubDate>Thu, 11 Sep 2008 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/09/some-thoughts-on-security-books/</guid><description>I’m not a security expert and I have a basic knowledge of the subject, such as knowing STRIDE, a little bit of SDL and some background on cryptography. If I look at my bookshelf I see that I have some security books on various argument, and I’m wonder if they are enough or if I need to buy some other books.
There are a lot of good books on security but I think that the argument deserves some special treatment.</description></item><item><title>How to implement INotifyPropertyChanged with CodeDom</title><link>https://www.codewrecks.com/post/old/2008/08/how-to-implement-inotifypropertychanged-with-codedom/</link><pubDate>Thu, 14 Aug 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/08/how-to-implement-inotifypropertychanged-with-codedom/</guid><description>In a little series of posts I showed how to create runtime class that extend a base entity to implement INotifyPropertyChanged. Despite the fact that dynamic code generation is surely not the best option to implement such an interface, I’m still interested in showing how to do it.
The greatest problem of Run-Time code generation with Reflection.Emit or Castle.DynamicProxy is that you cannot use generated class in your code, this is simply due to the fact that the type exists only at runtime.</description></item><item><title>PostCompiling code Today my mind wanders</title><link>https://www.codewrecks.com/post/old/2008/08/postcompiling-code-today-my-mind-wanders/</link><pubDate>Thu, 07 Aug 2008 11:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/08/postcompiling-code-today-my-mind-wanders/</guid><description>In these days in our italian blogs we were ruminating about the possibility to have some sort of automation to implements automatically INotifyPropertyChanged for our classes, without having to explicitly write code.
Why we could want such an automation? The answer is: to make our domain more “Infrastructure Ignorant“, the goal is use POCO object for our domain, moving the infrastructure stuff (Like the INotifyPropertyChanged) somewhere else.
First of all, I’m not an advocate of “POCO at any cost!</description></item><item><title>Implement InotifyPropertyChanged with CastleDynamicProxy</title><link>https://www.codewrecks.com/post/old/2008/08/implement-inotifypropertychanged-with-castledynamicproxy/</link><pubDate>Mon, 04 Aug 2008 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/08/implement-inotifypropertychanged-with-castledynamicproxy/</guid><description>In previous post, I simply show how to dynamically generate a class that inherits from a given class, and implement INotifyPropertyChanged for all virtual properties of the object. The example used Reflection.Emit, and I must admit that for people not acquainted with MSIL, the code can be really hard to write. Thanks to Castle project we can also use the DynamicProxy library to obtain the same result, but with really less code and less effort.</description></item><item><title>Implement INotifyPropertyChanged with dynamic code generation</title><link>https://www.codewrecks.com/post/old/2008/08/implement-inotifypropertychanged-with-dynamic-code-generation/</link><pubDate>Mon, 04 Aug 2008 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/08/implement-inotifypropertychanged-with-dynamic-code-generation/</guid><description>Code for this post can be found here.
Andrea Saltarello, in his post of some days ago, told about POCO object and dynamic implementation of INotifyPropertyChanged.
The problem is, how to implement INotifyPropertyChanged with dynamic code generation? The answer is that is quite simple even if we do not relay on Castle.DynamicProxy, here is a simple domain class.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 public class Customer { public virtual String Property { get { return property; } set { property = value; } } private String property; public virtual Int32 AnotherProp { get { return anotherProp; } set { anotherProp = value; } } private Int32 anotherProp; } Now let’s see how you can create a dynamic type that inherits from it, and overrides all virtual properties implementing the INotifyPropertyChanged interface.</description></item><item><title>Cleaner Xml Serialization</title><link>https://www.codewrecks.com/post/old/2008/06/cleaner-xml-serialization/</link><pubDate>Wed, 25 Jun 2008 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/06/cleaner-xml-serialization/</guid><description>Suppose you have a simple class
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 [Serializable, XmlRoot(&amp;#34;LogEntry&amp;#34;)] public class LogFeeder { private Guid sourceId; private String _Data; private String _Log; [XmlAttribute(&amp;#34;DetailSourceId&amp;#34;)] public Guid SourceId { get { return sourceId; } set { sourceId = value; } } [XmlAttribute(&amp;#34;Data&amp;#34;)] public string Data { get { return _Data; } set { _Data = value; } } [XmlAttribute(&amp;#34;Log&amp;#34;)] public string Log { get { return _Log; } set { _Log = value; } } public LogIUriFeeder() {} public LogIUriFeeder(Guid sourceId, string data, string log) { this.</description></item><item><title>Entity Framework and lazy load</title><link>https://www.codewrecks.com/post/old/2008/05/entity-framework-and-lazy-load/</link><pubDate>Fri, 30 May 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/05/entity-framework-and-lazy-load/</guid><description>In an old post of mine I expressed my perplexity with the fetching strategy of Entity Framework. We can discuss on the fact that automatic lazy load can be useful or not, but I expressed my opinion that, if you decide not to include automatic lazy load, and you implement manual load, if the developer forget to call load() an exception should be raised. This because if you forget to load a collection and access it, you find it empty, and this is misleading.</description></item><item><title>Cache e webrequest</title><link>https://www.codewrecks.com/post/old/2008/05/cache-e-webrequest/</link><pubDate>Fri, 16 May 2008 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/05/cache-e-webrequest/</guid><description>The webRequest object is fantastic to download content from the web, but it has some strange behaviour. Today I implemented cache in a component of mine, it needs to monitor a series of web pages, and clearly it is not useful to download full content of the page if the page itself is not changed. The solution is to use a cache.
First you need to know how does it work cache for web pages, I’m not an expert but it is quite simple, you need to check in the response header for a couple of header, here these tags for www.</description></item><item><title>Strings with Null characters</title><link>https://www.codewrecks.com/post/old/2008/04/strings-with-null-characters/</link><pubDate>Fri, 25 Apr 2008 23:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/strings-with-null-characters/</guid><description>Sometimes.NET surprise me even if it is a really long time I work with it, some days ago I discovered that a string can contains Null characters. This seems strange to me because chars are value type, and a value type sould never assume value nothing, but it can for string.
I have an asp.net application written in Visual Basic, that takes some string from database and display them in simple literal control inside a template column of a gridview.</description></item><item><title>Unknown feature of visual studio 2005 8230 javascript debugger</title><link>https://www.codewrecks.com/post/old/2008/04/unknown-feature-of-visual-studio-2005-javascript-debugger/</link><pubDate>Fri, 25 Apr 2008 23:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/unknown-feature-of-visual-studio-2005-javascript-debugger/</guid><description>One of my friends told me that one of the most interesting news of Visual studio 2008 is the ability to debug javascript ….. but this is possible even with visual studio 2005.
Just try to write the line
debugger;
into javascript code and when you run the page you are prompted to attach a debugger, just attach the visual studio with the solution open and the game is done ;).</description></item><item><title>Working with MSHTML</title><link>https://www.codewrecks.com/post/old/2008/04/working-with-mshtml/</link><pubDate>Fri, 25 Apr 2008 22:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/working-with-mshtml/</guid><description>If you need to parse an html content, the MSHTML library can be a viable solution, it is quite simple to use even if it has some peculiarity, the first thing to do is to load data from a source, maybe you have the HTML content on a string, (perhaps you downloaded the page with a WebRequest), here is the code to load all the content of a page and then take only the content of the page, whitout all the html and script tags</description></item><item><title>Dynamic load type with TypeGetType and TypeLoadException</title><link>https://www.codewrecks.com/post/old/2008/04/dynamic-load-type-with-typegettype-and-typeloadexception/</link><pubDate>Fri, 18 Apr 2008 23:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/dynamic-load-type-with-typegettype-and-typeloadexception/</guid><description>I love dynamically creating object with Activator.CreateInstance, in a project of mine I created a little scheduler that accept object of type ICOmmand, it load assembly from disk, permits you to configure the command reading some custom attributes, and so on.
When You use the scheduler to schedule a command it is frequent that the command is contained in an Assembly that references some other assemblies, if the person that use the scheduler forget to include all dependencies when the code call Type.</description></item><item><title>LINQ expression tree and linq to nhibernate</title><link>https://www.codewrecks.com/post/old/2008/04/linq-expression-tree-and-linq-to-nhibernate/</link><pubDate>Wed, 09 Apr 2008 23:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/linq-expression-tree-and-linq-to-nhibernate/</guid><description>When I first begin investigating lambda expressions I was fascinated by expression tree, so I decided to spent some time familiarizing with them. I try to create an alternate implementation of LINQ to NHibernate, I started from the excellent project of Ayende and I tried to create a new implementation from scratch. It is far from being a real and usable library, but it could be interesting to see how expression trees works.</description></item><item><title>AdoNET Entity Framework and lazy load</title><link>https://www.codewrecks.com/post/old/2008/04/adonet-entity-framework-and-lazy-load/</link><pubDate>Sun, 06 Apr 2008 00:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/adonet-entity-framework-and-lazy-load/</guid><description>This morning I installed Ado.net entity framework Beta2. I begin to run some example on School Database, and here the first surprise happens.
In Linq2Sql and in NHibernate lazy load happens automatically, and at least if I have a relation some fetch strategy is chosen to load related entities, it seems that in EF this does not happens. Here is a little example
1 2 3 4 5 6 7 8 9 10 ObjectQuery&amp;lt;Department&amp;gt; query = conn.</description></item><item><title>Cruise control net and Unable to execute file svnexe</title><link>https://www.codewrecks.com/post/old/2008/04/cruise-control-net-and-unable-to-execute-file-svnexe/</link><pubDate>Fri, 04 Apr 2008 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/04/cruise-control-net-and-unable-to-execute-file-svnexe/</guid><description>The sourceControl task of cc.net should specify the path of the executable of svn.exe as in the following example.
1 2 3 4 5 6 7 8 &amp;lt;sourcecontrol type=&amp;#34;svn&amp;#34;&amp;gt; &amp;lt;workingDirectory&amp;gt;C:\CruiseControl.NET\Projects\xxx\src&amp;lt;/workingDirectory&amp;gt; &amp;lt;trunkUrl&amp;gt;svn://10.8.0.1/xxx&amp;lt;/trunkUrl&amp;gt; &amp;lt;username&amp;gt;CCnet&amp;lt;/username&amp;gt; &amp;lt;password&amp;gt;xxxx&amp;lt;/password&amp;gt; &amp;lt;autoGetSource&amp;gt;true&amp;lt;/autoGetSource&amp;gt; &amp;lt;executable&amp;gt;c:\Program Files\Subversion\bin\svn.exe&amp;lt;/executable&amp;gt; &amp;lt;/sourcecontrol&amp;gt; If you omit the &amp;lt;executable&amp;gt; part of the source control it happens that if you do not have subversion in your path, cc.net cannot find svn.exe. The error is something like &amp;ldquo;Unable to execute file C:\CruiseControl.</description></item><item><title>Subtree substitution thanks to microsoft ExpressionVisitor</title><link>https://www.codewrecks.com/post/old/2008/03/subtree-substitution-thanks-to-microsoft-expressionvisitor-2/</link><pubDate>Wed, 05 Mar 2008 03:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/03/subtree-substitution-thanks-to-microsoft-expressionvisitor-2/</guid><description>Previous part: Part1, Part2, Part3.
One of the most important feature of the microsoft ExpressionVisitor I’ve told you before is the ability to substitute expression. Let’s for example see how the VisitBinary is implemented.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 1 protected virtual Expression VisitBinary(BinaryExpression b) 2 { 3 Expression left = this.Visit(b.Left); 4 Expression right = this.Visit(b.Right); 5 Expression conversion = b.</description></item><item><title>Subtree substitution thanks to microsoft ExpressionVisitor</title><link>https://www.codewrecks.com/post/old/2008/03/subtree-substitution-thanks-to-microsoft-expressionvisitor/</link><pubDate>Wed, 05 Mar 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/03/subtree-substitution-thanks-to-microsoft-expressionvisitor/</guid><description>Previous part: Part1, Part2, Part3.
One of the most important feature of the microsoft ExpressionVisitor I’ve told you before is the ability to substitute expression. Let’s for example see how the VisitBinary is implemented.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 1 protected virtual Expression VisitBinary(BinaryExpression b) 2 { 3 Expression left = this.Visit(b.Left); 4 Expression right = this.Visit(b.Right); 5 Expression conversion = b.</description></item><item><title>Linq to Sqlworking with detached object 82308230</title><link>https://www.codewrecks.com/post/old/2008/03/linq-to-sqlworking-with-detatched-object/</link><pubDate>Sat, 01 Mar 2008 01:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/03/linq-to-sqlworking-with-detatched-object/</guid><description>Linq to Sql is beautiful, but for people using NHibernate sometimes there are surprises. Suppose you load an entity, then you keep a reference in memory, dispose the original DataContext, and after some time you want to propagate to the database the value of the modified entity.
In NHibernate this is simple as calling SaveOrUpdate() method, in Linq2SQL you can call Attach() on the table you want to attach the object.</description></item><item><title>Against on ExpressionTree</title><link>https://www.codewrecks.com/post/old/2008/02/against-on-expressiontree/</link><pubDate>Tue, 19 Feb 2008 02:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/02/against-on-expressiontree/</guid><description>Previous part: Part1, Part2
Ok, lets move on on the anatomy of an expression, let’s take as example the following screenshot.
The original expression is customer =&amp;gt; customer.Property.StartsWith(“A”), and the expression is dissected in a node of type Lambda that contains a Call node. The Call node is a node that express the invocation of a method, and internally contains all the needed information.
1 2 3 4 5 6 7 8 9 10 11 12 13 protected override Expression VisitMethodCall(MethodCallExpression m) { StringBuilder parameterList = new StringBuilder(); foreach (ParameterInfo pi in m.</description></item><item><title>C 30 Expression Tree Again part 2</title><link>https://www.codewrecks.com/post/old/2008/02/c-30-expression-tree-again-part-2/</link><pubDate>Sat, 16 Feb 2008 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2008/02/c-30-expression-tree-again-part-2/</guid><description>In the preceding post I showed that a lambda expression can be converted by the compiler in an object of type Expression that actually models the expression tree. With this post we can begin to have more fun, first of all I modified the visitor to show the exact tree of the expression. Here is a screenshot
As you can see the structure of the lambda is more clear, the original lambda contains an Add Expression that in turns contains two parameter expression.</description></item><item><title>BindingListFind and NotImplementedException</title><link>https://www.codewrecks.com/post/old/2007/10/bindinglistfind-and-notimplementedexception/</link><pubDate>Fri, 12 Oct 2007 05:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2007/10/bindinglistfind-and-notimplementedexception/</guid><description>BindingList&amp;lt;T&amp;gt; is a great class to do binding to list of custom objects, it implements IBindingList for you, giving the ability to use the BindingList&amp;lt;T&amp;gt; as datasource for the BindingSource control. But when you cast the BindingList&amp;lt;T&amp;gt; to the IBindingList interface and try to call Find() Method you’ll get a NotImplementedException, how can it be possible?. The reason for this can be found here, but the real question is, it is possible to build a better BindingList that supports a generic Find() for properties of a business object?</description></item><item><title>Generate code with CodeDom</title><link>https://www.codewrecks.com/post/old/2007/09/generate-code-with-codedom/</link><pubDate>Thu, 13 Sep 2007 04:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2007/09/generate-code-with-codedom/</guid><description>Code generators are really useful because they could cut down the time needed to write tedious code. There are a very good code generator called CodeSmith, with an old version that is freeware, but it is possible to generate code with own code with the help of CodeDom. CodeDom namespace contains a lot of classes useful to define code that can be generated in various languages by a specific CodeDomProvider, let’s see an example.</description></item><item><title>IRepositoryT and query objects</title><link>https://www.codewrecks.com/post/old/2007/08/irepository-and-query-objects/</link><pubDate>Sun, 05 Aug 2007 22:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2007/08/irepository-and-query-objects/</guid><description>When you use a generic Interface for repository pattern there is always the problem of Query object. If you use nhibernate you can use Criteria API, but if you want to make your code not dependent by the ORM used, you often need to implement your Criteria Query. The most annoying problem with this approach is duplication of code, this because you usually create your query object and the concrete repository must translate from the Custom Query Object to the query object supported by the ORM framework.</description></item><item><title>NGenerics</title><link>https://www.codewrecks.com/post/old/2007/06/ngenerics/</link><pubDate>Fri, 29 Jun 2007 09:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2007/06/ngenerics/</guid><description>If you like me are tired of.NET standard IList&amp;lt;T&amp;gt; that does not offer a lot of method to do sorting, filtering and more, you can have a look at NGenerics, a complete library composed of a lot of classes to satisfy all the need you can have to store data. You have algorithms for Graph for math, data structures and a lot more. What I really love are the classes for sorting, ranging from bubblesort, quicksort and a lot more.</description></item><item><title>Standard configuration for net 20</title><link>https://www.codewrecks.com/post/old/2007/06/standard-configuration-for-net-20/</link><pubDate>Thu, 14 Jun 2007 08:00:37 +0200</pubDate><guid>https://www.codewrecks.com/post/old/2007/06/standard-configuration-for-net-20/</guid><description>I’m trying to develop a little framework to include in future projects, actually I had classes and project spread around partition D F and G, and I realized that I’m not really a tidy person :D. At this moment I only had written some classes to handle access to db with direct Sql, and I really liked used Anonymous delegate as did ayende in one of his post. At a certain point I faced the problem to decide where to save the setting of the project, for example the main connectionString.</description></item></channel></rss>